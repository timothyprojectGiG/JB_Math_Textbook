

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>5. Orthogonality &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Undergrad/Linear/5';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Solutions to Exercises" href="Solutions.html" />
    <link rel="prev" title="4. Eigenvalues and Eigenvectors" href="4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to  Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">PREFACE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../JMM23.html">JMM 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PatternsSOLUTION.html">Patterns</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PRE-COLLEGE</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Elementary/Arithmetic/elementary.html">Elementary Blackboard Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/GettingStarted/python.html">Beginning Python Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PRE-COLLEGE STEAM OUTREACH Paul Isihara</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DD.html">Data Detectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Celestial.html">Celestial Ministries  Outreach Program</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb1.html">1 Functions- Michael Jordan’s Highest Scoring Game</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb2.html">2 How bad is COVID by Chicago Zipcode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb3.html">3. Pixel Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb4.html">4. Random Number Approximation of Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb5.html">5. Name That Tune!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb6.html">6. Word Clouds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb7.html">7. Mapping Famous Chicagoans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb8.html">8. Predicting Exemplary K-8 Chicago Schools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb9.html">9. Simulating Formula One</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/jnb10.html">10. It’s Christmas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PreCollege/Celestial/demo.html">11. After School Program Demo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PYTHON PROGRAMMING GUIDE Thomas VanDrunen</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Intropy.html">Transition to College Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Programming/Introduction_to_Python.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Programming/Data.html">Working with data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PROBABILITY MODELS Laura Gross, Yiheng Liang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Prob.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/ProbIntro/chapter%20probability%20gross%20and%20liang_2023_06_08.html">Introduction</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">EXPLORATORY DATA ANALYSIS Peter Jantsch</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Data.html">Exploratory Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STATISTICAL INFERENCE Peter Jantsch, Claire Wagner</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Stat.html">Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/00_Instructor_Notes.html">Introduction and Instructor Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/01_Foundations.html">Foundations of Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/02_Inference_Categorical.html">Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/03_Inference_Numerical.html">Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ProbStat/StatInf/04_Regression.html">Linear Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS  Inne Singgih</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Calculus/Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/2Functions.html">2. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/3Limits.html">3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/4%20Derivatives.html">4. Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/5%20Integrals.html">5. Integrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/6%20Parametric%20Equations.html">6. Parametric Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/7%20Sequences%20and%20Series.html">7. Sequences and Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Calculus/Solutions.html">Solution to Calculus Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CALCULUS FOR DAILY LIFE  Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/twocommodity.html">1. Linear Systems and the 2 Commodity Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/marginal.html">2. Marginal and Average Cost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/design.html">3. Optimization and Object Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/cobbs.html">4. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/rates.html">5. Related Rates and Volumes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/football.html">6. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/jnb7.html">7. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/control.html">8. Normal Distribution and Process Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/ols.html">9. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/gini.html">10. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/income.html">11. Integral Test and Income Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedCalc/ode.html">12. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA Soheil Anbouhi</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Linear.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="0.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.html">1. Linear Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.html">2. Matrices and Determinants</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.html">3. Linear Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.html">4. Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Orthogonality</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions.html">Solutions to Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Aplin.html">Applied Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html">2. OLS Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/KMeans/jnb2.html">3. K-means Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/PCA/jnb3.html">4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/LinearAlgebra/SVM/jnb4.html">5. Binary Classification of Labelled Data by Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS Rachel Petrik</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DifEq.html">Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DifEq/Differential%20Equations.html">1. Overview of Chapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DifEq/DE2.html">2. Introduction to Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DifEq/DE3.html">3. First-Order Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DifEq/DE4.html">4. Second-Order Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DifEq/DE5.html">5. Systems of First-Order Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DifEq/DE6.html">6. Laplace Transforms</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/covid.html">1. Logistic Growth and COVID-19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/sir.html">2. The Basic SIR Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/cholera.html">3. Cholera in Haiti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/hiv/hiv.html">4. HIV-AIDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/cws/cws.html">5. CWS Model of Alzheimemer’s Disease</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppliedDifEq/gravity/gravity.html">6. Gravity Fed Water Delivery</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COMPLEX VARIABLES IN GROUNDWATER MODELING Wheaton College Team</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb1.html">1. Setting the Scene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb2.html">2. Complex Analysis Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb3.html">3. Idealized Groundwater Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/jnb4.html">4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/Complex_Potentials.html">Complex Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/Complex/model.html">Fischer-Calo Contaminant Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ADVANCED DATA ANALYSIS Ying Li, Jonathan Zhu</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../AdvData.html">Advanced Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec0_data.html">0. Before Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec1_preprocessing.html">1. Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec2_transform_features.html">2. About Text Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec3_doc_embedding.html">3. Document Embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec4_classification_algos.html">4. Classification of Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec5_classification_eval.html">5. Evaluating Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec6_applications.html">6. Applications</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/timothyprojectGiG/JB_Math_Textbook/main?urlpath=tree/src/Undergrad/Linear/5.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook/issues/new?title=Issue%20on%20page%20%2FUndergrad/Linear/5.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Undergrad/Linear/5.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5. Orthogonality</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-product-and-orthogonality">5.1 Inner product and Orthogonality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-product">Inner product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#angles-and-orthogonality">Angles and Orthogonality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-projection">5. 2 Orthogonal Projection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-set">Orthogonal Set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-projections-onto-1-dimensional-spaces">Orthogonal Projections onto <span class="math notranslate nohighlight">\(1\)</span>-dimensional spaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-projections-onto-a-general-subspace">Orthogonal Projections onto a general subspace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-best-approximation-theorem">The Best Approximation Theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-gramschmidt-process">5. 3 The Gram–Schmidt Process</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#idea-construction-of-an-orthogonal-basis-form-a-basis-with-two-elements">Idea: construction of an orthogonal basis form a basis with two elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construction-of-an-orthogonal-basis-form-a-basis-with-three-elements">Construction of an orthogonal basis form a basis with three elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-gram-schmidt-process">The Gram_Schmidt Process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-problems">5.4 Least-Squares Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-note">Numerical Note</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercises</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="orthogonality">
<h1>5. Orthogonality<a class="headerlink" href="#orthogonality" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="inner-product-and-orthogonality">
<h2>5.1 Inner product and Orthogonality<a class="headerlink" href="#inner-product-and-orthogonality" title="Permalink to this heading">#</a></h2>
<p>In this section, we explore inner product and orthogonality. Inner product allows us to define intuitive geometric concepts such as length, distance, and perpendicularity in <span class="math notranslate nohighlight">\(n\)</span> dimensional space <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p>
<section id="inner-product">
<h3>Inner product<a class="headerlink" href="#inner-product" title="Permalink to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> be vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>. We can view them as <span class="math notranslate nohighlight">\(n \times 1\)</span> matrices. The transpose of <span class="math notranslate nohighlight">\(\vec{u}\)</span>, denoted as <span class="math notranslate nohighlight">\(\vec{u}^T\)</span>, is a <span class="math notranslate nohighlight">\(1\times n\)</span> matrix. The matrix product of <span class="math notranslate nohighlight">\(\vec{u}^T\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> yields a <span class="math notranslate nohighlight">\(1\times 1\)</span> matrix, which can be written as a real number (a scalar) without brackets. This scalar is known as the inner product or dot product of <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>. To compute it, we multiply the corresponding elements of <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> and sum the results. More precisely, if</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u} = \begin{bmatrix} u_1\\ u_2 \\ \vdots \\ u_n \end{bmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{v} = \begin{bmatrix} v_1\\ v_2 \\ \vdots \\ v_n \end{bmatrix},
\end{split}\]</div>
<p>then the dot product <span class="math notranslate nohighlight">\(\vec{u} \cdot \vec{v}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u} \cdot \vec{v} = \vec{u}^T\vec{v} = \begin{bmatrix} u_1 &amp; u_2 &amp; \dots &amp; u_n \end{bmatrix} \begin{bmatrix} v_1 \\ v_2 \\ \vdots \\ v_n \end{bmatrix} = u_1v_1 + u_2v_2 + \dots + u_nv_n
\end{split}\]</div>
<div class="admonition-example-1 admonition">
<p class="admonition-title">Example 1</p>
<p>Compute <span class="math notranslate nohighlight">\(\vec{u} \cdot \vec{v}\)</span> for <span class="math notranslate nohighlight">\(\vec{u} = \begin{bmatrix} 1\\ -1 \\ 2 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\vec{v} = \begin{bmatrix} -2 \\ 3 \\ 4 \end{bmatrix}\)</span>.</p>
</div>
<p><strong>Solution</strong></p>
<p>We use <code class="docutils literal notranslate"><span class="pre">numpy.dot()</span></code> to compute the dot product in Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">uv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="n">uv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Theorem 1 (Properties of the dot product)</p>
<p>Let <span class="math notranslate nohighlight">\(\vec{u}\)</span>, <span class="math notranslate nohighlight">\(\vec{v}\)</span> and <span class="math notranslate nohighlight">\(\vec{w}\)</span> be vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, and <span class="math notranslate nohighlight">\(c \in \mathbb{R}\)</span> be a scalar. Then</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\vec{u}\cdot\vec{v} = \vec{v}\cdot\vec{u}.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\vec{u} + \vec{v})\cdot \vec{w} = \vec{u}\cdot\vec{w} + \vec{v}\cdot\vec{w}.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(c(\vec{u}\cdot\vec{v}) = (c\vec{u})\cdot\vec{v} = \vec{u}\cdot(c\vec{v}).\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{u}\cdot\vec{v}\geq 0\)</span>, and <span class="math notranslate nohighlight">\(\vec{u}\cdot\vec{u} = 0\)</span> if and only if <span class="math notranslate nohighlight">\(\vec{u}=0.\)</span></p></li>
</ol>
</div>
<p>combining (2) and (3), and using induction we can show:</p>
<div class="math notranslate nohighlight">
\[
(c_1\vec{u_1} + c_2\vec{u}_2 \dots c_p\vec{u}_p)\cdot \vec{w} = c_1\vec{w} \cdot \vec{u}_1 + c_2\vec{w} \cdot \vec{u}_2 + \dots c_p\vec{w} \cdot \vec{u}_p
\]</div>
<p><strong>Length of vectors</strong></p>
<p>Dot product can be used to define the length of vectors: let <span class="math notranslate nohighlight">\(\vec{u}\in \mathbb{R}^n\)</span> then the magnitude or the <em>length</em> of <span class="math notranslate nohighlight">\(\vec{u}\)</span>, denoted by <span class="math notranslate nohighlight">\(\|\vec{u}\|\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[
\|\vec{u}\| = \sqrt{\vec{u} \cdot \vec{u}}.
\]</div>
<ul class="simple">
<li><p>Note that this definition of length coincide with the standard notion of length in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> and <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p></li>
<li><p>A vector with a length of <span class="math notranslate nohighlight">\(1\)</span> is called as a unit vector. For any vector <span class="math notranslate nohighlight">\(\vec{u}\)</span>, there exists a unit vector in the direction of <span class="math notranslate nohighlight">\(\vec{u}\)</span>. To obtain this vector, we first calculate the length of <span class="math notranslate nohighlight">\(\vec{u}\)</span> and then divide <span class="math notranslate nohighlight">\(\vec{u}\)</span> by its length <span class="math notranslate nohighlight">\(\|\vec{u}\|\)</span>. The resulting vector is referred to as the unit vector of <span class="math notranslate nohighlight">\(\vec{u}\)</span>, and commonly denoted as <span class="math notranslate nohighlight">\(\vec{e}_u\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\vec{e}_u = \frac{\vec{u}}{\|\vec{u}\|}
\]</div>
<p>This process is often called normalizing a vector, as it transforms <span class="math notranslate nohighlight">\(\vec{u}\)</span> into a unit vector by scaling it to have a length of <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="admonition-example-2 admonition">
<p class="admonition-title">Example 2</p>
<p>Let <span class="math notranslate nohighlight">\(\vec{u} = \begin{bmatrix} 1\\ 2 \\ 3 \end{bmatrix}\)</span>. Compute the following:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\|\vec{u}\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|-2\vec{u}\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{e}_u\)</span></p></li>
</ol>
</div>
<p><strong>Solution:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (1)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">uu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>

<span class="n">length_u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>

<span class="n">length_u</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.7416573867739413
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (2)</span>

<span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span>

<span class="n">vv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

<span class="n">length_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>

<span class="n">length_v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.483314773547883
</pre></div>
</div>
</div>
</div>
<p>We could also use the properties of the dot products to compute <span class="math notranslate nohighlight">\(\|-2\vec{u}\|\)</span>:</p>
<div class="math notranslate nohighlight">
\[\|-2\vec{u}\| = \sqrt{-2\vec{u}\cdot -2 \vec{u}} = 2 (\vec{u}\cdot\vec{u}) = 2 \|\vec{u}\|\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(3) comuting the unit vector of u</span>

<span class="n">e_u</span> <span class="o">=</span> <span class="n">u</span><span class="o">/</span><span class="n">length_u</span>

<span class="n">e_u</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.26726124, 0.53452248, 0.80178373])
</pre></div>
</div>
</div>
</div>
<p>Let’s check that the length of <span class="math notranslate nohighlight">\(\vec{e}_u\)</span> is exactly 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">length_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">e_u</span><span class="p">,</span><span class="n">e_u</span><span class="p">))</span>

<span class="n">length_e</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="admonition-example-3 admonition">
<p class="admonition-title">Example 3</p>
<p>Given vectors</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u} = \begin{bmatrix} 1\\ -1 \\ 2 \end{bmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{v} = \begin{bmatrix} -2 \\ 3 \\ 4 \end{bmatrix},
\end{split}\]</div>
<p>and the subspace <span class="math notranslate nohighlight">\(W\)</span> spanned by <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>, find unit vectors <span class="math notranslate nohighlight">\(\vec{w}_1\)</span> and <span class="math notranslate nohighlight">\(\vec{w}_2\)</span> that form a basis for <span class="math notranslate nohighlight">\(W\)</span>.</p>
</div>
<p><strong>Solution:</strong></p>
<p>Since <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> are linearly independent (they are not scalar multiples of each other), we can proceed to normalize them to get unit vectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unit vector of u</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">e_u</span> <span class="o">=</span> <span class="n">u</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">))</span>


<span class="c1"># unit vector of v</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">e_v</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e_u = &quot;</span><span class="p">,</span> <span class="n">e_u</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e_v = &quot;</span><span class="p">,</span> <span class="n">e_v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e_u =  [ 0.40824829 -0.40824829  0.81649658]
e_v =  [-0.37139068  0.55708601  0.74278135]
</pre></div>
</div>
</div>
</div>
<p><strong>Distance in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span></strong></p>
<p>For <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, the distance between <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>, denoted by <span class="math notranslate nohighlight">\(\text{dist}\ (\vec{v}, \vec{u})\)</span>, is the length of their difference vector <span class="math notranslate nohighlight">\(\vec{u} - \vec{v}\)</span>. That is,</p>
<div class="math notranslate nohighlight">
\[
\text{dist}\ (\vec{u}, \vec{v}) = \|\vec{u} - \vec{v}\|.
\]</div>
<p>Note that this definition coincide with the standard definition of distances in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> and <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>.</p>
<div class="admonition-example-4 admonition">
<p class="admonition-title">Example 4</p>
<p>Compute the distance between vectors in Example 2.</p>
</div>
<p><strong>Solution:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">u</span> <span class="o">-</span> <span class="n">v</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The distance between &quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot; and &quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s2">&quot; is &quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between  [1 2 3]  and  [-2 -4 -6]  is  11.224972160321824
</pre></div>
</div>
</div>
</div>
</section>
<section id="angles-and-orthogonality">
<h3>Angles and Orthogonality<a class="headerlink" href="#angles-and-orthogonality" title="Permalink to this heading">#</a></h3>
<div class="tip admonition">
<p class="admonition-title">Theorem 2 (Cauchy-Schwarz inequality)</p>
<p>For <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
|\vec{u}\cdot\vec{v}|\leq \|\vec{u}\|\|\vec{v}\|.
\]</div>
</div>
<p>The Cauchy-Schwarz inequality gives us a way to define the notion of angel between two <span class="math notranslate nohighlight">\(n\)</span> dimensional vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span>. This notion also coincide with our intuition in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> and <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>:</p>
<p>Suppose <span class="math notranslate nohighlight">\(\vec{u}, \vec{v}\in \mathbb{R}^n\)</span> are non-zero vectors. Note that</p>
<div class="math notranslate nohighlight">
\[
-1 \leq \frac{\vec{u}\cdot\vec{v}}{\|\vec{u}\|\|\vec{v}\|}\leq 1
\]</div>
<p>Therefore, there is a unique <span class="math notranslate nohighlight">\(\theta \in [0,\pi]\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
\cos(\theta) = \frac{\vec{u}\cdot\vec{v}}{\|\vec{u}\|\|\vec{v}\|}
\]</div>
<p><span class="math notranslate nohighlight">\(\theta\)</span> is reffered to as_the angel_ between <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> and is equal to</p>
<div class="math notranslate nohighlight">
\[
\theta = \arccos(\frac{\vec{u}\cdot\vec{v}}{\|\vec{u}\|\|\vec{v}\|})
\]</div>
<div class="admonition-example-5 admonition">
<p class="admonition-title">Example 5</p>
<p>Find the angel between vectors in Example 2.</p>
</div>
<p><strong>Solution:</strong></p>
<p>We first compute the length of <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> and then substitute them in above formula:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">))</span>
<span class="n">v_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">u_len</span> <span class="o">*</span> <span class="n">v_len</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>       
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The angel between u and v is &quot;</span><span class="p">,</span> <span class="n">t</span> <span class="p">,</span><span class="s2">&quot; rad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The angel between u and v is  3.141592653589793  rad
</pre></div>
</div>
</div>
</div>
<p>Two vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> are <strong>orthogonal</strong>, denoted by <span class="math notranslate nohighlight">\(\vec{u} \perp \vec{v}\)</span>, if the angle <span class="math notranslate nohighlight">\(\theta\)</span> between them is <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>. Alternatively, this condition is satisfied if and only if <span class="math notranslate nohighlight">\(\vec{u}\cdot \vec{v} = 0\)</span>. It is worth noting that the zero vector <span class="math notranslate nohighlight">\(\vec{0}\)</span> is orthogonal to every vector because <span class="math notranslate nohighlight">\(\vec{0}^T \cdot \vec{u} = 0\)</span> for any vector <span class="math notranslate nohighlight">\(\vec{u}\)</span>.</p>
<p>Observe that for any two vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\|\vec{u}+\vec{v}\|^2 = (\vec{u} + \vec{v}) \cdot (\vec{u} + \vec{v}) = \| \vec{u}\|^2 + \| \vec{v}\|^2 + 2 \vec{u}\cdot \vec{v}
\]</div>
<p>The above calculation implies the famous Pythagorean Theorem:</p>
<div class="tip admonition">
<p class="admonition-title">Theorem 3 (The Pythagorean Theorem)</p>
<p>Two vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> are orthogonal if and only if</p>
<div class="math notranslate nohighlight">
\[
\|\vec{u}+\vec{v}\|^2 =  \| \vec{u}\|^2 + \| \vec{v}\|^2 
\]</div>
</div>
<p><strong>The orthogonal complement of a subspace</strong></p>
<p>Let <span class="math notranslate nohighlight">\(W \subset \mathbb{R}^n\)</span> be a subspcae. If a vector <span class="math notranslate nohighlight">\(\vec{u}\)</span> is orthogonal to every vector in the subspace <span class="math notranslate nohighlight">\(W\)</span>, then <span class="math notranslate nohighlight">\(\vec{u}\)</span> is said to be orthogonal to <span class="math notranslate nohighlight">\(W\)</span>. The set of all vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> that are orthogonal to <span class="math notranslate nohighlight">\(W\)</span> form a subspace which is commonly called <strong>the orthogonal complement of <span class="math notranslate nohighlight">\(W\)</span></strong> and is denoted by <span class="math notranslate nohighlight">\(W^{\perp}\)</span> (or simply <span class="math notranslate nohighlight">\(W^\perp\)</span>):</p>
<div class="math notranslate nohighlight">
\[
W^{\perp} = \{\vec{u}\in \mathbb{R}^n: \vec{u}\cdot \vec{w} = 0 \text{ for all } \vec{w} \in W\}
\]</div>
<div class="admonition-example-6 admonition">
<p class="admonition-title">Example 6</p>
<p>Let <span class="math notranslate nohighlight">\(W\)</span> be the <span class="math notranslate nohighlight">\(xy\)</span>-plane in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>, and let <span class="math notranslate nohighlight">\(L\)</span> be the <span class="math notranslate nohighlight">\(z\)</span>-axis. Our intuition says <span class="math notranslate nohighlight">\(L\)</span> is orthogonal to <span class="math notranslate nohighlight">\(W\)</span>. In fact, if <span class="math notranslate nohighlight">\(\vec{z}\)</span> and <span class="math notranslate nohighlight">\(\vec{w}\)</span> are nonzero vectors such that <span class="math notranslate nohighlight">\(\vec{z}\in L\)</span> and <span class="math notranslate nohighlight">\(\vec{w}\in W\)</span>, then <span class="math notranslate nohighlight">\(\vec{z}\)</span> is orthogonal to <span class="math notranslate nohighlight">\(\vec{w}\)</span>. Since <span class="math notranslate nohighlight">\(\vec{w}\)</span> and <span class="math notranslate nohighlight">\(\vec{z}\)</span> were chosen arbitrary, every vector on <span class="math notranslate nohighlight">\(L\)</span> is orthogonal to every <span class="math notranslate nohighlight">\(\vec{w}\)</span> in <span class="math notranslate nohighlight">\(W\)</span>. In fact, <span class="math notranslate nohighlight">\(L\)</span> consists of all vectors that are orthogonal to the <span class="math notranslate nohighlight">\(\vec{w}\)</span>’s in <span class="math notranslate nohighlight">\(W\)</span>, and <span class="math notranslate nohighlight">\(W\)</span> consists of all vectors <span class="math notranslate nohighlight">\(\vec{w}\)</span> orthogonal to the <span class="math notranslate nohighlight">\(\vec{z}\)</span>’s in <span class="math notranslate nohighlight">\(L\)</span>. Mathematically,</p>
<div class="math notranslate nohighlight">
\[
L = W^{\perp} \quad \text{and} \quad W = L^{\perp}
\]</div>
</div>
<div class="admonition-example-7 admonition">
<p class="admonition-title">Example 7</p>
<p>If <span class="math notranslate nohighlight">\(W = span\left\lbrace \begin{bmatrix}
1\\0\\0
\end{bmatrix} \right\rbrace\)</span>, find a basis for <span class="math notranslate nohighlight">\(W^{\perp}\)</span>.</p>
</div>
<p><strong>Solution</strong>:</p>
<p>Note that <span class="math notranslate nohighlight">\(W\)</span> is simply the <span class="math notranslate nohighlight">\(x\)</span>-axis in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>. Intuitively, <span class="math notranslate nohighlight">\(W^{\perp}\)</span> should be the <span class="math notranslate nohighlight">\(yz\)</span>-plane, and a basis for it is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
B = \left\lbrace \begin{bmatrix}
0\\1\\0
\end{bmatrix}, \begin{bmatrix}
0\\0\\1
\end{bmatrix} \right\rbrace.
\end{split}\]</div>
<p>Alternatively, we can find the solutions to the linear system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
1 &amp; 0 &amp;0 
\end{bmatrix}\begin{bmatrix}
x \\y \\ z
\end{bmatrix} = \vec{0}.
\end{split}\]</div>
<p>We have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x \\y \\ z
\end{bmatrix} = \begin{bmatrix}
0 \\y \\ z
\end{bmatrix} = y \begin{bmatrix}
0 \\1 \\ 0
\end{bmatrix} + z \begin{bmatrix}
0 \\0 \\ 1
\end{bmatrix}.
\end{split}\]</div>
<p>We conclude this section with a theorem summarizing the properties of the orthogonal complement of a subspace.</p>
<div class="tip admonition">
<p class="admonition-title">Theorem 4</p>
<p>Let <span class="math notranslate nohighlight">\(W\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p>
<ol class="arabic simple">
<li><p>The orthogonal complement <span class="math notranslate nohighlight">\(W^{\perp}\)</span> is also a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p></li>
<li><p>The sum of the dimensions of <span class="math notranslate nohighlight">\(W\)</span> and <span class="math notranslate nohighlight">\(W^{\perp}\)</span> is equal to the dimension of the ambient space <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, i.e., <span class="math notranslate nohighlight">\(dim(W) + dim(W^{\perp}) = n\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(W\)</span> is the column space of some matrix <span class="math notranslate nohighlight">\(A\)</span>, i.e., <span class="math notranslate nohighlight">\(W = \text{col}(A)\)</span>, then <span class="math notranslate nohighlight">\(W^{\perp}\)</span> is precisely the null space of the transpose of <span class="math notranslate nohighlight">\(A\)</span>, i.e., <span class="math notranslate nohighlight">\(W^{\perp} = \text{null}(A^{T})\)</span>.</p></li>
</ol>
</div>
</section>
<section id="exercises">
<h3>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h3>
<div class="admonition-exercises admonition">
<p class="admonition-title">Exercises</p>
<ol class="arabic">
<li><p>Let  <span class="math notranslate nohighlight">\( \vec{a} = \begin{bmatrix}1 \\ 2 \\ 3 \\ 4 \end{bmatrix}\)</span>.</p>
<p>a. Find a vector <span class="math notranslate nohighlight">\(\vec{w}\)</span> that is in the opposite direction of <span class="math notranslate nohighlight">\(\vec{a}\)</span> and has a magnitude of 2.</p>
<p>b. Find two non-parallel vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> which are both orthogonal to <span class="math notranslate nohighlight">\(\vec{a}\)</span></p>
</li>
<li><p>Find two non-parallel vectors <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\vec{v}\)</span> which are both orthogonal to <span class="math notranslate nohighlight">\(\begin{bmatrix}
1 \\ 2 \\ 3 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\begin{bmatrix} 2 \\ -1 \\ 0 \end{bmatrix}.\)</span></p></li>
<li><p>Let</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{v}= \begin{bmatrix}
1\\2\\7
\end{bmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{w}= \begin{bmatrix}
1\\-1\\1
\end{bmatrix}.
\end{split}\]</div>
<p>a. Find <span class="math notranslate nohighlight">\(\vec{z}= \vec{v}- \displaystyle\left(\frac{\vec{v}\cdot \vec{w}}{\vec{w}\cdot \vec{w}}\right)\vec{w}.\)</span></p>
<p>b. Check that <span class="math notranslate nohighlight">\(\vec{z}\)</span> is orthogonal to <span class="math notranslate nohighlight">\(\vec{w}.\)</span></p>
<ol class="arabic simple" start="4">
<li><p>If</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
W = span\left\lbrace\ \begin{bmatrix}
1\\2\\3 \\ 4
\end{bmatrix}\ \right\rbrace
\end{split}\]</div>
<p>find a basis for <span class="math notranslate nohighlight">\(W^{\perp}\)</span>.</p>
</div>
</section>
</section>
<section id="orthogonal-projection">
<h2>5. 2 Orthogonal Projection<a class="headerlink" href="#orthogonal-projection" title="Permalink to this heading">#</a></h2>
<p>In this section we explore the construction of orthogonal projections which is a key step in many calculations involving orthogonality, and discusses some properties of projection maps.</p>
<section id="orthogonal-set">
<h3>Orthogonal Set<a class="headerlink" href="#orthogonal-set" title="Permalink to this heading">#</a></h3>
<p>A set of vectors <span class="math notranslate nohighlight">\(\{\vec{u}_1, \vec{u}_2, \dots, \vec{u}_p\}\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^{n}\)</span> is called an <em>orthogonal set</em> if each pair of distinct vectors from the set is orthogonal, meaning that <span class="math notranslate nohighlight">\(\vec{u}_i \cdot \vec{u}_j = 0\)</span> whenever <span class="math notranslate nohighlight">\(i \neq j\)</span>. It is important to note that an orthogonal set, consisting of <strong>nonzero vectors</strong>, is always a linearly independent set. For that reason, if a basis for a subspace <span class="math notranslate nohighlight">\(W\)</span> of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> happens to be an orthogonal set, it is called an <strong>orthogonal basis</strong>.</p>
<p>In general, an orthogonal basis makes computations easier. The following theorem demonstrates how:</p>
<div class="tip admonition">
<p class="admonition-title">Theorem 5 </p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[
B = \{\vec{u}_1, \vec{u}_2, \dots, \vec{u}_p\}
\]</div>
<p>be an orthogonal basis for a subspace <span class="math notranslate nohighlight">\(W\subset \mathbb{R}^n\)</span>. Moreover, suppose <span class="math notranslate nohighlight">\(y\in W\)</span> can be expressed as a linear combination of the basis elements:</p>
<div class="math notranslate nohighlight">
\[
\vec{y} = c_1\vec{u}_1 + c_2\vec{u}_2 + \dots + c_p\vec{u}_p.
\]</div>
<p>Then the weights <span class="math notranslate nohighlight">\(c_i\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[
c_i = \frac{\vec{u}_i\cdot \vec{y}}{\vec{u}_i\cdot \vec{u}_i} \quad \forall i\in \{1, 2, \dots, p\}.
\]</div>
</div>
<div class="admonition-example-1 admonition">
<p class="admonition-title">Example 1 </p>
<p>Write the vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} = \begin{bmatrix} 6 \\ 1\\ -8 \end{bmatrix}
\end{split}\]</div>
<p>as a linear combination of the vectors in</p>
<div class="math notranslate nohighlight">
\[\begin{split}
S = \left \{\ \begin{bmatrix} 3 \\ 1\\ 1 \end{bmatrix}, \begin{bmatrix} -1 \\ 2\\ 1 \end{bmatrix}, \begin{bmatrix} -1 \\ -4\\ 7 \end{bmatrix}\ \right \}.
\end{split}\]</div>
</div>
<p><strong>Solution:</strong></p>
<p>Since <span class="math notranslate nohighlight">\(S\)</span> is an orthogonal set with three nonzero elements, it forms a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>. Therefore, we can express <span class="math notranslate nohighlight">\(\vec{y}\)</span> in terms of the vectors in <span class="math notranslate nohighlight">\(S\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} = c_1 \begin{bmatrix} 3 \\ 1\\ 1 \end{bmatrix} + c_2 \begin{bmatrix} -1 \\ 2\\ 1 \end{bmatrix} + c_3 \begin{bmatrix} -1 \\ -4\\ 7 \end{bmatrix}.
\end{split}\]</div>
<p>We can solve this vector equation for <span class="math notranslate nohighlight">\(c_i\)</span>s using techniques we learned in section 1.2. However, Theorem 1 suggests an alternative way for computing the coefficients:</p>
<div class="math notranslate nohighlight">
\[
c_i = \frac{\vec{u}_i \cdot \vec{y}}{\vec{u}_i \cdot \vec{u}_i} \quad \text{for all } i\in \{1, 2, 3\}.
\]</div>
<p>By substituting the appropriate values of <span class="math notranslate nohighlight">\(\vec{u}_i\)</span> and <span class="math notranslate nohighlight">\(\vec{y}\)</span> into the formula, we can compute the coefficients <span class="math notranslate nohighlight">\(c_i\)</span>s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">])</span>

<span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">u3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="c1">#computing the weights:</span>

<span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u1</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u1</span><span class="p">)</span>

<span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span>

<span class="n">c3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u3</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;c1 = &quot;</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="s2">&quot;, c2 = &quot;</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="s2">&quot;, c3 = &quot;</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c1 =  1.0 , c2 =  1.0 , c3 =  -1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="orthogonal-projections-onto-1-dimensional-spaces">
<h3>Orthogonal Projections onto <span class="math notranslate nohighlight">\(1\)</span>-dimensional spaces<a class="headerlink" href="#orthogonal-projections-onto-1-dimensional-spaces" title="Permalink to this heading">#</a></h3>
<p>Given a nonzero vector <span class="math notranslate nohighlight">\(\vec{y}\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, decomposing <span class="math notranslate nohighlight">\(\vec{y}\)</span> into a sum of two vectors is a straightforward task. For example, for any choice of <span class="math notranslate nohighlight">\(\alpha, \beta \in \mathbb{R}\)</span> such that <span class="math notranslate nohighlight">\(\alpha + \beta = 1\)</span>, we have:</p>
<div class="math notranslate nohighlight">
\[
\vec{y} = \alpha \vec{y} + \beta \vec{y}.
\]</div>
<p>A more challenging question is when we want to express <span class="math notranslate nohighlight">\(\vec{y}\)</span> as the sum of two vectors, where one is a scalar multiple of a given vector <span class="math notranslate nohighlight">\(\vec{u}\)</span> and the other is orthogonal to <span class="math notranslate nohighlight">\(\vec{u}\)</span>. More perciesely, we seek to write:</p>
<div class="math notranslate nohighlight">
\[
\vec{y} = \vec{p} + \vec{z},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{p} = \alpha \vec{u}\)</span> for some scalar <span class="math notranslate nohighlight">\(\alpha\)</span>, and <span class="math notranslate nohighlight">\(\vec{z} \perp \vec{p}\)</span>. In other words, we are looking for a scalar <span class="math notranslate nohighlight">\(\alpha\)</span> such that <span class="math notranslate nohighlight">\(\vec{z} := \vec{y} - \alpha \vec{u}\)</span> is orthogonal to <span class="math notranslate nohighlight">\(\vec{u}\)</span>, which can be expressed as:</p>
<div class="math notranslate nohighlight">
\[
(\vec{y} - \alpha \vec{u}) \cdot \vec{u} = 0.
\]</div>
<p>Simplifying the equation above, we find:</p>
<div class="math notranslate nohighlight">
\[
\alpha = \frac{\vec{y} \cdot \vec{u}}{\vec{u} \cdot \vec{u}}, \quad \text{and thus} \quad \vec{p} = \frac{\vec{y} \cdot \vec{u}}{\vec{u} \cdot \vec{u}} \ \vec{u}, \quad \text{and} \quad \vec{z} = \vec{y} - \vec{p}.
\]</div>
<p>The vector <span class="math notranslate nohighlight">\(\vec{p}\)</span>, sometimes denoted as <span class="math notranslate nohighlight">\(\text{proj}_{\vec{u}}(\vec{y})\)</span>, is called the <strong>orthogonal projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto <span class="math notranslate nohighlight">\(\vec{u}\)</span></strong>, and <span class="math notranslate nohighlight">\(\vec{z}\)</span> is referred to as the <strong>component of <span class="math notranslate nohighlight">\(\vec{y}\)</span> orthogonal to <span class="math notranslate nohighlight">\(\vec{u}\)</span>.</strong></p>
<div class="admonition-example-2 admonition">
<p class="admonition-title">Example 2</p>
<p>Suppose</p>
<p>$<span class="math notranslate nohighlight">\(
\vec{y} = \begin{bmatrix} 7 \\ 6 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\vec{u} = \begin{bmatrix} 4 \\ 2 \end{bmatrix}
\)</span>$.</p>
<p>Compute the <span class="math notranslate nohighlight">\(\text{proj}_{\vec{u}}(\vec{y})\)</span> and the component of <span class="math notranslate nohighlight">\(\vec{y}\)</span> orthogonal to <span class="math notranslate nohighlight">\(\vec{u}\)</span></p>
</div>
<p><strong>Solution:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup vectors</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># projection of y onto u</span>

<span class="n">proj_y_u</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">))</span><span class="o">*</span> <span class="n">u</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;the projection of y onto u is &quot;</span><span class="p">,</span> <span class="n">proj_y_u</span><span class="p">)</span> 

<span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">proj_y_u</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the component of y orthogonal to u is&quot;</span><span class="p">,</span> <span class="n">z</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the projection of y onto u is  [8. 4.]
the component of y orthogonal to u is [-1.  2.]
</pre></div>
</div>
</div>
</div>
<p>Let’s plot <span class="math notranslate nohighlight">\(\text{proj}_{\vec{u}}(\vec{y})\)</span> and the component of <span class="math notranslate nohighlight">\(\vec{y}\)</span> orthogonal to <span class="math notranslate nohighlight">\(\vec{u}\)</span>  in <span class="math notranslate nohighlight">\(xy\)</span>-plane:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the coordinates in two separate plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># vector y</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">7.1</span><span class="p">,</span><span class="mf">6.1</span><span class="p">,</span><span class="s1">&#39;$y$&#39;</span><span class="p">)</span>

<span class="c1"># vector u</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span><span class="s1">&#39;$u$&#39;</span><span class="p">)</span>

<span class="c1"># orthogonal projection p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">8.1</span><span class="p">,</span><span class="mf">4.1</span><span class="p">,</span><span class="s1">&#39;$p$&#39;</span><span class="p">)</span>

<span class="c1"># vector z</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">2.2</span><span class="p">,</span><span class="s1">&#39;$z = y - p$&#39;</span><span class="p">)</span>

<span class="c1"># A copy of vector z starting at the end of vector p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>



<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;y = p + z&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/aa2fa491c123788abb7f99edf507c333ccd23fce7e069b00448f220de3a5d7d7.png" src="../../_images/aa2fa491c123788abb7f99edf507c333ccd23fce7e069b00448f220de3a5d7d7.png" />
</div>
</div>
</section>
<section id="orthogonal-projections-onto-a-general-subspace">
<h3>Orthogonal Projections onto a general subspace<a class="headerlink" href="#orthogonal-projections-onto-a-general-subspace" title="Permalink to this heading">#</a></h3>
<p>Let’s take another look the above Figure from Example 2. The projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto any vector in the direction of <span class="math notranslate nohighlight">\(\vec{u}\)</span>, results in the same vector <span class="math notranslate nohighlight">\(\text{proj}_{\vec{u}}(\vec{y})\)</span>. In fact, what matters to us is the line that contains <span class="math notranslate nohighlight">\(\vec{u}\)</span> (span<span class="math notranslate nohighlight">\((\{\vec{u}\})\)</span>). With this in mind, we can interpret <span class="math notranslate nohighlight">\(\text{proj}_{\vec{u}}(\vec{y})\)</span> as the projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> generated by <span class="math notranslate nohighlight">\(\vec{u}\)</span>, and we can write it as <span class="math notranslate nohighlight">\(\text{proj}_{\text{span}(L)}(\vec{y})\)</span>. In fact, the notion of projection can be generalized to any subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Theorem 6</p>
<p>Let <span class="math notranslate nohighlight">\(W\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>. Then each <span class="math notranslate nohighlight">\(\vec{y}\in \mathbb{R}^n\)</span> can be written uniquely as</p>
<div class="math notranslate nohighlight">
\[
\vec{y} = \vec{p} + \vec{z}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{p}\)</span> is in <span class="math notranslate nohighlight">\(W\)</span> and <span class="math notranslate nohighlight">\(\vec{z}\)</span> is in <span class="math notranslate nohighlight">\(W^{\perp}\)</span>. Moreover, if <span class="math notranslate nohighlight">\(B = \{\vec{u}_1, \vec{u}_2, \dots \vec{u}_p\}\)</span> is any orthogonal basis of <span class="math notranslate nohighlight">\(W\)</span>, then</p>
<div class="math notranslate nohighlight">
\[
\vec{p} =  \frac{\vec{y}\cdot \vec{u}_1}{\vec{u}_1\cdot \vec{u}_1} + \frac{\vec{y}\cdot \vec{u}_2}{\vec{u}_2\cdot \vec{u}_2} + \dots + \frac{\vec{y}\cdot \vec{u}_p}{\vec{u}_p\cdot \vec{u}_p} \quad  (**) \quad \text{and} \quad \vec{z} = \vec{y} - \vec{p} 
\]</div>
</div>
<p>The vector <span class="math notranslate nohighlight">\(\vec{p}\)</span>, sometimes denoted by <span class="math notranslate nohighlight">\(\text{proj}_{W}(\vec{y})\)</span> is called the <strong>orthogonal projection</strong> of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto <span class="math notranslate nohighlight">\(W\)</span>, and <span class="math notranslate nohighlight">\(\vec{z}\)</span> is called the component of <span class="math notranslate nohighlight">\(\vec{y}\)</span> orthogonal to <span class="math notranslate nohighlight">\(W\)</span>.</p>
<div class="admonition-example-3 admonition">
<p class="admonition-title">Example 3</p>
<p>Suppose</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u} _1 = \begin{bmatrix} 2 \\ 5 \\ -1 \end{bmatrix},
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\vec{u}_2 = \begin{bmatrix} -2 \\ 1 \\ 1 \end{bmatrix},
$$, \end{split}\\$W = \text{span} (\vec{u}_1, \vec{u}_2)$ and \end{aligned}\end{align} \]</div>
<p>\vec{y} = \begin{bmatrix} 1 \ 2 \ 3 \end{bmatrix}.
$$</p>
<p>Compute the <span class="math notranslate nohighlight">\(\text{proj}_{W}(\vec{y})\)</span> and the component of <span class="math notranslate nohighlight">\(\vec{y}\)</span> orthogonal to <span class="math notranslate nohighlight">\(\vec{u}.\)</span></p>
</div>
<p><strong>Solution:</strong></p>
<p><span class="math notranslate nohighlight">\(\vec{u}_1\)</span> and <span class="math notranslate nohighlight">\(\vec{u}_2\)</span> are orthogonal and form a basis for <span class="math notranslate nohighlight">\(W\)</span>; thus, we can use Theorem 3 to compute the projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto <span class="math notranslate nohighlight">\(W\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup vectors</span>

<span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># projection of y onto W</span>

<span class="n">proj_y_W</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u1</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u1</span><span class="p">))</span><span class="o">*</span> <span class="n">u1</span>  <span class="o">+</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span><span class="n">u2</span><span class="p">))</span><span class="o">*</span> <span class="n">u2</span>

<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The projection of y onto W is &quot;</span><span class="p">,</span> <span class="n">proj_y_W</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 

<span class="c1"># component of y orthogonal to p</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">proj_y_W</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The component of y orthogonal to u is&quot;</span><span class="p">,</span> <span class="n">z</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The projection of y onto W is  [-0.4  2.   0.2] 

The component of y orthogonal to u is [1.4 0.  2.8]
</pre></div>
</div>
</div>
</div>
<p>Note that if <span class="math notranslate nohighlight">\(\vec{y}\)</span> happens to be in <span class="math notranslate nohighlight">\(W\)</span> then <span class="math notranslate nohighlight">\(\text{proj}_{W}(\vec{y}) = \vec{y}\)</span>. We can verify this fact for <span class="math notranslate nohighlight">\(\vec{u}_1\)</span> which we know belongs to <span class="math notranslate nohighlight">\(W\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj_u_W</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u1</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u1</span><span class="p">))</span><span class="o">*</span> <span class="n">u1</span>  <span class="o">+</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span><span class="n">u2</span><span class="p">))</span><span class="o">*</span> <span class="n">u2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">proj_u_W</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 2.  5. -1.]
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-best-approximation-theorem">
<h3>The Best Approximation Theorem<a class="headerlink" href="#the-best-approximation-theorem" title="Permalink to this heading">#</a></h3>
<p>Projections can be viewed as linear transformations:</p>
<p>Consider a subspace <span class="math notranslate nohighlight">\(W\)</span> of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, and let <span class="math notranslate nohighlight">\(T_W: \mathbb{R}^{n} \to W\)</span> be the mapping that sends a vector <span class="math notranslate nohighlight">\(\vec{y}\)</span> to its orthogonal projection <span class="math notranslate nohighlight">\(\text{proj}_{W}(\vec{y})\)</span>. It is known that <span class="math notranslate nohighlight">\(T_W\)</span> is a linear transformation. If <span class="math notranslate nohighlight">\(P\)</span> represents the matrix of <span class="math notranslate nohighlight">\(T_W\)</span>, then <span class="math notranslate nohighlight">\(P^2 = P\)</span>. More precisely,</p>
<div class="math notranslate nohighlight">
\[
P\vec{w} \in W \quad \forall \vec{w}\in W
\]</div>
<p>Informally, we say <span class="math notranslate nohighlight">\(P\)</span> does not move elements of <span class="math notranslate nohighlight">\(W\)</span>. The following theorem states that if <span class="math notranslate nohighlight">\(\vec{u}\)</span> is not in <span class="math notranslate nohighlight">\(W\)</span>, then <span class="math notranslate nohighlight">\(P\)</span> sends it to <em>the closest point</em> in <span class="math notranslate nohighlight">\(W\)</span> from <span class="math notranslate nohighlight">\(\vec{u}\)</span>.</p>
<div class="admonition-theorem-7-the-best-approximation-theorem admonition">
<p class="admonition-title">Theorem 7 (The Best Approximation Theorem)</p>
<p>Let <span class="math notranslate nohighlight">\(W\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, and let <span class="math notranslate nohighlight">\(\vec{y}\in \mathbb{R}^n\)</span>. The projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto <span class="math notranslate nohighlight">\(W\)</span>, denoted as <span class="math notranslate nohighlight">\(\vec{p} = \text{proj}_{W}(\vec{y})\)</span>, is the closest point in <span class="math notranslate nohighlight">\(W\)</span> to <span class="math notranslate nohighlight">\(\vec{y}\)</span> in the following sense:</p>
<div class="math notranslate nohighlight">
\[
\| \vec{y}-\vec{p}\| \leq \|\vec{y}-\vec{w}\| \quad \forall \vec{w} \in W
\]</div>
<p>In particular, if <span class="math notranslate nohighlight">\(\vec{y}\in W\)</span>, then the closest point is exactly <span class="math notranslate nohighlight">\(\vec{y}\)</span>. We refer to <span class="math notranslate nohighlight">\(\vec{p}\)</span> as the best approximation to <span class="math notranslate nohighlight">\(\vec{y}\)</span> by elements of <span class="math notranslate nohighlight">\(W\)</span>. The real number <span class="math notranslate nohighlight">\(\| \vec{y}-\vec{p}\|\)</span>) is interpreted as the distance between the vector <span class="math notranslate nohighlight">\(\vec{y}\)</span> and the subspace <span class="math notranslate nohighlight">\(W\)</span>.</p>
</div>
<div class="admonition-example-4 admonition">
<p class="admonition-title">Example 4 </p>
<p>Suppose</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} = \begin{bmatrix} -1 \\ -5 \\ 10 \end{bmatrix},
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u}_2 = \begin{bmatrix} 5 \\ -2 \\ 1 \end{bmatrix},
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(W = \text{span} (\vec{u}_1, \vec{u}_2)\)</span></p>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} = \begin{bmatrix} 1 \\ 2 \\ -1\end{bmatrix}.
\end{split}\]</div>
<ol class="arabic simple">
<li><p>What is the closest point to <span class="math notranslate nohighlight">\(\vec{y}\)</span> in <span class="math notranslate nohighlight">\(W\)</span>?</p></li>
<li><p>Find the distance between <span class="math notranslate nohighlight">\(\vec{y}\)</span> and <span class="math notranslate nohighlight">\(W\)</span>.</p></li>
</ol>
</div>
<p><strong>Solution</strong></p>
<ol class="arabic simple">
<li><p>The closes point is the projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto <span class="math notranslate nohighlight">\(W\)</span>:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup vectors</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># projection of y onto W</span>

<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u1</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u1</span><span class="p">))</span><span class="o">*</span> <span class="n">u1</span>  <span class="o">+</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u2</span><span class="p">,</span><span class="n">u2</span><span class="p">))</span><span class="o">*</span> <span class="n">u2</span>

<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The projection of y onto W is &quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 


<span class="c1"># component of y orthogonal to p</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">p</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The component of y orthogonal to u is&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">)</span>

<span class="c1"># distance between y and W</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The distance between y and $W$ is&quot;</span><span class="p">,</span> <span class="n">r</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The projection of y onto W is  [-1. -8.  4.] 

The component of y orthogonal to u is [0. 3. 6.] 

The distance between y and $W$ is 6.708203932499369
</pre></div>
</div>
</div>
</div>
<p>It is possible to simplify the <span class="math notranslate nohighlight">\((**)\)</span> formula in Theorem 6 that computes projection. First we need the following definition:</p>
<p>A basis <span class="math notranslate nohighlight">\(B\)</span> for a subspace <span class="math notranslate nohighlight">\(W\)</span> is called an <strong>orthonormal basis</strong> if <span class="math notranslate nohighlight">\(B\)</span> is an orthogonal basis and every element of <span class="math notranslate nohighlight">\(B\)</span> is a unit vector. Any orthogonal basis can be turned into an orthonormal basis by normalizing every basis elements.</p>
<div class="tip admonition">
<p class="admonition-title">Theorem 8</p>
<p>Let <span class="math notranslate nohighlight">\(W\)</span> be a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(B = \{\vec{u}_1, \vec{u}_2, \dots \vec{u}_p\}\)</span> be an orthonormal basis of <span class="math notranslate nohighlight">\(W\)</span>. Then, foe every <span class="math notranslate nohighlight">\(\vec{y}\in \mathbb{R}^n\)</span>, the projection of <span class="math notranslate nohighlight">\(\vec{y}\)</span> onto <span class="math notranslate nohighlight">\(W\)</span> is</p>
<div class="math notranslate nohighlight">
\[
\text{proj}_{W}(\vec{y}) = \vec{y}\cdot\vec{u_1} + \vec{y}\cdot\vec{u_2} + \dots + \vec{y}\cdot\vec{u_p}
\]</div>
</div>
<p>We can also represent this formula even in a more compact form:</p>
<p>if <span class="math notranslate nohighlight">\(U = \left[ \vec{u}_1, \vec{u_2}, \dots, \vec{u}_p \right]\)</span> then</p>
<div class="math notranslate nohighlight">
\[
\text{proj}_{W}(\vec{y}) = UU^{T} \vec{y} \quad (*)
\]</div>
<p>A matrix whose columns are orthonormal, such as <span class="math notranslate nohighlight">\(U\)</span>, is called orthogonal matrix. For an <span class="math notranslate nohighlight">\(n\times n\)</span> orthogonal matrix <span class="math notranslate nohighlight">\(U\)</span>, beside (*), we have</p>
<div class="math notranslate nohighlight">
\[
U^TU = I_n 
\]</div>
</section>
<section id="id1">
<h3>Exercises<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="admonition-exercises admonition">
<p class="admonition-title">Exercises</p>
<ol class="arabic simple">
<li><p>Let</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\cal{B}=\left\lbrace \begin{bmatrix}
1 \\ 1
\end{bmatrix}, \begin{bmatrix}
1 \\ -1
\end{bmatrix} \right\rbrace
\end{split}\]</div>
<p>be a basis of <span class="math notranslate nohighlight">\(\mathbb{R}^2.\)</span></p>
<p>a. Check that this is an orthogonal basis.</p>
<p>b. Find the coordinates of the vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{bmatrix}
3 \\ 5
\end{bmatrix}
\end{split}\]</div>
<p>with respect to the basis <span class="math notranslate nohighlight">\(\cal{B}\)</span></p>
<ol class="arabic simple" start="2">
<li><p>Suppose</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u}_1 = \begin{bmatrix} -7 \\ 1 \\ 4 \end{bmatrix},
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{u}_2 = \begin{bmatrix} -1 \\ 1 \\ -2 \end{bmatrix},
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(W = \text{span} (\vec{u}_1, \vec{u}_2)\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} = \begin{bmatrix} -9 \\ 1 \\ 6\end{bmatrix}.
\end{split}\]</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a. Show that $\vec{u}_1$ and $\vec{u}_2$ are orthogonal.

b. What is the closest points to $\vec{y}$ in $W$.    

c. Find the distance between $W$ and $\vec{y}$.

d. Convert $\{\vec{u}_1, \vec{u}_2\}$ into an orthonormal basis for $W$.

e. Compute the projection of $\vec{y}$ onto $W$ using the $(*)$ formula given in Theorem 4.

f. Write $\vec{y}$ as sum of two vectors one in $W$ and the other in $W^{\perp}$.

```
</pre></div>
</div>
</div>
</section>
</section>
<section id="the-gramschmidt-process">
<h2>5. 3 The Gram–Schmidt Process<a class="headerlink" href="#the-gramschmidt-process" title="Permalink to this heading">#</a></h2>
<p>In the previous sections we saw the importance of working with an orthogonal and orthonormal bases. In this section, we explore <em>the Gram–Schmidt process</em> which is a simple algorithm to construct an orthogonal or orthonormal basis from any nonzero subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p>
<section id="idea-construction-of-an-orthogonal-basis-form-a-basis-with-two-elements">
<h3>Idea: construction of an orthogonal basis form a basis with two elements<a class="headerlink" href="#idea-construction-of-an-orthogonal-basis-form-a-basis-with-two-elements" title="Permalink to this heading">#</a></h3>
<p>To see the idea behind the Gram–Schmidt process let’s review Example 2 in Section 5.2:</p>
<p>Suppose <span class="math notranslate nohighlight">\(\vec{y} = \begin{bmatrix} 7 \\ 6 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\vec{u} = \begin{bmatrix} 4 \\ 2 \end{bmatrix}\)</span>. <span class="math notranslate nohighlight">\(\vec{y}\)</span> and <span class="math notranslate nohighlight">\(\vec{u}\)</span> are linearly independent and form a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>. Clearly, as shown in below figure, <span class="math notranslate nohighlight">\(\vec{y}\)</span> and <span class="math notranslate nohighlight">\(\vec{u}\)</span> are not orthogonal, however <span class="math notranslate nohighlight">\(\vec{y}\)</span> and <span class="math notranslate nohighlight">\(\vec{z}\)</span> (the component of <span class="math notranslate nohighlight">\(\vec{y}\)</span> orthogonal to <span class="math notranslate nohighlight">\(\vec{u}\)</span>) form an orthogonal basis for <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup vectors</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># projection of y onto u</span>

<span class="n">proj_y_u</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">))</span><span class="o">*</span> <span class="n">u</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The projection of y onto u is &quot;</span><span class="p">,</span> <span class="n">proj_y_u</span><span class="p">)</span> 

<span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">proj_y_u</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The component of y orthogonal to u is&quot;</span><span class="p">,</span> <span class="n">z</span> <span class="p">)</span>


<span class="c1"># Plot the coordinates in two separate plots</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># vector y</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">7.1</span><span class="p">,</span><span class="mf">6.1</span><span class="p">,</span><span class="s1">&#39;$y$&#39;</span><span class="p">)</span>

<span class="c1"># vector u</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">1.6</span><span class="p">,</span><span class="s1">&#39;$u$&#39;</span><span class="p">)</span>

<span class="c1"># orthogonal projection p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">8.1</span><span class="p">,</span><span class="mf">4.1</span><span class="p">,</span><span class="s1">&#39;$p$&#39;</span><span class="p">)</span>

<span class="c1"># vector z</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">2.2</span><span class="p">,</span><span class="s1">&#39;$z = y - p$&#39;</span><span class="p">)</span>

<span class="c1"># A copy of vector z starting at the end of vector p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>



<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;y = p + z&#39;</span><span class="p">)</span>


<span class="c1">#plt.tight_layout()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The projection of y onto u is  [8. 4.]
The component of y orthogonal to u is [-1.  2.]
</pre></div>
</div>
<img alt="../../_images/aa2fa491c123788abb7f99edf507c333ccd23fce7e069b00448f220de3a5d7d7.png" src="../../_images/aa2fa491c123788abb7f99edf507c333ccd23fce7e069b00448f220de3a5d7d7.png" />
</div>
</div>
<p>Therefore, we have converted a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> into an orthogonal basis for <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>.</p>
</section>
<section id="construction-of-an-orthogonal-basis-form-a-basis-with-three-elements">
<h3>Construction of an orthogonal basis form a basis with three elements<a class="headerlink" href="#construction-of-an-orthogonal-basis-form-a-basis-with-three-elements" title="Permalink to this heading">#</a></h3>
<div class="admonition-example-1 admonition">
<p class="admonition-title">Example 1</p>
<p>Let</p>
<p>$<span class="math notranslate nohighlight">\(
\vec{x}_1 = \begin{bmatrix} 1 \\ 1 \\ 1\\ 1 \end{bmatrix},
\)</span>$,</p>
<p>$<span class="math notranslate nohighlight">\(\vec{x}_2 = \begin{bmatrix} 0 \\ 1 \\ 1\\ 1 \end{bmatrix}\)</span>$,</p>
<p>$<span class="math notranslate nohighlight">\(\vec{x}_3 = \begin{bmatrix} 0 \\ 0 \\ 1\\ 1 \end{bmatrix}\)</span>$, and</p>
<p>$<span class="math notranslate nohighlight">\(W = \text{span}(\{\vec{x}_1, \vec{x}_2, \vec{x}_3\})\)</span>$.</p>
<p>Construct an orthogonal basis for <span class="math notranslate nohighlight">\(W\)</span>.</p>
</div>
<p><strong>Solution:</strong></p>
<p>The set <span class="math notranslate nohighlight">\(\{\vec{x}_1, \vec{x}_2, \vec{x}_3\}\)</span> is a linearly independent and forms a basis for <span class="math notranslate nohighlight">\(W\)</span>. We will construct an orthogonal set of vectors <span class="math notranslate nohighlight">\(\{\vec{v}_1, \vec{v}_2, \vec{v}_3\}\)</span> such that <span class="math notranslate nohighlight">\(W = \text{span}(\{\vec{v}_1, \vec{v}_2, \vec{v}_3\})\)</span>.</p>
<p><strong>Step 1:</strong></p>
<p>Define <span class="math notranslate nohighlight">\(\vec{v}_1 := \vec{x}_1\)</span> and <span class="math notranslate nohighlight">\(W_1 := \text{span}(\vec{v}_1)\)</span>.</p>
<p><strong>Step 2:</strong> We seek a vector <span class="math notranslate nohighlight">\(\vec{v_2}\)</span> orthogonal to <span class="math notranslate nohighlight">\(\vec{v_1}\)</span>. Project <span class="math notranslate nohighlight">\(\vec{x}_2\)</span> onto <span class="math notranslate nohighlight">\(W_1\)</span>; the component of <span class="math notranslate nohighlight">\(\vec{x}_2\)</span> orthogonal to the subspace <span class="math notranslate nohighlight">\(W_1\)</span> has the desired property:</p>
<div class="math notranslate nohighlight">
\[\vec{v}_2 = \vec{x}_2 - \text{proj}_{W_1}^{\vec{x}_2}\quad \implies \vec{v_2} \quad \perp \vec{v_1}\]</div>
<p>Now, let <span class="math notranslate nohighlight">\(W_2 = \text{span}(\vec{v}_1, \vec{v}_2)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup vectors</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">v1</span> <span class="o">=</span> <span class="n">x1</span>
<span class="c1"># projection of x2 onto x1</span>

<span class="n">proj_x2_v1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v1</span><span class="p">))</span><span class="o">*</span> <span class="n">v1</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;The projection of x2 onto x1 is &quot;</span><span class="p">,</span> <span class="n">proj_x2_v1</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 

<span class="n">v2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">proj_x2_v1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The component of x1 orthogonal to W1 is&quot;</span><span class="p">,</span> <span class="n">v2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The projection of x2 onto x1 is  [0.75 0.75 0.75 0.75] 

The component of x1 orthogonal to W1 is [-0.75  0.25  0.25  0.25]
</pre></div>
</div>
</div>
</div>
<p><strong>Step 3:</strong></p>
<p>We can use a similar approach to construct <span class="math notranslate nohighlight">\(\vec{v}_3\)</span>. We find the orthogonal projection of <span class="math notranslate nohighlight">\(\vec{x}_3\)</span> onto <span class="math notranslate nohighlight">\(W_2\)</span> and define <span class="math notranslate nohighlight">\(\vec{v}_3\)</span> as the component of <span class="math notranslate nohighlight">\(\vec{x}_3\)</span> that is orthogonal to the subspace <span class="math notranslate nohighlight">\(W_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\vec{v}_3 = \vec{x}_3 - \text{proj}_{W_2}(\vec{x}_3)
\]</div>
<p>Since both <span class="math notranslate nohighlight">\(\vec{x}_3\)</span> and <span class="math notranslate nohighlight">\(\text{proj}_{W_2}(\vec{x}_3)\)</span> are elements of <span class="math notranslate nohighlight">\(W\)</span>, <span class="math notranslate nohighlight">\(\vec{v}_3\)</span> is also in <span class="math notranslate nohighlight">\(W\)</span>. Moreover, by definition, <span class="math notranslate nohighlight">\(\vec{v}_3\)</span> is orthogonal to both <span class="math notranslate nohighlight">\(\vec{v}_1\)</span> and <span class="math notranslate nohighlight">\(\vec{v}_2\)</span>. Thus, <span class="math notranslate nohighlight">\(\{\vec{v}_1, \vec{v}_2, \vec{v}_3\}\)</span> forms an orthogonal basis for <span class="math notranslate nohighlight">\(W\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># projection of x3 onto W2</span>

<span class="n">proj_x3_W2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">v1</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v1</span><span class="p">))</span><span class="o">*</span> <span class="n">v1</span>  <span class="o">+</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span><span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v2</span><span class="p">))</span><span class="o">*</span> <span class="n">v2</span>

<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;the projection of x3 onto W2 is &quot;</span><span class="p">,</span> <span class="n">proj_x3_W2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 

<span class="c1"># component of y orthogonal to p</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">-</span> <span class="n">proj_x3_W2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the component of x3 orthogonal to W2 is&quot;</span><span class="p">,</span> <span class="n">v3</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the projection of x3 onto W2 is  [0.         0.66666667 0.66666667 0.66666667] 

the component of x3 orthogonal to W2 is [ 0.         -0.66666667  0.33333333  0.33333333]
</pre></div>
</div>
</div>
</div>
<p><strong>Step 4 (Optional)</strong></p>
<p>Normalizing the basis elements <span class="math notranslate nohighlight">\(\vec{v_1}\)</span>, <span class="math notranslate nohighlight">\(\vec{v_2}\)</span>, and <span class="math notranslate nohighlight">\(\vec{v_3}\)</span>, we will get unit vectors <span class="math notranslate nohighlight">\(\vec{e_1}\)</span>, <span class="math notranslate nohighlight">\(\vec{e_2}\)</span>, and <span class="math notranslate nohighlight">\(\vec{e_3}\)</span> respectievely. <span class="math notranslate nohighlight">\(\{\vec{e_1}, \vec{e_2}, \vec{e_3}\}\)</span> is an orthonormal basis for <span class="math notranslate nohighlight">\(W\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The unit vector of v1</span>
<span class="n">e1</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v1</span><span class="p">))</span>

<span class="c1"># The unit vector of v1</span>
<span class="n">e2</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v2</span><span class="p">))</span>

<span class="c1"># The unit vector of v1</span>
<span class="n">e3</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="n">v3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e1 = &quot;</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e2 = &quot;</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e3 = &quot;</span><span class="p">,</span> <span class="n">e3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e1 =  [0.5 0.5 0.5 0.5]
e2 =  [-0.8660254   0.28867513  0.28867513  0.28867513]
e3 =  [ 0.         -0.81649658  0.40824829  0.40824829]
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-gram-schmidt-process">
<h3>The Gram_Schmidt Process<a class="headerlink" href="#the-gram-schmidt-process" title="Permalink to this heading">#</a></h3>
<div class="tip admonition">
<p class="admonition-title">Theorem 8 (the Gram-Schmidt algorithm)</p>
<p>Let <span class="math notranslate nohighlight">\(W \subset \mathbb{R}^n\)</span> be a non-zero subspace, and <span class="math notranslate nohighlight">\(\{\vec{x_1}, \vec{x_2}, \dots, \vec{x_p}\}\)</span> be a basis for <span class="math notranslate nohighlight">\(W\)</span>. Define:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b7b2da7c-6576-437f-9c25-6434639e2302">
<span class="eqno">(35)<a class="headerlink" href="#equation-b7b2da7c-6576-437f-9c25-6434639e2302" title="Permalink to this equation">#</a></span>\[\begin{align}
\vec{v_1} &amp;= \vec{x_1} \quad \text{and} \quad W_1 = \text{span}(\vec{v_1}),\\
\vec{v_2} &amp;= \vec{x_2} - \text{proj}_{W_1}(\vec{x_2}) \quad \text{and} \quad W_2 = \text{span}(\{\vec{v_1}, \vec{v_2}\}),\\
&amp; \vdots \\
\vec{v_p} &amp;= \vec{x_p} - \text{proj}_{W_{p-1}}(\vec{x_p}) \quad \text{and} \quad W_p = \text{span}(\{\vec{v_1}, \vec{v_2}, \dots, \vec{v_3}\}).
\end{align}\]</div>
<p>Then <span class="math notranslate nohighlight">\(W = W_p\)</span>, and <span class="math notranslate nohighlight">\(\{\vec{v_1}, \vec{v_2}, \dots, \vec{v_p}\}\)</span> is an orthogonal basis for <span class="math notranslate nohighlight">\(W\)</span>. Moreover, if <span class="math notranslate nohighlight">\(\vec{e_1}, \vec{e_2}, \dots, \vec{e_p}\)</span> are the unit vectors of <span class="math notranslate nohighlight">\(\vec{v_1}, \vec{v_2}, \dots, \vec{v_p}\)</span> respectively, then <span class="math notranslate nohighlight">\(\{\vec{e_1}, \vec{e_2}, \dots, \vec{e_p}\}\)</span> is an orthonormal basis for <span class="math notranslate nohighlight">\(W\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup A</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">])</span>

<span class="c1"># setup Q</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">e3</span><span class="p">])</span>

<span class="c1"># Compute R= Q^T*A</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="o">@</span> <span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2.00000000e+00, 1.50000000e+00, 1.00000000e+00],
       [1.11022302e-16, 8.66025404e-01, 5.77350269e-01],
       [1.11022302e-16, 1.11022302e-16, 8.16496581e-01]])
</pre></div>
</div>
</div>
</div>
<p>Note that elements below the diagonal in <span class="math notranslate nohighlight">\(R\)</span> are very small and close to zero. In fact, <span class="math notranslate nohighlight">\(R\)</span> should be an upper triangular matrix. The reason why Python won’t display the exact decimal numbers we expect is that some decimal fractions cannot be represented exactly as binary fractions. To address this issue, we can set very small elements of <span class="math notranslate nohighlight">\(R\)</span> to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span> <span class="o">=</span> <span class="mf">0.000001</span> 
<span class="n">R</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2.        , 1.5       , 1.        ],
       [0.        , 0.8660254 , 0.57735027],
       [0.        , 0.        , 0.81649658]])
</pre></div>
</div>
</div>
</div>
<p><strong>Numerical Note</strong></p>
<p>When the Gram–Schmidt process is run on a computer, round off error can build up as the vectors <span class="math notranslate nohighlight">\(\vec{v_k}\)</span> are calculated, one by one. Specifically, for large and unequal values of <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, the dot products <span class="math notranslate nohighlight">\(\vec{v_k}^T \cdot \vec{u_j}\)</span> may not be sufficiently close to zero, leading to a loss of orthogonality. This loss of orthogonality can be reduced substantially by rearranging the order of the calculations.</p>
<p>We can also utilize <code class="docutils literal notranslate"><span class="pre">numpy.linalg.qr</span></code> in Python to compute the QR factorization of a matrix. This function provides an efficient and accurate implementation of the Gram-Schmidt process avoiding unnecessary loss of orthogonality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q = 
 [[-0.5         0.8660254   0.        ]
 [-0.5        -0.28867513  0.81649658]
 [-0.5        -0.28867513 -0.40824829]
 [-0.5        -0.28867513 -0.40824829]] 


R = 
 [[-2.         -1.5        -1.        ]
 [ 0.         -0.8660254  -0.57735027]
 [ 0.          0.         -0.81649658]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>Exercises<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<div class="admonition-exercises admonition">
<p class="admonition-title">Exercises</p>
<ol class="arabic simple">
<li><p>Let</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{x}_1 = \begin{bmatrix} 3 \\ 1 \\ -1\\ 3 \end{bmatrix},
$$,\end{split}\]</div>
<p>\vec{x}_2 = \begin{bmatrix} -5 \ 1 \ 5\ -7 \end{bmatrix},
$$,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{x}_3 = \begin{bmatrix} 1\\ 1 \\ -2\\ 8 \end{bmatrix},
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
W = \text{span}(\{\vec{x}_1, \vec{x}_2, \vec{x}_3\}).
\]</div>
<p>Construct an orthonormal basis for <span class="math notranslate nohighlight">\(W\)</span>.</p>
<ol class="arabic simple" start="2">
<li><p>Let <span class="math notranslate nohighlight">\(A\)</span> be a matrix whose columns are <span class="math notranslate nohighlight">\(\vec{x}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{x}_2\)</span>, <span class="math notranslate nohighlight">\(\vec{x}_3\)</span> from Exercise 1:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \begin{bmatrix} 3 &amp; -5 &amp; 1 \\  1 &amp; 1 &amp; 1 \\ -1 &amp; 5 &amp; -2 \\ 3 &amp; -7 &amp; 8\end{bmatrix}.
\end{split}\]</div>
<p>Find a QR decomposition for <span class="math notranslate nohighlight">\(A\)</span>.</p>
<ol class="arabic simple" start="3">
<li><p>Let <span class="math notranslate nohighlight">\(A = QR\)</span>, where <span class="math notranslate nohighlight">\(Q\)</span> is an <span class="math notranslate nohighlight">\(m \times n\)</span> matrix with orthogonal columns, and <span class="math notranslate nohighlight">\(R\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix. Show that if the columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly dependent, then <span class="math notranslate nohighlight">\(R\)</span> cannot be invertible.</p></li>
</ol>
</div>
</section>
</section>
<section id="least-squares-problems">
<h2>5.4 Least-Squares Problems<a class="headerlink" href="#least-squares-problems" title="Permalink to this heading">#</a></h2>
<p>Linear systems arising in applications are often inconsistent. In such situations, the best one can do is to find a vector <span class="math notranslate nohighlight">\(\vec{x}'\)</span> that makes <span class="math notranslate nohighlight">\(A\vec{x}\)</span> as close as possible to <span class="math notranslate nohighlight">\(\vec{b}\)</span>. We think of <span class="math notranslate nohighlight">\(A\vec{x}\)</span> as an approximation of <span class="math notranslate nohighlight">\(\vec{b}\)</span>. The smaller <span class="math notranslate nohighlight">\(\|\vec{b} - A\vec{x}\|\)</span>, the better the approximation. Therefore, we are looking for a vector <span class="math notranslate nohighlight">\(\hat{y}\)</span> such that <span class="math notranslate nohighlight">\(\|\vec{b} - A\hat{x}\|\)</span> is as small as possible. Such <span class="math notranslate nohighlight">\(\vec{y}\)</span> is called the <em>least square solution</em> of <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span>. The name is motivated by the fact that <span class="math notranslate nohighlight">\(\|\vec{b} - A\hat{x}\|\)</span> is the square root of a sum of squares. In this section we explore this idea further.</p>
<p>Let <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> be inconsistent, which implies <span class="math notranslate nohighlight">\(\vec{b}\notin \text{col}(A)\)</span>. Note that no matter what <span class="math notranslate nohighlight">\(\vec{x}\)</span> is, <span class="math notranslate nohighlight">\(A\vec{x}\)</span> lies in <span class="math notranslate nohighlight">\(\text{col}(A)\)</span>. From Section 5.2, we know that the closest point to <span class="math notranslate nohighlight">\(\vec{b}\)</span> in <span class="math notranslate nohighlight">\(\text{col}(A)\)</span> is the projection of <span class="math notranslate nohighlight">\(\vec{b}\)</span> onto <span class="math notranslate nohighlight">\(\text{col}(A)\)</span> (the best approximation problem). Let <span class="math notranslate nohighlight">\(\hat{b} = \text{proj}_{\text{col}(A)}(\vec{b})\)</span>. Since <span class="math notranslate nohighlight">\(A\vec{x} = \hat{b}\)</span> is consistent, there are <span class="math notranslate nohighlight">\(\hat{x}\)</span> such that <span class="math notranslate nohighlight">\(A\hat{x} = \hat{b}\)</span>. <span class="math notranslate nohighlight">\(\hat{x}\)</span> is a least square solution of <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span>. Recall that <span class="math notranslate nohighlight">\(\vec{b} -\hat{b}\)</span> is orthogonal to <span class="math notranslate nohighlight">\(\text{col}(A)\)</span>, and thus so is <span class="math notranslate nohighlight">\(\vec{b} - A\hat{x}\)</span>. In other words, <span class="math notranslate nohighlight">\(\vec{b} - A\hat{x}\)</span> is orthogonal to each column of <span class="math notranslate nohighlight">\(A\)</span>, and we have:</p>
<div class="math notranslate nohighlight">
\[
A^{T}(\vec{b} - A\hat{x}) = 0 \quad \text{or} \quad A^{T}A\vec{x}= A^{T}\vec{b}.
\]</div>
<p>The equation <span class="math notranslate nohighlight">\(A^{T}A\vec{x}= A^{T}\vec{b}\)</span> is called the <strong>normal equation</strong> for <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span>.</p>
<div class="admonition-theorem-9 admonition">
<p class="admonition-title">Theorem 9</p>
<p>The set of least-squares solutions of <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> coincides with the nonempty set of solutions of the normal equation <span class="math notranslate nohighlight">\(A^{T}A\vec{x}= A^{T}\vec{b}\)</span>.</p>
</div>
<div class="admonition-example-1 admonition">
<p class="admonition-title">Example 1</p>
<p>Find a least-squares solution of the inconsistent system <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> for</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \begin{bmatrix} 4 &amp; 2\\ 0 &amp; 2 \\ 1 &amp; 1 \end{bmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{b} = \begin{bmatrix} 2 \\0 \\11 \end{bmatrix}.
\end{split}\]</div>
<p><strong>Solution:</strong> First, let’s find <span class="math notranslate nohighlight">\(A^TA\)</span> and <span class="math notranslate nohighlight">\(A^T\vec{b}\)</span>:</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">]])</span>

<span class="c1"># compute A^TA</span>
<span class="n">ATA</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">A</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A^TA = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ATA</span><span class="p">)</span>

<span class="c1"># compute A^Tb</span>
<span class="n">ATb</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">b</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> A^Tb = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ATb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A^TA = 
 [[17  1]
 [ 1  5]]

 A^Tb = 
 [[19]
 [11]]
</pre></div>
</div>
</div>
</div>
<p>Thus, the normal equation for <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix} 17 &amp; 1 \\ 1 &amp; 5 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = \begin{bmatrix} 19 \\ 11 \end{bmatrix}.
\end{split}\]</div>
<p>To solve this equation, we can use row operations; alternatively, since <span class="math notranslate nohighlight">\(A^TA\)</span> is invertible and <span class="math notranslate nohighlight">\(2 \times 2\)</span>, we can use the invertible matrix theorem. In many calculations, <span class="math notranslate nohighlight">\(A^TA\)</span> is invertible, but this is not always the case. In Theorem 2, we will see when this is true. The least square solution <span class="math notranslate nohighlight">\(\hat{x}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
\hat{x} = (A^TA)^{-1} A^{T}\vec{b}.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># computing x_hat</span>

<span class="n">x_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">ATA</span><span class="p">)</span> <span class="o">@</span> <span class="n">ATb</span>
<span class="n">x_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.],
       [2.]])
</pre></div>
</div>
</div>
</div>
<div class="admonition-example-2 admonition">
<p class="admonition-title">Example 2 </p>
<p>Find a least-squares solution of the inconsistent system</p>
<div class="math notranslate nohighlight">
\[
A\vec{x} = \vec{b}
\]</div>
<p>for</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \begin{bmatrix} 1 &amp; 1 &amp; 0 &amp; 0\\ 1 &amp; 1 &amp; 0 &amp; 0\\ 1 &amp; 0 &amp; 1 &amp; 0\\1 &amp; 0 &amp; 1 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 1\\1 &amp; 0 &amp; 0 &amp; 1 \end{bmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{b} = \begin{bmatrix} -3 \\-1 \\0 \\2 \\5 \\1 \end{bmatrix}.
\end{split}\]</div>
<p><strong>Solution</strong></p>
<p>Let’s set up the normal equation for <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span>, and find a solution for it.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>


<span class="c1"># compute A^TA</span>
<span class="n">ATA</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">A</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A^TA = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ATA</span><span class="p">)</span>

<span class="c1"># compute A^Tb</span>
<span class="n">ATb</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> A^Tb = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ATb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A^TA = 
 [[6 2 2 2]
 [2 2 0 0]
 [2 0 2 0]
 [2 0 0 2]]

 A^Tb = 
 [[ 4]
 [-4]
 [ 2]
 [ 6]]
</pre></div>
</div>
</div>
</div>
<p>Thus, the normal equation is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix} 6 &amp; 2 &amp; 2 &amp; 2 \\ 2 &amp; 2 &amp; 0 &amp; 0 \\ 2 &amp; 0 &amp; 2 &amp; 0 \\ 2 &amp; 0 &amp; 0 &amp; 2 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ x_3 \\ x_4 \end{bmatrix} = \begin{bmatrix} 4 \\ -4 \\ 2 \\6 \end{bmatrix}
\end{split}\]</div>
<p>To solve this equation we form its augmented matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#aumented </span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">ATA</span><span class="p">,</span> <span class="n">ATb</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 6,  2,  2,  2,  4],
       [ 2,  2,  0,  0, -4],
       [ 2,  0,  2,  0,  2],
       [ 2,  0,  0,  2,  6]])
</pre></div>
</div>
</div>
</div>
<p>Call row operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Swap two rows</span>

<span class="k">def</span> <span class="nf">swap</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">):</span>
    
    <span class="n">copy_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> 
  
    <span class="n">copy_matrix</span><span class="p">[</span><span class="n">row1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">row2</span><span class="p">,:]</span>
    <span class="n">copy_matrix</span><span class="p">[</span><span class="n">row2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">row1</span><span class="p">,:]</span>
    
    <span class="k">return</span> <span class="n">copy_matrix</span>


<span class="c1"># Multiple all entries in a row by a nonzero number</span>


<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">scalar</span><span class="p">):</span>
    <span class="n">copy_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> 
    <span class="n">copy_matrix</span><span class="p">[</span><span class="n">row</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">scalar</span><span class="o">*</span><span class="n">matrix</span><span class="p">[</span><span class="n">row</span><span class="p">,:]</span>  
    <span class="k">return</span> <span class="n">copy_matrix</span>

<span class="c1"># Replacing a row1 by the sum of itself and a multiple of rpw2 </span>

<span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">,</span> <span class="n">scalar</span><span class="p">):</span>
    <span class="n">copy_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="n">copy_matrix</span><span class="p">[</span><span class="n">row1</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">row1</span><span class="p">]</span><span class="o">+</span> <span class="n">scalar</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">[</span><span class="n">row2</span><span class="p">]</span> 
    <span class="k">return</span> <span class="n">copy_matrix</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">swap</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">M1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2.,  0.,  2.,  0.,  2.],
       [ 2.,  2.,  0.,  0., -4.],
       [ 6.,  2.,  2.,  2.,  4.],
       [ 2.,  0.,  0.,  2.,  6.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M2</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 2.,  2.,  0.,  0., -4.],
       [ 6.,  2.,  2.,  2.,  4.],
       [ 2.,  0.,  0.,  2.,  6.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M3</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  2., -2.,  0., -6.],
       [ 6.,  2.,  2.,  2.,  4.],
       [ 2.,  0.,  0.,  2.,  6.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M4</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="n">M4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  2., -2.,  0., -6.],
       [ 0.,  2., -4.,  2., -2.],
       [ 2.,  0.,  0.,  2.,  6.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M5</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  2., -2.,  0., -6.],
       [ 0.,  2., -4.,  2., -2.],
       [ 0.,  0., -2.,  2.,  4.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M6</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">M5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  1., -1.,  0., -3.],
       [ 0.,  2., -4.,  2., -2.],
       [ 0.,  0., -2.,  2.,  4.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M7</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  1., -1.,  0., -3.],
       [ 0.,  0., -2.,  2.,  4.],
       [ 0.,  0., -2.,  2.,  4.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M8</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">M7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  1., -1.,  0., -3.],
       [-0., -0.,  1., -1., -2.],
       [ 0.,  0., -2.,  2.,  4.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M9</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">M9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  1.,  0.,  1.],
       [ 0.,  1., -1.,  0., -3.],
       [-0., -0.,  1., -1., -2.],
       [ 0.,  0.,  0.,  0.,  0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M10</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">M10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  0.,  1.,  3.],
       [ 0.,  1., -1.,  0., -3.],
       [-0., -0.,  1., -1., -2.],
       [ 0.,  0.,  0.,  0.,  0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M11</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">M10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">M11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  0.,  0.,  1.,  3.],
       [ 0.,  1.,  0., -1., -5.],
       [-0., -0.,  1., -1., -2.],
       [ 0.,  0.,  0.,  0.,  0.]])
</pre></div>
</div>
</div>
</div>
<p>The general solution is <span class="math notranslate nohighlight">\(x_1 = 3 - x_4\)</span>, <span class="math notranslate nohighlight">\(x_2 = -5 + x_4\)</span>, <span class="math notranslate nohighlight">\(x_3 = -2 + x_4\)</span>, and <span class="math notranslate nohighlight">\(x_4\)</span> is a free parameter. So the general least-squares solution of <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> has the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{x} = \begin{bmatrix} 3 \\ -5 \\ -2 \\ 0 \end{bmatrix} + x_4 \begin{bmatrix} -1 \\ 1 \\ 1 \\ 0 \end{bmatrix}.
\end{split}\]</div>
<p>Any linear system <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> admits at least one least-squares solution (the orthogonal projection <span class="math notranslate nohighlight">\(\hat{b}\)</span>). For example, the least-squares solution of <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> in Example 1 was unique, while the linear system in Example 2 has infinitely many least-squares solutions.</p>
<p>The next theorem gives useful criteria for determining when there is only one least-squares solution.</p>
<div class="tip admonition">
<p class="admonition-title">Theorem 10</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix. The following statements are equivalent:</p>
<ol class="arabic simple">
<li><p>The equation <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span> has a unique least-squares solution for each <span class="math notranslate nohighlight">\(\vec{b}\in \mathbb{R}^n\)</span>.</p></li>
<li><p>The columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent.</p></li>
<li><p>The matrix <span class="math notranslate nohighlight">\(A^TA\)</span> is invertible.</p></li>
</ol>
<p>In any of these cases, the least-squares solution <span class="math notranslate nohighlight">\(\hat{x}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
\hat{x} = (A^TA)^{-1} A^T \vec{b}.
\]</div>
<p>Moreover, if <span class="math notranslate nohighlight">\(A = QR\)</span> is a <span class="math notranslate nohighlight">\(QR\)</span>-factorization of <span class="math notranslate nohighlight">\(A\)</span>, then the least-squares solution <span class="math notranslate nohighlight">\(\hat{x}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
\hat{x} = R^{-1} Q^{T} \vec{b}. \quad (*)
\]</div>
</div>
<div class="admonition-example-3 admonition">
<p class="admonition-title">Example 3</p>
<p>Let <span class="math notranslate nohighlight">\(A = \begin{bmatrix} 1 &amp; 3 &amp; 5 \\ 1 &amp; 1 &amp; 0 \\ 1 &amp; 1 &amp; 2 \\ 1 &amp; 3 &amp; 3\end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\vec{b} = \begin{bmatrix} 3 \\ 5 \\ 7 \\ -3 \end{bmatrix}\)</span>. Find a least-squares solution of <span class="math notranslate nohighlight">\(A\vec{x} = \vec{b}\)</span>.</p>
</div>
<p><strong>Solution:</strong></p>
<p>A QR-factorization of <span class="math notranslate nohighlight">\(A\)</span> can be obtained as in Section 5.3 using <code class="docutils literal notranslate"><span class="pre">numpy.linalg.qr()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>

<span class="c1"># QR factorization</span>

<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R = </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q = 
 [[-0.5  0.5 -0.5]
 [-0.5 -0.5  0.5]
 [-0.5 -0.5 -0.5]
 [-0.5  0.5  0.5]] 

R = 
 [[-2. -4. -5.]
 [ 0.  2.  3.]
 [ 0.  0. -2.]]
</pre></div>
</div>
</div>
</div>
<p>Now we compute  <span class="math notranslate nohighlight">\(\hat{x} = R^{-1} Q^{T} \vec{b}:\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setup</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>

<span class="c1">#computing x_hat</span>

<span class="n">x_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="n">Q</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span>
<span class="n">x_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[10.],
       [-6.],
       [ 2.]])
</pre></div>
</div>
</div>
</div>
<section id="numerical-note">
<h3>Numerical Note<a class="headerlink" href="#numerical-note" title="Permalink to this heading">#</a></h3>
<p>Since <span class="math notranslate nohighlight">\(R\)</span> in <span class="math notranslate nohighlight">\((*)\)</span> is an upper triangular matrix, we can alternatively compute <span class="math notranslate nohighlight">\(\hat{x}\)</span> by finding the exact solutions of:</p>
<div class="math notranslate nohighlight">
\[
R\hat{x} = Q^{T} \vec{b}. \quad (**)
\]</div>
<p>For large matrices, solving <span class="math notranslate nohighlight">\((**)\)</span> by back-substitution or row operations is faster than computing <span class="math notranslate nohighlight">\(R^{-1}\)</span> and using <span class="math notranslate nohighlight">\((*)\)</span>.</p>
</section>
<section id="id3">
<h3>Exercises<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Undergrad/Linear"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4. Eigenvalues and Eigenvectors</p>
      </div>
    </a>
    <a class="right-next"
       href="Solutions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solutions to Exercises</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-product-and-orthogonality">5.1 Inner product and Orthogonality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inner-product">Inner product</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#angles-and-orthogonality">Angles and Orthogonality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-projection">5. 2 Orthogonal Projection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-set">Orthogonal Set</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-projections-onto-1-dimensional-spaces">Orthogonal Projections onto <span class="math notranslate nohighlight">\(1\)</span>-dimensional spaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-projections-onto-a-general-subspace">Orthogonal Projections onto a general subspace</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-best-approximation-theorem">The Best Approximation Theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-gramschmidt-process">5. 3 The Gram–Schmidt Process</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#idea-construction-of-an-orthogonal-basis-form-a-basis-with-two-elements">Idea: construction of an orthogonal basis form a basis with two elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#construction-of-an-orthogonal-basis-form-a-basis-with-three-elements">Construction of an orthogonal basis form a basis with three elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-gram-schmidt-process">The Gram_Schmidt Process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercises</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-problems">5.4 Least-Squares Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-note">Numerical Note</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercises</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara, Peter Jantsch, Thomas VanDrunen, and  Claire Wagner, Editors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>