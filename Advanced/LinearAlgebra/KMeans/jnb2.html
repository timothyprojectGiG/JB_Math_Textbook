
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>10.3. K-means Clustering &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=07d05eac" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Advanced/LinearAlgebra/KMeans/jnb2';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="10.4. Dimension Reduction by Principal Component Analysis" href="../PCA/jnb3.html" />
    <link rel="prev" title="10.2. OLS Linear Regression" href="../OLS/jnb1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="An Introduction to Python Jupyter Notebooks for College Math Teachers - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="An Introduction to Python Jupyter Notebooks for College Math Teachers - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    An Introduction to Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Preface.html">1. PREFACE</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../JMM23.html">1.1. JMM 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../labsolutions.html">1.2. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../PreCollege.html">2. PRE-COLLEGE</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/PreCollegeIntro.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Elementary/Arithmetic/elementary.html">2.2. Elementary Blackboard Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/GettingStarted/python.html">2.3. Beginning Python Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/Celestial/Chicago.html">2.4. Glimpse of Chicago</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/Celestial/steam.html">2.5. Arts in STEM (STEAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/solutions.html">2.6. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/Celestial/demo.html">2.7. JNB LAB: After-School Program Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../PreCollege/Celestial/demosolutions.html">2.8. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Intropy.html">3. PYTHON PROGRAMMING GUIDE - Thomas VanDrunen, Yiheng Liang</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Programming/PythonProgrammingGuideIntro.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Programming/Introduction_to_Python.html">3.2. Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Programming/Data.html">3.3. Working with Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Programming/solutions.html">3.4. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Programming/Plab.html">3.5. JNB Lab: Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Programming/Plabsolutions.html">3.6. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Data.html">4. EXPLORATORY DATA ANALYSIS - Jonathan Zhu</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec1_basic_intro.html">4.1. Introduction to EDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec2_basic_tabular.html">4.2. Data Investigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec3_basic_plotting.html">4.3. Plotting and Statistical Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec4_basic_solutions.html">4.4. Solutions to Exercises: Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec5_advanced_intro.html">4.5. Intro to Advanced EDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec6_advanced_tabular.html">4.6. Data Investigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec7_advanced_plotting.html">4.7. Plotting and Statistical Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec8_advanced_report.html">4.8. Making EDA Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/sec9_advanced_solution.html">4.9. Solutions to Exercises - Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/lab.html">4.10. JNB Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/EDA/labsolution.html">4.11. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Prob.html">5. PROBABILITY - Laura Gross, Yiheng Liang</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob1.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob2.html">5.3. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob3.html">5.4. Conditional Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob4.html">5.5. Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob4a.html">5.6. Random Walks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob5.html">5.7. Agent-based Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/prob6.html">5.8. Mathematical Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/solutions.html">5.9. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/lab.html">5.10. JNB Lab Homicides in Chicago</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/ProbIntro/labsolution.html">5.11. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Stat.html">6. STATISTICAL INFERENCE - Peter Jantsch, Claire Wagner</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/StatInf/00_Instructor_Notes.html">6.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/StatInf/01_Foundations.html">6.2. Foundations of Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/StatInf/02_Inference_Categorical.html">6.3. Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/StatInf/03_Inference_Numerical.html">6.4. Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ProbStat/StatInf/04_Regression.html">6.5. Linear Regression</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../AppliedCalc.html">7. APPLIED CALCULUS FOR DAILY LIFE - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/AppliedCalculusIntro.html">7.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/twocommodity.html">7.2. Linear Systems and the Two-commodity Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/marginal.html">7.3. Marginal and Average Cost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/design.html">7.4. Optimization and Object Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/cobbs.html">7.5. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/rates.html">7.6. Related Rates and Volumes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/football.html">7.7. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/jnb7.html">7.8. Probability Distributions and Drive Thrus</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/control.html">7.10. Normal Distribution and Process Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/ols.html">7.11. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/gini.html">7.12. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/income.html">7.13. Integral Test and Income Streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/ode.html">7.14. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/solutions.html">7.15. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/AClab.html">7.16. JNB Lab: Calculus of Entropy in Daily Life and Monte Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedCalc/AClabsolutions.html">7.17. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Calc.html">8. CALCULUS - Inne Singgih</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/Intro.html">8.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/2Functions.html">8.2. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/3Limits.html">8.3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/4%20Derivatives.html">8.4. Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/5%20Integrals.html">8.5. Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/6%20ParametricEquations.html">8.6. Parametric Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/7%20Sequences%20and%20Series.html">8.7. Sequences and Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/Solutions.html">8.8. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/clab.html">8.9. JNB LAB: Calculus Animations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Calculus/clabsolution.html">8.10. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Linear.html">9. LINEAR ALGEBRA - Soheil Anbouhi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/0.html">9.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/1.html">9.2. Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/2.html">9.3. Matrices and Determinants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/3.html">9.4. Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/4.html">9.5. Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/5.html">9.6. Orthogonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/Solutions.html">9.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/LAlab.html">9.8. Linear Algebra Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/Linear/LAlabsolutions.html">9.9. Linear Algebra Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../Aplin.html">10. LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS - Wheaton College Team</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Introduction.html">10.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../OLS/jnb1.html">10.2. OLS Linear Regression</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">10.3. K-means Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PCA/jnb3.html">10.4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SVM/jnb4.html">10.5. Binary Classification of Labeled Data by Support Vector Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solutions.html">10.6. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ALlab.html">10.7. JNB LAB: Linear Algebra for Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ALlabsolution.html">10.8. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../DifEq.html">11. DIFFERENTIAL EQUATIONS - Rachel Petrik</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/Differential%20Equations.html">11.1. Overview of Chapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/DE2.html">11.2. Introduction to Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/DE3.html">11.3. First-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/DE4.html">11.4. Second-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/DE5.html">11.5. Systems of First-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/DE6.html">11.6. Laplace Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/DESolutions.html">11.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/Differential%20Equations%20Book%201%20Lab.html">11.8. Differential Equations Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/DifEq/Differential%20Equations%20Book%201%20Lab%20Answer%20Key.html">11.9. Differential Equations Lab Answer Key</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../AppliedDifEq.html">12. DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/AppliedDiffEqIntro.html">12.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/covid.html">12.2. Logistic Growth and COVID-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/sir.html">12.3. The Basic SIR Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/cholera.html">12.4. Cholera in Haiti</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/cws/cws.html">12.5. CWS Model of Alzheimer’s Disease</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/gravity/gravity.html">12.6. Gravity Fed Water Delivery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/erc/erc.html">12.7. Earthquake Resistant Construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/solutions.html">12.8. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/hiv/lab.html">12.9. JNB Lab: HIV-AIDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Undergrad/AppliedDifEq/labsolutions.html">12.10. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../ComplexVar.html">13. COMPLEX VARIABLES IN GROUNDWATER MODELING - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_1.html">13.1. Setting the Scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_2.html">13.2. Complex Analysis Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_3.html">13.3. Idealized Groundwater Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_4.html">13.4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_solutions.html">13.5. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_lab.html">13.6. JNB LAB: Complex Potentials and Contaminant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Complex/complex_variables_lab_solution.html">13.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../AdvData.html">14. ADVANCED DATA ANALYSIS - Ying Li, Jonathan Zhu, Claire Wagner</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec0_data.html">14.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec1_preprocessing.html">14.2. Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec2_transform_features.html">14.3. About Text Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec3_doc_embedding.html">14.4. Document Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec4_classification_algos.html">14.5. Classification of Texts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec5_classification_eval.html">14.6. Evaluating Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/sec6_applications.html">14.7. Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AdvDataAnalysis/solutions.html">14.8. Solutions to Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../ComplexSystems.html">15. COMPLEX SYSTEMS - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_1.html">15.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_2.html">15.2. Fundamental Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_3.html">15.3. Mathematical Concepts from Equilibrium Statistical Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_4.html">15.4. Societal Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_solutions.html">15.5. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_lab.html">15.6. JNB LAB: Complex Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ComplexSystems/complex_systems_labsolution.html">15.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/timothyprojectGiG/JB_Math_Textbook/main?urlpath=tree/src/Advanced/LinearAlgebra/KMeans/jnb2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook/issues/new?title=Issue%20on%20page%20%2FAdvanced/LinearAlgebra/KMeans/jnb2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/Advanced/LinearAlgebra/KMeans/jnb2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>K-means Clustering</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-of-data">10.3.1. Clustering of Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-by-gradient-descent">10.3.2. Optimization by Gradient Descent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-1">10.3.3. Example 3.1.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-descent">Coordinate Descent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-by-coordinate-and-block-descent">Optimization by Coordinate and Block Descent</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-2">Example 3.2.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#block-descent">Block Descent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering-optimization-problem">K-MEANS CLUSTERING OPTIMIZATION PROBLEM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-3">Example 3.3.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-block-descents-stepwise-minimization-of-j">Proof of Block Descent’s Stepwise Minimization of <span class="math notranslate nohighlight">\(J\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">10.3.4. Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="k-means-clustering">
<h1><span class="section-number">10.3. </span>K-means Clustering<a class="headerlink" href="#k-means-clustering" title="Link to this heading">#</a></h1>
<section id="clustering-of-data">
<span id="index-0"></span><h2><span class="section-number">10.3.1. </span>Clustering of Data<a class="headerlink" href="#clustering-of-data" title="Link to this heading">#</a></h2>
<p>In this section, we will consider the problem of clustering into <span class="math notranslate nohighlight">\(k\)</span> groups a set of unlabelled points in a coordinate plane <span class="math notranslate nohighlight">\(\mathbb{R}^2.\)</span> For example, the figure below is a scatterplot of a data set from the Chicago Data Portal that shows the locations of 1,000 recent acts of violence in the city of Chicago. Police departments may use data like this to help identify clusters or “hot spots” in their violence reduction efforts. Another question is whether these crime locations might be naturally divided in some way, say, into two halves.</p>
<a class="reference internal image-reference" href="../../../_images/fig6a.png"><img alt="../../../_images/fig6a.png" src="../../../_images/fig6a.png" style="width: 200px;" /></a>
<p>We can use <span class="math notranslate nohighlight">\(k\)</span>-means clustering to separate the mapped crime data as points in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> into an arbitrary number of groups solely based on location, as seen in the  figure below. This figure shows  <span class="math notranslate nohighlight">\(k=2\)</span> clusters.  The I-55 Stevenson Expressway, which runs northeast from Stickney to downtown Chicago, is close to the boundary between the two clusters. High-density areas exist within each cluster, one in the West side and the other in much of the South side of the city. These areas reflect a long history of injustices in these parts of Chicago [Amdat 2021].</p>
<a class="reference internal image-reference" href="../../../_images/fig6b.png"><img alt="../../../_images/fig6b.png" src="../../../_images/fig6b.png" style="width: 200px;" /></a>
<p>Data source: Chicago Data Portal <a class="reference external" href="https://data.cityofchicago.org/Public-Safety/Violence-Reduction-Victims-of-Homicides-and-Non-Fa/gumc-mgzr">https://data.cityofchicago.org/Public-Safety/Violence-Reduction-Victims-of-Homicides-and-Non-Fa/gumc-mgzr</a>.</p>
<p>Data was extracted on December 7th, 2022. Map tiles by Stamen Design, under CC by 3.0. Data by © OpenStreetMap, under ODbL.</p>
<p>As discussed in the previous section on OLS linear regression, minimization of a loss function <span class="math notranslate nohighlight">\(J(c_0,c_1)\)</span> is the basis for finding a line <span class="math notranslate nohighlight">\(y=c_0+c_1 x\)</span> which best fits a collection of data points <span class="math notranslate nohighlight">\((x_1,y_1), (x_2,y_2),\dots (x_n,y_n).\)</span> We show how minimization of a different loss function is basic to a particular method to cluster data into <span class="math notranslate nohighlight">\(k\)</span> groups called <em>k-means clustering</em>.    We begin by describing three recursive methods for locating a minimum point of a loss function, the first of which is <em>gradient descent</em>.</p>
</section>
<section id="optimization-by-gradient-descent">
<span id="index-1"></span><h2><span class="section-number">10.3.2. </span>Optimization by Gradient Descent<a class="headerlink" href="#optimization-by-gradient-descent" title="Link to this heading">#</a></h2>
<p>Recall that given a function <span class="math notranslate nohighlight">\(J(w_1,w_2,\dots,w_s)\)</span>, the gradient of <span class="math notranslate nohighlight">\(J\)</span> (denoted <span class="math notranslate nohighlight">\(\nabla J\)</span>) is the vector</p>
<div class="math notranslate nohighlight">
\[
\nabla J(w_1,w_2,\dots,w_s) = \left\langle\frac{\partial J}{\partial w_1},\frac{\partial J}{\partial w_2},\dots,\frac{\partial J}{\partial w_s}\right\rangle.
\]</div>
<p>If <span class="math notranslate nohighlight">\(J(w_1,.w_2,\dots,w_s)\)</span> has a maximum or minimum at a differentiable interior point <span class="math notranslate nohighlight">\(\mathbf{w}^*=(w_1^*,w_2^*,\dots,w_s^*)\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\nabla J (\mathbf{w}^*)=\mathbf{0}.\]</div>
<p>That is, all the partials of <span class="math notranslate nohighlight">\(J\)</span> must equal zero at <span class="math notranslate nohighlight">\(\mathbf{w}^*.\)</span> Hence, to find a max or min point <span class="math notranslate nohighlight">\(\mathbf{w^*}\)</span> of <span class="math notranslate nohighlight">\(J\)</span>, we look for a solution to  <span class="math notranslate nohighlight">\(\nabla J=\mathbf{0}\)</span>.</p>
<p>Let us consider the one-dimensional case to find a minimum point <span class="math notranslate nohighlight">\(w^*\)</span> of a function of one variable <span class="math notranslate nohighlight">\(J=J(w)\)</span>. Recall Newton’s method, which says that to find a root <span class="math notranslate nohighlight">\(w^*\)</span> of <span class="math notranslate nohighlight">\(J(w)\)</span>, we can use the iterative algorithm</p>
<div class="math notranslate nohighlight">
\[
w_{n+1}=w_n-\frac{J(w_n)}{J'(w_n)},
\]</div>
<p>where the sequence <span class="math notranslate nohighlight">\(w_n\rightarrow w^*\)</span>.</p>
<p>If we wish to find a root <span class="math notranslate nohighlight">\(w^*\)</span> of <span class="math notranslate nohighlight">\(J'(w)\)</span> rather than of <span class="math notranslate nohighlight">\(J(w)\)</span>, Newton’s method becomes</p>
<div class="math notranslate nohighlight">
\[
w_{n+1}=w_n-\frac{J'(w_n)}{J''(w_n)},
\]</div>
<p>where the sequence <span class="math notranslate nohighlight">\(w_n\rightarrow w^*\)</span>. If <span class="math notranslate nohighlight">\(\sigma\)</span> is a positive constant near <span class="math notranslate nohighlight">\(\frac{1}{J''(w^*)}&gt;0\)</span>, then
we can modify the last equation as</p>
<div class="math notranslate nohighlight">
\[
w_{n+1}=w_n - \sigma J'(w_n).
\]</div>
<p>Generalizing  to functions of more than one variable, we obtain the <em>gradient descent</em> recursive method to find a minimum point for <span class="math notranslate nohighlight">\(J\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{w}_{n+1}=  \mathbf{w}_n - \sigma \nabla J(\mathbf{w}_n),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a positive constant called the <em>learning rate.</em></p>
</section>
<section id="example-3-1">
<h2><span class="section-number">10.3.3. </span>Example 3.1.<a class="headerlink" href="#example-3-1" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(J(w_1,w_2)=w_1^2+2w_1+w_2^2+4w_2,\)</span> <span class="math notranslate nohighlight">\(\mathbf{w}_0=(0,0)\)</span> and <span class="math notranslate nohighlight">\(\sigma=0.1\)</span>.  Find <span class="math notranslate nohighlight">\(\mathbf{w}_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{w}_2.\)</span> To which point do we expect the gradient descent sequence <span class="math notranslate nohighlight">\(\mathbf{w}_n\)</span> to converge?</p>
<p><strong>Solution:</strong><br />
We have <span class="math notranslate nohighlight">\(\nabla J=(2w_1+2,2w_2+4).\)</span></p>
<div class="math notranslate nohighlight">
\[
\mathbf{w}_1  \mathbf{w}_0-\sigma\nabla J (\mathbf{w}_0) =(0,0)-0.1(2,4)=(-0.2,-0.4)
\]</div>
<div class="math notranslate nohighlight">
\[
\mathbf{w}_2=\mathbf{w}_1-\sigma\nabla J(\mathbf{w}_1) =(-0.2,-0.4)-0.1(1.6,3.2)=(-0.36,-0.72).
\]</div>
<p>Note that <span class="math notranslate nohighlight">\(J=(w_1+1)^2+(w_2+2)^2-5\)</span> has a minimum point at <span class="math notranslate nohighlight">\(\mathbf{w}^*=(-1,-2)\)</span>. That point is where we would expect the gradient descent sequence <span class="math notranslate nohighlight">\(\mathbf{w}_n\)</span> to converge.</p>
<p id="index-2">We continue with minimizing a loss function <span class="math notranslate nohighlight">\(J(w_1,w_2,\dots,w_s)\)</span> by introducing two additional methods of optimization.</p>
<section id="coordinate-descent">
<h3>Coordinate Descent<a class="headerlink" href="#coordinate-descent" title="Link to this heading">#</a></h3>
<p>In contrast to gradient descent, <em>coordinate descent</em> seeks to minimize the value of <span class="math notranslate nohighlight">\(J\)</span> one coordinate at a time. For example, to minimize <span class="math notranslate nohighlight">\(J\)</span>, we begin with an initial point <span class="math notranslate nohighlight">\(\mathbf{w}_0\)</span> which specifies the values for <span class="math notranslate nohighlight">\((w_1,w_2,\dots,w_s)\)</span> and look for the minimum value of <span class="math notranslate nohighlight">\(J\)</span> obtainable by varying <span class="math notranslate nohighlight">\(w_1\)</span> and keep the remaining variables <span class="math notranslate nohighlight">\(w_2,\dots,w_s\)</span> fixed. After finding the value of <span class="math notranslate nohighlight">\(w_1\)</span> that gives a minimum  <span class="math notranslate nohighlight">\(J\)</span>, we continue by varying the value of <span class="math notranslate nohighlight">\(w_2\)</span> to further minimize <span class="math notranslate nohighlight">\(J\)</span> while keeping the newly obtained <span class="math notranslate nohighlight">\(w_1\)</span> and the other variables fixed.  We continue this process until the value of <span class="math notranslate nohighlight">\(J\)</span> remains unchanged (or only changes at each step by an amount less than a specified threshold) when cycling through all <span class="math notranslate nohighlight">\(n\)</span> variables.</p>
</section>
<section id="optimization-by-coordinate-and-block-descent">
<span id="index-3"></span><h3>Optimization by Coordinate and Block Descent<a class="headerlink" href="#optimization-by-coordinate-and-block-descent" title="Link to this heading">#</a></h3>
<section id="example-3-2">
<h4>Example 3.2.<a class="headerlink" href="#example-3-2" title="Link to this heading">#</a></h4>
<p>Use  coordinate descent to minimize</p>
<div class="math notranslate nohighlight">
\[J(w_1,w_2)=(w_1-1)^2 + (w_2-2)^2,\]</div>
<p>beginning with the initial point <span class="math notranslate nohighlight">\(\mathbf{w}_0= (w_1,w_2)=(0,0)\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>First we fix <span class="math notranslate nohighlight">\(w_2=0\)</span> and minimize <span class="math notranslate nohighlight">\(J=(w_1-1)^2+4.\)</span> The value <span class="math notranslate nohighlight">\(w_1=1\)</span> gives the minimum <span class="math notranslate nohighlight">\(J\)</span>.  Next, we fix <span class="math notranslate nohighlight">\(w_1=1\)</span> and minimize <span class="math notranslate nohighlight">\(J=(w_2-2)^2.\)</span> The value <span class="math notranslate nohighlight">\(w_2=2\)</span> gives the minimum.  The result <span class="math notranslate nohighlight">\(J=0\)</span> is unchanged if we cycle through <span class="math notranslate nohighlight">\(w_1\)</span> and then <span class="math notranslate nohighlight">\(w_2\)</span>. Hence, in this case, coordinate descent correctly gives <span class="math notranslate nohighlight">\(\mathbf{w}=(1,2)\)</span> as the point that minimizes <span class="math notranslate nohighlight">\(J\)</span>.</p>
</section>
</section>
<section id="block-descent">
<h3>Block Descent<a class="headerlink" href="#block-descent" title="Link to this heading">#</a></h3>
<p>Block descent is similar to coordinate descent except we minimize <span class="math notranslate nohighlight">\(J\)</span> over blocks of variables rather than a single variable. The <span class="math notranslate nohighlight">\(k\)</span>-means clustering method is based on block descent, as we now explain.</p>
</section>
<section id="k-means-clustering-optimization-problem">
<h3>K-MEANS CLUSTERING OPTIMIZATION PROBLEM<a class="headerlink" href="#k-means-clustering-optimization-problem" title="Link to this heading">#</a></h3>
<p>Find <span class="math notranslate nohighlight">\(\mathbf{z}_1,\dots,\mathbf{z}_k\)</span> and <span class="math notranslate nohighlight">\(y_{i,j}\)</span> that</p>
<div class="math notranslate nohighlight">
\[
     minimize \,  J(\mathbf{z}_1,\dots,\mathbf{z}_k; y_{i,j}) = \sum_{j=1}^k\sum_{i=1}^m y_{ij}\|\mathbf{x}_i-\mathbf{z}_j\|^2,
\]</div>
<p>subject to the constraints  <span class="math notranslate nohighlight">\(y_{i,j}\in\{0,1\}\)</span> for all <span class="math notranslate nohighlight">\(i,j\)</span>,  and
<span class="math notranslate nohighlight">\(\sum_{j=1}^k y_{i,j}=1\)</span> (each data point is assigned to exactly one centroid).</p>
<p>In this case, the loss function <span class="math notranslate nohighlight">\(J\)</span> is the total squared distance between data points and their assigned centers (prototypes).</p>
<p>Two blocks of variables are used in block descent minimization of <span class="math notranslate nohighlight">\(J\)</span>:</p>
<p>the <em>prototype variables</em>  <span class="math notranslate nohighlight">\(\mathbf{z}_1,\dots,\mathbf{z}_k\)</span>  and</p>
<p>the <em>assignment variables</em> <span class="math notranslate nohighlight">\(y_{i,j}\)</span> <span class="math notranslate nohighlight">\((1\le i \le m\)</span> and <span class="math notranslate nohighlight">\(1\le j \le k\)</span>).</p>
<p>Block descent in this case results in a two-step iterative algorithm:</p>
<p>step 1) Fix the prototype variables, and then specify <span class="math notranslate nohighlight">\(y_{ij}\)</span> so that each data point <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span> is assigned to the closest center <span class="math notranslate nohighlight">\(\mathbf{z}_j\)</span>.</p>
<p>step 2) Fix each assignment <span class="math notranslate nohighlight">\(y_{i,j}\)</span> and choose the cluster center (prototype) to be the mean of the points in its cluster.</p>
<p>We continue this process until the value of <span class="math notranslate nohighlight">\(J\)</span> either is unchanged or only changes by some amount less than a specified threshold after completing the two steps in the algorithm.</p>
</section>
<section id="example-3-3">
<h3>Example 3.3.<a class="headerlink" href="#example-3-3" title="Link to this heading">#</a></h3>
<p>Use <span class="math notranslate nohighlight">\(k\)</span>-means clustering with <span class="math notranslate nohighlight">\(k=2\)</span> to divide the points <span class="math notranslate nohighlight">\(\mathbf{x}_1=(0,0)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}_2=(10,0)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}_3=(10,1)\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{x}_4=(0,1)\)</span> into two clusters. Begin with the prototypes <span class="math notranslate nohighlight">\(z_1=(0,0)\)</span> and <span class="math notranslate nohighlight">\(z_2=(10,0)\)</span>.</p>
<p><strong>Solution:</strong></p>
<p>i)  Fix the prototypes <span class="math notranslate nohighlight">\(z_1=(0,0)\)</span> and <span class="math notranslate nohighlight">\(z_2=(10,0)\)</span>; we have <span class="math notranslate nohighlight">\(y_{1,1}=1\)</span>, <span class="math notranslate nohighlight">\(y_{1,2}=0\)</span>, <span class="math notranslate nohighlight">\(y_{2,1}=0\)</span>, <span class="math notranslate nohighlight">\(y_{2,2}=1\)</span>, <span class="math notranslate nohighlight">\(y_{3,1}=0\)</span>, <span class="math notranslate nohighlight">\(y_{3,2}=1\)</span>, <span class="math notranslate nohighlight">\(y_{4,1}=1\)</span>,  and <span class="math notranslate nohighlight">\(y_{4,2}=0\)</span>;</p>
<p>ii) Fix each assignment <span class="math notranslate nohighlight">\(y_{i,j}\)</span>; then the prototypes are <span class="math notranslate nohighlight">\(\mathbf{z}_1=(0,0.5)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}_2=(10,0.5)\)</span>.</p>
<p>iii)Fixing the prototypes  <span class="math notranslate nohighlight">\(\mathbf{z}_1=(0,.5)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{z}_2=(10,.5)\)</span>, the assignment variables are the same as before: <span class="math notranslate nohighlight">\(y_{1,1}=1\)</span>, <span class="math notranslate nohighlight">\(y_{1,2}=0\)</span>, <span class="math notranslate nohighlight">\(y_{2,1}=0\)</span>, <span class="math notranslate nohighlight">\(y_{2,2}=1\)</span>, <span class="math notranslate nohighlight">\(y_{3,1}=0\)</span>, <span class="math notranslate nohighlight">\(y_{3,2}=1\)</span>, <span class="math notranslate nohighlight">\(y_{4,1}=1\)</span>, and y<span class="math notranslate nohighlight">\(_{4,2}=0\)</span>.</p>
<p>iv) Fixing the assignment variables, the prototype variables are the same as before: <span class="math notranslate nohighlight">\(\mathbf{z}_1=(0,0.5)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}_2=(10,0.5)\)</span>.</p>
<p>Observing that <span class="math notranslate nohighlight">\(y_{1,1}=1\)</span> and <span class="math notranslate nohighlight">\(y_{4,1}=1\)</span>,  the points <span class="math notranslate nohighlight">\(\mathbf{x_1}=(0,0)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_4}=(0,1)\)</span> are assigned to cluster 1. Furthermore, since <span class="math notranslate nohighlight">\(y_{2,2}=1\)</span> and <span class="math notranslate nohighlight">\(y_{3,2}=1\)</span>, the points <span class="math notranslate nohighlight">\(\mathbf{x_2}=(10,0)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_3}=(10,1)\)</span> are assigned to cluster 2.</p>
</section>
<section id="proof-of-block-descents-stepwise-minimization-of-j">
<h3>Proof of Block Descent’s Stepwise Minimization of <span class="math notranslate nohighlight">\(J\)</span><a class="headerlink" href="#proof-of-block-descents-stepwise-minimization-of-j" title="Link to this heading">#</a></h3>
<p>Since <span class="math notranslate nohighlight">\(J\)</span> is the sum of squared distances between data points and their cluster centers, it is clear that if we fix the prototypes, <span class="math notranslate nohighlight">\(J\)</span> will be minimized by assigning each data point to the nearest prototype. We now show that for any fixed choice of assignment variables, the loss function <span class="math notranslate nohighlight">\(J\)</span> is minimized when each prototype is the mean of the points in its cluster.</p>
<p>Let
<span class="math notranslate nohighlight">\(J=\sum_{j=1}^k O_j\)</span> where <span class="math notranslate nohighlight">\(O_j=\sum_{i-1}^my_{i,j}\|\mathbf{x}_{i}-\mathbf{z}_j\|^2.\)</span> Note that <span class="math notranslate nohighlight">\(O_j\)</span> can be computed using only the points in cluster <span class="math notranslate nohighlight">\(j\)</span>,  since otherwise <span class="math notranslate nohighlight">\(y_{i,j}=0\)</span>. Denote these points <span class="math notranslate nohighlight">\(\mathbf{u}_1,\dots,\mathbf{u}_{n_j}.\)</span> Then for each <span class="math notranslate nohighlight">\(j\)</span>, we minimize</p>
<div class="math notranslate nohighlight">
\[
O_j(z_{j,1},\dots,z_{j,m}) = (u_{1,1}-z_{j,1})^2+\dots+(u_{1,m}-z_{j,m})^2+
(u_{2,1}-z_{j,1})^2+\dots+(u_{2,m}-z_{j,m})^2+
\dots+
(u_{n_j,1}-z_{j,1})^2+\dots+(u_{n_j,m}-z_{j,m})^2.
\]</div>
<p>The condition <span class="math notranslate nohighlight">\(\nabla O_j(z_{j,1},\dots,z_{j,m})=(0,\dots,0)\)</span> will be satisfied if we choose <span class="math notranslate nohighlight">\(\mathbf{z}_j\)</span> to be the average of  the points <span class="math notranslate nohighlight">\(\mathbf{u}_1,\dots,\mathbf{u}_{n_j}.\)</span>  For example,</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial O_j}{\partial z_{j,1}}=-2(u_{1,1}-z_{j,1})-2(u_{2,1}-z_{j,1})-\dots-2(u_{n_j,1}-z_{j,1})=0\qquad\Rightarrow \sum_{t=1}^{n_j}u_{t,1}-n_jz_{j,1}=0\qquad\Rightarrow\qquad z_{j,1}=\frac{1}{n_j}\sum_{t=1}^{n_j}u_{t,1},
\]</div>
<p>so the first coordinate of <span class="math notranslate nohighlight">\(z_j\)</span> (namely, <span class="math notranslate nohighlight">\(z_{j,1}\)</span>) is the average of the first coordinates of the points in its cluster. The same argument  shows that each coordinate of <span class="math notranslate nohighlight">\(\mathbf{z}_j\)</span> is the mean of the  coordinates of points in its cluster.</p>
</section>
</section>
<section id="exercises">
<h2><span class="section-number">10.3.4. </span>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<div class="admonition-exercises admonition">
<p class="admonition-title">Exercises</p>
<ol class="arabic simple">
<li><p>Compute  <span class="math notranslate nohighlight">\(\mathbf{w}_1\)</span>,  <span class="math notranslate nohighlight">\(\mathbf{w}_2\)</span>, and  <span class="math notranslate nohighlight">\(\mathbf{w}_3\)</span>    in the gradient descent sequence <span class="math notranslate nohighlight">\(\mathbf{w}_n\)</span>  obtained when minimizing <span class="math notranslate nohighlight">\(J(w_1,w_2)=w_1^2+2w_2^2\)</span> with <span class="math notranslate nohighlight">\(\mathbf{w}_0=(-5,-2)\)</span> and learning rate <span class="math notranslate nohighlight">\(\sigma=0.1.\)</span>  To what point will the sequence <span class="math notranslate nohighlight">\(\mathbf{w}_n\)</span> converge?</p></li>
<li><p>Use coordinate descent to minimize <span class="math notranslate nohighlight">\(J(w_1,w_2,w_3)=w_1^2+(w_2-1)^2+(w_3-2)^2\)</span> beginning with the initial point <span class="math notranslate nohighlight">\((w_1,w_2,w_3)=(0,0,0)\)</span>.</p></li>
<li><p>Use <span class="math notranslate nohighlight">\(2\)</span>-means clustering  to divide the points <span class="math notranslate nohighlight">\(\mathbf{x}_1=(-1,-1)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}_2=(-1,0)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}_3=(-1,1)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}_4=(1,-1)\)</span>, <span class="math notranslate nohighlight">\(\mathbf{x}_5=(1,0)\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{x}_6=(1,1)\)</span> into two clusters. Begin with the prototypes <span class="math notranslate nohighlight">\(z_1=(-1,0)\)</span> and <span class="math notranslate nohighlight">\(z_2=(1,0)\)</span>.</p></li>
<li><p>The graph in  the figure below shows the positions of  five data points <span class="math notranslate nohighlight">\(\mathbf{x}_1, \dots,\mathbf{x}_5\)</span>, two cluster centers <span class="math notranslate nohighlight">\(\mathbf{z}_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}_2\)</span>, as well as selected values for the assignment variables <span class="math notranslate nohighlight">\(y_{i,j}\)</span>.  Supply the missing labels for the data points <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_5}\)</span>,  cluster center <span class="math notranslate nohighlight">\(\mathbf{z_2}\)</span>, and  assignment variables <span class="math notranslate nohighlight">\(y_{4,1}\)</span> and <span class="math notranslate nohighlight">\(y_{4,2}\)</span>.</p></li>
</ol>
<a class="reference internal image-reference" href="../../../_images/fig72.png"><img alt="../../../_images/fig72.png" src="../../../_images/fig72.png" style="width: 200px;" /></a>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Advanced/LinearAlgebra/KMeans"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../OLS/jnb1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">10.2. </span>OLS Linear Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="../PCA/jnb3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10.4. </span>Dimension Reduction by Principal Component Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-of-data">10.3.1. Clustering of Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-by-gradient-descent">10.3.2. Optimization by Gradient Descent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-1">10.3.3. Example 3.1.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-descent">Coordinate Descent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-by-coordinate-and-block-descent">Optimization by Coordinate and Block Descent</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-2">Example 3.2.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#block-descent">Block Descent</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering-optimization-problem">K-MEANS CLUSTERING OPTIMIZATION PROBLEM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-3">Example 3.3.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-block-descents-stepwise-minimization-of-j">Proof of Block Descent’s Stepwise Minimization of <span class="math notranslate nohighlight">\(J\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">10.3.4. Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara, Claire Wagner, Peter Jantsch, and Thomas VanDrunen, Editors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
  <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'><img alt='Creative Commons License' width=88 style='border-width:0' src='https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by.png'/></a>
  Except where otherwise noted, this work is licensed under a <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 International License</a>.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>