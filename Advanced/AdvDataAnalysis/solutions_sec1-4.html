
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>14.8. Solutions to Exercises: Sections 1 to 4 &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=07d05eac" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Advanced/AdvDataAnalysis/solutions_sec1-4';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="14.9. Solutions to Exercises: Sections 5 to 7" href="solutions_sec5-7.html" />
    <link rel="prev" title="14.7. Applications" href="sec6_applications.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="An Introduction to Python Jupyter Notebooks for College Math Teachers - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="An Introduction to Python Jupyter Notebooks for College Math Teachers - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Preface.html">1. PREFACE</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../JMM23.html">1.1. JMM 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lab.html">1.2. JNB LAB: Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../labsolutions.html">1.3. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PreCollege.html">2. PRE-COLLEGE - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/PreCollegeIntro.html">2.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Elementary/Arithmetic/elementary.html">2.2. Elementary Blackboard Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/GettingStarted/python.html">2.3. Beginning Python Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/Chicago.html">2.4. Glimpse of Chicago</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/steam.html">2.5. Arts in STEM (STEAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/solutions.html">2.6. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/demo.html">2.7. JNB LAB: After-School Program Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/demosolutions.html">2.8. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Intropy.html">3. PYTHON PROGRAMMING GUIDE - Thomas VanDrunen, Yiheng Liang</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/PythonProgrammingGuideIntro.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Introduction_to_Python.html">3.2. Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Data.html">3.3. Working with Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/solutions.html">3.4. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Plab.html">3.5. JNB Lab: Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Plabsolutions.html">3.6. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Data.html">4. EXPLORATORY DATA ANALYSIS - Jonathan Zhu</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec1_basic_intro.html">4.1. Introduction to Part I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec2_basic_tabular.html">4.2. Data Investigation I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec3_basic_plotting.html">4.3. Plotting and Statistical Testing I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec4_basic_solutions.html">4.4. Solutions to Part I Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec5_advanced_intro.html">4.5. Introduction to Part II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec6_advanced_tabular.html">4.6. Data Investigation II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec7_advanced_plotting.html">4.7. Plotting and Statistical Testing II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec8_advanced_report.html">4.8. Making EDA Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/sec9_advanced_solution.html">4.9. Solutions to Part II Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/lab.html">4.10. JNB Lab: Housing Equity Initiative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/EDA/labsolution.html">4.11. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Prob.html">5. PROBABILITY - Laura Gross, Yiheng Liang</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob1.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob2.html">5.3. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob3.html">5.4. Conditional Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob4.html">5.5. Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob4a.html">5.6. Random Walks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob5.html">5.7. Agent-based Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/prob6.html">5.8. Mathematical Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/solutions.html">5.9. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/lab.html">5.10. JNB Lab: Homicides in Chicago</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/ProbIntro/labsolution.html">5.11. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Stat.html">6. STATISTICAL INFERENCE - Peter Jantsch, Claire Wagner</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/00_Instructor_Notes.html">6.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/01_Foundations.html">6.2. Foundations of Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/02_Inference_Categorical.html">6.3. Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/03_Inference_Numerical.html">6.4. Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/04_Regression.html">6.5. Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/Solutions.html">6.6. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/05_Lab.html">6.7. Lab: The Framingham Heart Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ProbStat/StatInf/05_Lab_Solutions.html">6.8. Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AppliedCalc.html">7. APPLIED CALCULUS FOR DAILY LIFE - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/AppliedCalculusIntro.html">7.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/twocommodity.html">7.2. Linear Systems and the Two-commodity Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/marginal.html">7.3. Marginal and Average Cost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/design.html">7.4. Optimization and Object Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/cobbs.html">7.5. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/rates.html">7.6. Related Rates and Volumes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/football.html">7.7. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/jnb7.html">7.8. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/control.html">7.9. Normal Distribution and Process Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/ols.html">7.10. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/gini.html">7.11. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/income.html">7.12. Integral Test and Income Streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/ode.html">7.13. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/solutions.html">7.14. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/AClab.html">7.15. JNB Lab: Calculus of Entropy in Daily Life and Monte Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/AClabsolutions.html">7.16. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Calc.html">8. CALCULUS - Inne Singgih</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/Intro.html">8.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/2Functions.html">8.2. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/3Limits.html">8.3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/4%20Derivatives.html">8.4. Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/5%20Integrals.html">8.5. Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/6%20ParametricEquations.html">8.6. Parametric Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/7%20Sequences%20and%20Series.html">8.7. Sequences and Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/Solutions.html">8.8. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/clab.html">8.9. JNB LAB: Calculus Animations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/clabsolution.html">8.10. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Linear.html">9. LINEAR ALGEBRA - Soheil Anbouhi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/0.html">9.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/1.html">9.2. Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/2.html">9.3. Matrices and Determinants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/3.html">9.4. Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/4.html">9.5. Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/5.html">9.6. Orthogonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/Solutions.html">9.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/LAlab.html">9.8. JNB Lab: Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/LAlabsolutions.html">9.9. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Aplin.html">10. LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/Introduction.html">10.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/OLS/jnb1.html">10.2. OLS Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/KMeans/jnb2.html">10.3. K-means Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/PCA/jnb3.html">10.4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/SVM/jnb4.html">10.5. Binary Classification of Labeled Data by Support Vector Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/solutions.html">10.6. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/ALlab.html">10.7. JNB LAB: Linear Algebra for Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebra/ALlabsolution.html">10.8. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../DifEq.html">11. DIFFERENTIAL EQUATIONS - Rachel Petrik</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations.html">11.1. Overview of Chapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE2.html">11.2. Introduction to Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE3.html">11.3. First-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE4.html">11.4. Second-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE5.html">11.5. Systems of First-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE6.html">11.6. Laplace Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DESolutions.html">11.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations%20Book%201%20Lab.html">11.8. JNB Lab: Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations%20Book%201%20Lab%20Answer%20Key.html">11.9. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AppliedDifEq.html">12. DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/AppliedDiffEqIntro.html">12.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/covid.html">12.2. Logistic Growth and COVID-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/sir.html">12.3. The Basic SIR Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cholera.html">12.4. Cholera in Haiti</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cws/cws.html">12.5. CWS Model of Alzheimerâ€™s Disease</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/gravity/gravity.html">12.6. Gravity Fed Water Delivery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/erc/erc.html">12.7. Earthquake Resistant Construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/solutions.html">12.8. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/hiv/lab.html">12.9. JNB Lab: HIV-AIDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/labsolutions.html">12.10. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ComplexVar.html">13. COMPLEX VARIABLES IN GROUNDWATER MODELING - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_1.html">13.1. Setting the Scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_2.html">13.2. Complex Analysis Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_3.html">13.3. Idealized Groundwater Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_4.html">13.4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_solutions.html">13.5. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_lab.html">13.6. JNB LAB: Complex Potentials and Contaminant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Complex/complex_variables_lab_solution.html">13.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../AdvData.html">14. ADVANCED DATA ANALYSIS - Jonathan Zhu, Claire Wagner, Ying Li</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sec0_data.html">14.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec1_preprocessing.html">14.2. Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec2_transform_features.html">14.3. About Text Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec3_doc_embedding.html">14.4. Document Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec4_classification_algos.html">14.5. Classification of Texts</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec5_classification_eval.html">14.6. Evaluating Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec6_applications.html">14.7. Applications</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">14.8. Solutions to Exercises: Sections 1 to 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="solutions_sec5-7.html">14.9. Solutions to Exercises: Sections 5 to 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="nlp_lab.html">14.10. JNB Lab: United States Grant Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="nlp_lab_solutions.html">14.11. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ComplexSystems.html">15. COMPLEX SYSTEMS - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_1.html">15.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_2.html">15.2. Fundamental Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_3.html">15.3. Mathematical Concepts from Equilibrium Statistical Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_4.html">15.4. Societal Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_solutions.html">15.5. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_lab.html">15.6. JNB LAB: Complex Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComplexSystems/complex_systems_labsolution.html">15.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/timothyprojectGiG/JB_Math_Textbook/main?urlpath=tree/src/Advanced/AdvDataAnalysis/solutions_sec1-4.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook/issues/new?title=Issue%20on%20page%20%2FAdvanced/AdvDataAnalysis/solutions_sec1-4.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Advanced/AdvDataAnalysis/solutions_sec1-4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Solutions to Exercises: Sections 1 to 4</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">14.8.1. Preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-text-data">14.8.2. About Text Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#document-embedding">14.8.3. Document Embedding</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;punkt&#39;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># download punkt (if not already downloaded)</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span><span class="p">,</span> <span class="n">sent_tokenize</span>
<span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">tensorflow_hub</span> <span class="k">as</span> <span class="nn">hub</span>

<span class="c1"># change this to your own data directory</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;data/&quot;</span>

<span class="c1"># read and preprocess data</span>
<span class="n">text_file_name</span> <span class="o">=</span> <span class="s2">&quot;osdg-community-data-v2023-01-01.csv&quot;</span>
<span class="n">text_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="n">text_file_name</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">text_df</span><span class="p">[</span><span class="n">col_names</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_df</span><span class="p">[</span><span class="n">text_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)))</span>
<span class="n">text_df</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;sdg&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;labels_negative&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;labels_positive&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;agreement&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">},</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">text_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">text_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="solutions-to-exercises-sections-1-to-4">
<h1><span class="section-number">14.8. </span>Solutions to Exercises: Sections 1 to 4<a class="headerlink" href="#solutions-to-exercises-sections-1-to-4" title="Link to this heading">#</a></h1>
<section id="preprocessing">
<h2><span class="section-number">14.8.1. </span>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h2>
<p><strong>Exercise 1</strong></p>
<p>Answers may vary.</p>
<p><strong>Exercise 2</strong></p>
<p>Answers may vary.</p>
<p><strong>Exercise 3</strong></p>
<p>The following code removes any rows that contain only N/A values. In this case, there are no such rows to remove.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrows_old</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">text_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of rows removed:&quot;</span><span class="p">,</span> <span class="n">nrows_old</span> <span class="o">-</span> <span class="n">text_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of rows removed: 0
</pre></div>
</div>
</div>
</div>
<p>The next line of code checks for the existence of any remaining N/A values. It turns out that there are none.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text_df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>doi                False
text_id            False
text               False
sdg                False
labels_negative    False
labels_positive    False
agreement          False
dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Whether or not entries with N/A values should be removed depends on the dataset and the nature of the problem. Sometimes, entries with N/A values should be dropped, while at other times, they should be kept unchanged, or replaced with interpolated or placeholder values. Consult <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html">the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> documentation</a> for more information about how to deal with missing values in dataframes.</p>
<p><strong>Exercise 4</strong></p>
<p>After filtering the dataset, we inspect it using the <code class="docutils literal notranslate"><span class="pre">info()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filter the dataset</span>
<span class="n">text_df</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;agreement &gt; 0.5 and (labels_positive - labels_negative) &gt; 2&quot;</span><span class="p">)</span>
<span class="n">text_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># inspect it</span>
<span class="n">text_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 24669 entries, 0 to 24668
Data columns (total 7 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   doi              24669 non-null  object 
 1   text_id          24669 non-null  object 
 2   text             24669 non-null  object 
 3   sdg              24669 non-null  int64  
 4   labels_negative  24669 non-null  int64  
 5   labels_positive  24669 non-null  int64  
 6   agreement        24669 non-null  float64
dtypes: float64(1), int64(3), object(3)
memory usage: 1.3+ MB
</pre></div>
</div>
</div>
</div>
<p>We have 40062 entries with 7 features (see <a class="reference internal" href="sec0_data.html"><span class="std std-doc">section 1</span></a> for details). The data types range from <code class="docutils literal notranslate"><span class="pre">object</span></code> (likely denoting strings) to <code class="docutils literal notranslate"><span class="pre">int64</span></code> (integers) to <code class="docutils literal notranslate"><span class="pre">float64</span></code> (floating-point numbers). This is a reasonable amount of data to work with.</p>
<p><strong>Exercise 5</strong></p>
<p>The Porter and Snowball stemmers are largely comparable, while the Lancaster stemmer is the most aggressive. As a result, the Lancaster stemmer is likely to have the most trouble on a larger set of tokens.</p>
<p><strong>Exercise 6</strong></p>
<p>Answers may vary. Some possible observations include the fact that stemmers tend to remove affixes (such as <code class="docutils literal notranslate"><span class="pre">-ing</span></code>, <code class="docutils literal notranslate"><span class="pre">-ed</span></code>, and <code class="docutils literal notranslate"><span class="pre">-s</span></code> in English) and the fact that irregular words are particularly likely to give the stemmers trouble.</p>
<p><strong>Exercise 7</strong></p>
<p>Answers may vary.</p>
<p><strong>Exercise 8</strong></p>
<p>Answers may vary. Some possible entity labels include <code class="docutils literal notranslate"><span class="pre">GPE</span></code> (â€œnationalities or religious or political groupsâ€), <code class="docutils literal notranslate"><span class="pre">TIME</span></code> (â€œtimes smaller than a dayâ€), <code class="docutils literal notranslate"><span class="pre">QUANTITY</span></code> (â€œmeasurements, as of weight or distanceâ€), and <code class="docutils literal notranslate"><span class="pre">WORK_OF_ART</span></code> (â€œtitles of books, songs, etc.â€).</p>
<p><strong>Exercise 9</strong></p>
<p>Sample code solution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load trained pipeline</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_sm&#39;</span><span class="p">)</span>

<span class="c1"># perform NER on random sample in both original and lower case</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">text_df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ORIGINAL CASE&#39;</span><span class="p">)</span>
<span class="n">spacy</span><span class="o">.</span><span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ent&#39;</span><span class="p">,</span> <span class="n">jupyter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">LOWERCASE&#39;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">spacy</span><span class="o">.</span><span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ent&#39;</span><span class="p">,</span> <span class="n">jupyter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ORIGINAL CASE
</pre></div>
</div>
<div class="output text_html"><span class="tex2jax_ignore"><div class="entities" style="line-height: 2.5; direction: ltr">The legal protection of religious freedom in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Australia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 has been subject to significant debate over 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    recent years
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
. In 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the last four years
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
 this question has formed the basis of inquiries by 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Australian Law Reform Commission
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, a 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Parliamentary Committee
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, as well as a specially formed 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Expert Panel
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
, chaired by 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Philip Ruddock
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
. In this article we outline the international and comparative approach taken to protect freedom of religion, and contrast this to the position in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Australia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
. We find that 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    Australian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 law does not adequately protect this foundational human right. We then assess the recommendations proposed by 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Ruddock Review
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
. We argue that although 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Expert Panel
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 recognised the extent of the problem, it did not propose a comprehensive or holistic solution that will resolve existing inadequacies. To protect religious freedom, and indeed human rights more generally, 
<mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the Commonwealth Parliament
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span>
</mark>
 should enact a national human rights act</div></span></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LOWERCASE
</pre></div>
</div>
<div class="output text_html"><span class="tex2jax_ignore"><div class="entities" style="line-height: 2.5; direction: ltr">the legal protection of religious freedom in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    australia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
 has been subject to significant debate over 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    recent years
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
. in 
<mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    the last four years
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span>
</mark>
 this question has formed the basis of inquiries by the 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    australian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 law reform commission, a parliamentary committee, as well as a specially formed expert panel, chaired by philip ruddock. in this article we outline the international and comparative approach taken to protect freedom of religion, and contrast this to the position in 
<mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    australia
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span>
</mark>
. we find that 
<mark class="entity" style="background: #c887fb; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;">
    australian
    <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">NORP</span>
</mark>
 law does not adequately protect this foundational human right. we then assess the recommendations proposed by the ruddock review. we argue that although the expert panel recognised the extent of the problem, it did not propose a comprehensive or holistic solution that will resolve existing inadequacies. to protect religious freedom, and indeed human rights more generally, the commonwealth parliament should enact a national human rights act</div></span></div></div>
</div>
<p>Answers may vary depending on the samples chosen. This sample demonstrates that the model sometimes confuses organizations with people. Additionally, it shows that the model often fails to recognize organization names (especially abbreviated ones) when they are converted to lowercase.</p>
<p><strong>Exercise 10</strong></p>
<p>Answers may vary.</p>
</section>
<section id="about-text-data">
<h2><span class="section-number">14.8.2. </span>About Text Data<a class="headerlink" href="#about-text-data" title="Link to this heading">#</a></h2>
<p><strong>Exercise 1</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get document-term matrix</span>
<span class="n">docs</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">text</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">cv_fit</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>

<span class="c1"># get feature names and total counts</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">total_counts</span> <span class="o">=</span> <span class="n">cv_fit</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># get the index of the most frequent word</span>
<span class="n">most_freq_feature</span> <span class="o">=</span> <span class="n">total_counts</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>

<span class="c1"># get the most frequent word itself</span>
<span class="n">most_freq_token</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">most_freq_feature</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Most frequent word: &#39;</span><span class="si">{</span><span class="n">most_freq_token</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Most frequent word: &#39;the&#39;
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 2</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get document-term matrix with stop words removed</span>
<span class="n">cv2</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span> <span class="c1"># exclude English stop words</span>
<span class="n">cv2_fit</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">text_df</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="n">original_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)</span> <span class="c1"># length of the original vocabulary (with stop words)</span>
<span class="n">new_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">)</span> <span class="c1"># length of the new vocabulary (without stop words)</span>
<span class="n">stopwords</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">get_stop_words</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Length of the original vocabulary (with stop words):&#39;</span><span class="p">,</span> <span class="n">original_len</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Length of the new vocabulary (without stop words):&#39;</span><span class="p">,</span> <span class="n">new_len</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stop words:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stopwords</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Difference between original and new vocabularies:&#39;</span><span class="p">,</span> <span class="n">original_len</span> <span class="o">-</span> <span class="n">new_len</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length of the original vocabulary (with stop words): 45738
Length of the new vocabulary (without stop words): 45440
Number of stop words: 318
Difference between original and new vocabularies: 298
</pre></div>
</div>
</div>
</div>
<p>The difference between the original and new vocabularies is less than the number of stop words. This is because not all of the stop words actually occur in the original vocabulary. The following code lists the stop words that are missing from the original vocabulary. Note how the difference between the original and new vocabulary lengths (298) added to the number of missing stopwords (20) is equal to the total number of stop words (318).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_stopwords</span> <span class="o">=</span> <span class="n">stopwords</span> <span class="o">-</span> <span class="n">cv</span><span class="o">.</span><span class="n">vocabulary_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_stopwords</span><span class="p">)</span><span class="si">}</span><span class="s1"> missing stopwords:&#39;</span><span class="p">,</span> <span class="n">missing_stopwords</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20 missing stopwords: {&#39;whereafter&#39;, &#39;whence&#39;, &#39;noone&#39;, &#39;thereupon&#39;, &#39;i&#39;, &#39;thence&#39;, &#39;a&#39;, &#39;latterly&#39;, &#39;yours&#39;, &#39;whereupon&#39;, &#39;couldnt&#39;, &#39;whoever&#39;, &#39;anyhow&#39;, &#39;hasnt&#39;, &#39;whither&#39;, &#39;hers&#39;, &#39;amoungst&#39;, &#39;hereupon&#39;, &#39;yourselves&#39;, &#39;beforehand&#39;}
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 3</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get feature names and total counts</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">total_counts</span> <span class="o">=</span> <span class="n">cv2_fit</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># get the index of the most frequent word</span>
<span class="n">most_freq_feature</span> <span class="o">=</span> <span class="n">total_counts</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>

<span class="c1"># get the most frequent word itself</span>
<span class="n">most_freq_token</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">most_freq_feature</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Most frequent word: &#39;</span><span class="si">{</span><span class="n">most_freq_token</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Most frequent word: &#39;countries&#39;
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 4</strong></p>
<p>First, we fit the one-hot encoder to the sample text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_text</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">12737</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">sample_text</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ohe_reshape</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ohe</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># encode unknown tokens as vectors of all zeros</span>
<span class="n">ohe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ohe_reshape</span><span class="p">(</span><span class="n">tokens</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we transform each token only once by using a set to remove duplicates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">token_set</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tokens</span><span class="p">))</span>
<span class="n">encodings</span> <span class="o">=</span> <span class="n">ohe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">ohe_reshape</span><span class="p">(</span><span class="n">token_set</span><span class="p">))</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span> <span class="c1"># encode the tokens</span>
</pre></div>
</div>
</div>
</div>
<p>There are multiple ways to check that the resulting encodings are unique, but one simple way is to use the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library. The following code transforms the encodings into a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframe and then verifies that there are no duplicates. This confirms that each learned token has a unique encoding.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encodings</span><span class="p">)</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 5</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SDG:&#39;</span><span class="p">,</span> <span class="n">text_df</span><span class="o">.</span><span class="n">sdg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">118</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Text:&#39;</span><span class="p">,</span> <span class="n">text_df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">118</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SDG: 5
Text: &quot;Female economic activities were critically examined and new light was shed on existing conceptions of traditional housework. Oxford University Press, 2007). An edited version of Ihe chapter is available al www.rci.rutgers.edu/~cwgl/globalcenler/charlotte/UN-Handbook.pdf. Targets were also set for the improvement of women&#39;s access to economic, social and cultural rights, including improvements in health, reproductive services and sanitation. The women in development approach is embodied in article 14 of the Convention, which focuses on rural women and calls on States to ensure that women &quot;&quot;participate in and benefit from rural development&quot;&quot; and also that they &quot;&quot;participate in the elaboration and implementation of development planning at all levels&quot;&quot;.15 Participation is an important component of the right to development, as discussed below.&quot;
</pre></div>
</div>
</div>
</div>
<p>The most frequent words are â€œwomenâ€ and â€œdevelopmentâ€, which occur 4 times each. This, together with the label of SDG 5 (gender equality), suggests that this document is about equality for women.</p>
<p><strong>Exercise 6</strong></p>
<p>Each token in a given document, except for the first and last, is grouped into two different bigrams (one with the previous token, and another with the next token). In this case, the large number of distinct bigrams in the entire corpus likely leads to a bigram vocabulary that is larger than the corresponding unigram vocabulary. However, many of the unigrams may occur more often than many of the bigrams do, making the total count of bigrams smaller than the total count of unigrams.</p>
<p><strong>Exercise 7</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">)</span> 
<span class="n">count_vector</span> <span class="o">=</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total count of trigrams (without stop words):&#39;</span><span class="p">,</span> <span class="n">count_vector</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of unique trigrams (without stop words):&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">count_vectorizer</span><span class="o">.</span><span class="n">vocabulary_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total count of trigrams (without stop words): 1301713
Number of unique trigrams (without stop words): 1214215
</pre></div>
</div>
</div>
</div>
<p>The total count of trigrams is smaller than the total count of bigrams, but the number of unique trigrams is larger than the total number of unique bigrams. The explanation for this is similar to the reasoning offered in the solution to the previous exercise, but substituting bigrams for unigrams and trigrams for bigrams.</p>
<p><strong>Exercise 8</strong></p>
<p>Answers may vary depending on the sentences chosen.</p>
<p><strong>Exercise 9</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="mi">398</span>
<span class="n">fp</span> <span class="o">=</span> <span class="mi">153</span>
<span class="n">fn</span> <span class="o">=</span> <span class="mi">83</span>

<span class="n">precision</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Precision = </span><span class="si">{</span><span class="n">precision</span><span class="si">}</span><span class="s1">, recall = </span><span class="si">{</span><span class="n">recall</span><span class="si">}</span><span class="s1">, f1 = </span><span class="si">{</span><span class="n">f1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision = 0.7223230490018149, recall = 0.8274428274428275, f1 = 0.7713178294573643
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 10</strong></p>
<p>Answers may vary depending on the parameters chosen. Here is a sample answer using the parameters <code class="docutils literal notranslate"><span class="pre">ngram_range</span> <span class="pre">=</span> <span class="pre">(2,2)</span></code> (for bigrams), <code class="docutils literal notranslate"><span class="pre">stop_words</span> <span class="pre">=</span> <span class="pre">'english'</span></code>, and <code class="docutils literal notranslate"><span class="pre">min_df</span> <span class="pre">=</span> <span class="pre">3</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">text</span>
<span class="n">count_vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">count_vector</span> <span class="o">=</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">term_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(),</span> <span class="s2">&quot;freq&quot;</span> <span class="p">:</span> <span class="n">count_vector</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)})</span>

<span class="c1"># find the frequencies of the 5 most common bigrams</span>
<span class="n">term_freq</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27774</th>
      <td>human rights</td>
      <td>1981</td>
    </tr>
    <tr>
      <th>10071</th>
      <td>climate change</td>
      <td>1301</td>
    </tr>
    <tr>
      <th>20488</th>
      <td>et al</td>
      <td>1167</td>
    </tr>
    <tr>
      <th>40775</th>
      <td>oecd countries</td>
      <td>898</td>
    </tr>
    <tr>
      <th>26527</th>
      <td>health care</td>
      <td>881</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">text</span>
<span class="n">count_vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">stop_words</span><span class="o">=</span><span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">count_vector</span> <span class="o">=</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">count_vector_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">count_vector</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">count_vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">())</span>

<span class="c1"># find the frequencies of the 5 most common bigrams</span>
<span class="n">term_freq</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 11</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analyze_frequency</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># create term-document matrix</span>
    <span class="n">count_vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">stop_words</span><span class="o">=</span><span class="n">stop_words</span><span class="p">)</span>
    <span class="n">count_vector</span> <span class="o">=</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
    
    <span class="c1"># calculate frequencies of 50 most frequent terms</span>
    <span class="n">freq_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="n">count_vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(),</span> <span class="s2">&quot;freq&quot;</span> <span class="p">:</span> <span class="n">count_vector</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)}</span>
    <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># calculate cumulative word counts</span>
    <span class="n">csum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">freq_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># create plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">csum</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;cumulative word count&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;rank&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cumulative Word Count (Most Frequent to 50th Most Frequent)&#39;</span><span class="p">)</span>
    
    <span class="c1"># calculate comparison</span>
    <span class="n">comp</span> <span class="o">=</span> <span class="n">csum</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">freq_df</span><span class="o">.</span><span class="n">freq</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">freq_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">],</span> <span class="n">ax</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">comp</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise 12</strong></p>
<p>First, we obtain our corpus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdg8</span> <span class="o">=</span> <span class="n">text_df</span><span class="p">[</span><span class="n">text_df</span><span class="o">.</span><span class="n">sdg</span> <span class="o">==</span> <span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<p>Then we run the function from the previous exercise on that corpus and examine the results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">top_50_words</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span> <span class="o">=</span> <span class="n">analyze_frequency</span><span class="p">(</span><span class="n">sdg8</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Level of cumulation percentage:&#39;</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Top 50 words:&#39;</span><span class="p">)</span>
<span class="n">top_50_words</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Level of cumulation percentage: 38.58%

Top 50 words:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6933</th>
      <td>the</td>
      <td>5400</td>
    </tr>
    <tr>
      <th>4806</th>
      <td>of</td>
      <td>3294</td>
    </tr>
    <tr>
      <th>636</th>
      <td>and</td>
      <td>3261</td>
    </tr>
    <tr>
      <th>3578</th>
      <td>in</td>
      <td>2777</td>
    </tr>
    <tr>
      <th>7000</th>
      <td>to</td>
      <td>2618</td>
    </tr>
    <tr>
      <th>3018</th>
      <td>for</td>
      <td>1212</td>
    </tr>
    <tr>
      <th>3842</th>
      <td>is</td>
      <td>1005</td>
    </tr>
    <tr>
      <th>6932</th>
      <td>that</td>
      <td>745</td>
    </tr>
    <tr>
      <th>712</th>
      <td>are</td>
      <td>734</td>
    </tr>
    <tr>
      <th>4843</th>
      <td>on</td>
      <td>694</td>
    </tr>
    <tr>
      <th>747</th>
      <td>as</td>
      <td>683</td>
    </tr>
    <tr>
      <th>7546</th>
      <td>with</td>
      <td>601</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>employment</td>
      <td>566</td>
    </tr>
    <tr>
      <th>927</th>
      <td>be</td>
      <td>550</td>
    </tr>
    <tr>
      <th>1137</th>
      <td>by</td>
      <td>539</td>
    </tr>
    <tr>
      <th>3994</th>
      <td>labour</td>
      <td>530</td>
    </tr>
    <tr>
      <th>6958</th>
      <td>this</td>
      <td>485</td>
    </tr>
    <tr>
      <th>7565</th>
      <td>workers</td>
      <td>430</td>
    </tr>
    <tr>
      <th>4888</th>
      <td>or</td>
      <td>386</td>
    </tr>
    <tr>
      <th>7560</th>
      <td>work</td>
      <td>365</td>
    </tr>
    <tr>
      <th>3326</th>
      <td>have</td>
      <td>360</td>
    </tr>
    <tr>
      <th>3094</th>
      <td>from</td>
      <td>353</td>
    </tr>
    <tr>
      <th>4552</th>
      <td>more</td>
      <td>346</td>
    </tr>
    <tr>
      <th>590</th>
      <td>also</td>
      <td>331</td>
    </tr>
    <tr>
      <th>3856</th>
      <td>it</td>
      <td>314</td>
    </tr>
    <tr>
      <th>1771</th>
      <td>countries</td>
      <td>312</td>
    </tr>
    <tr>
      <th>627</th>
      <td>an</td>
      <td>303</td>
    </tr>
    <tr>
      <th>4729</th>
      <td>not</td>
      <td>300</td>
    </tr>
    <tr>
      <th>798</th>
      <td>at</td>
      <td>290</td>
    </tr>
    <tr>
      <th>3322</th>
      <td>has</td>
      <td>274</td>
    </tr>
    <tr>
      <th>7513</th>
      <td>which</td>
      <td>273</td>
    </tr>
    <tr>
      <th>6935</th>
      <td>their</td>
      <td>266</td>
    </tr>
    <tr>
      <th>6929</th>
      <td>than</td>
      <td>256</td>
    </tr>
    <tr>
      <th>3883</th>
      <td>job</td>
      <td>248</td>
    </tr>
    <tr>
      <th>7222</th>
      <td>unemployment</td>
      <td>243</td>
    </tr>
    <tr>
      <th>1162</th>
      <td>can</td>
      <td>241</td>
    </tr>
    <tr>
      <th>4317</th>
      <td>market</td>
      <td>235</td>
    </tr>
    <tr>
      <th>4921</th>
      <td>other</td>
      <td>228</td>
    </tr>
    <tr>
      <th>7451</th>
      <td>was</td>
      <td>220</td>
    </tr>
    <tr>
      <th>6201</th>
      <td>sector</td>
      <td>215</td>
    </tr>
    <tr>
      <th>6946</th>
      <td>these</td>
      <td>213</td>
    </tr>
    <tr>
      <th>3269</th>
      <td>growth</td>
      <td>212</td>
    </tr>
    <tr>
      <th>6947</th>
      <td>they</td>
      <td>209</td>
    </tr>
    <tr>
      <th>6735</th>
      <td>such</td>
      <td>209</td>
    </tr>
    <tr>
      <th>2396</th>
      <td>economic</td>
      <td>202</td>
    </tr>
    <tr>
      <th>6451</th>
      <td>social</td>
      <td>199</td>
    </tr>
    <tr>
      <th>3601</th>
      <td>income</td>
      <td>189</td>
    </tr>
    <tr>
      <th>7059</th>
      <td>training</td>
      <td>187</td>
    </tr>
    <tr>
      <th>4804</th>
      <td>oecd</td>
      <td>186</td>
    </tr>
    <tr>
      <th>939</th>
      <td>been</td>
      <td>184</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../_images/6d528b4a32578d54d13e4a14bce433e932e91712a2aa5df66b6eba3e7b83e886.png" src="../../_images/6d528b4a32578d54d13e4a14bce433e932e91712a2aa5df66b6eba3e7b83e886.png" />
</div>
</div>
<p><strong>Exercise 13</strong></p>
<p>With stop word removal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">text</span>
<span class="p">(</span><span class="n">top_50_words</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span> <span class="o">=</span> <span class="n">analyze_frequency</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="s1">&#39;english&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Level of cumulation percentage:&#39;</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Top 50 words:&#39;</span><span class="p">)</span>
<span class="n">top_50_words</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Level of cumulation percentage: 12.27%

Top 50 words:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10295</th>
      <td>countries</td>
      <td>7761</td>
    </tr>
    <tr>
      <th>44859</th>
      <td>women</td>
      <td>5984</td>
    </tr>
    <tr>
      <th>12072</th>
      <td>development</td>
      <td>5312</td>
    </tr>
    <tr>
      <th>19188</th>
      <td>health</td>
      <td>4685</td>
    </tr>
    <tr>
      <th>44337</th>
      <td>water</td>
      <td>4664</td>
    </tr>
    <tr>
      <th>33322</th>
      <td>public</td>
      <td>4591</td>
    </tr>
    <tr>
      <th>38326</th>
      <td>social</td>
      <td>4538</td>
    </tr>
    <tr>
      <th>13847</th>
      <td>education</td>
      <td>4535</td>
    </tr>
    <tr>
      <th>31876</th>
      <td>policy</td>
      <td>4367</td>
    </tr>
    <tr>
      <th>21846</th>
      <td>international</td>
      <td>4360</td>
    </tr>
    <tr>
      <th>24043</th>
      <td>law</td>
      <td>4240</td>
    </tr>
    <tr>
      <th>14495</th>
      <td>energy</td>
      <td>4224</td>
    </tr>
    <tr>
      <th>27973</th>
      <td>national</td>
      <td>4087</td>
    </tr>
    <tr>
      <th>35753</th>
      <td>rights</td>
      <td>3905</td>
    </tr>
    <tr>
      <th>29304</th>
      <td>oecd</td>
      <td>3547</td>
    </tr>
    <tr>
      <th>13726</th>
      <td>economic</td>
      <td>3517</td>
    </tr>
    <tr>
      <th>43320</th>
      <td>use</td>
      <td>3391</td>
    </tr>
    <tr>
      <th>28342</th>
      <td>new</td>
      <td>3337</td>
    </tr>
    <tr>
      <th>24376</th>
      <td>level</td>
      <td>3267</td>
    </tr>
    <tr>
      <th>20913</th>
      <td>income</td>
      <td>3171</td>
    </tr>
    <tr>
      <th>32235</th>
      <td>poverty</td>
      <td>3167</td>
    </tr>
    <tr>
      <th>11084</th>
      <td>data</td>
      <td>3078</td>
    </tr>
    <tr>
      <th>8513</th>
      <td>climate</td>
      <td>3033</td>
    </tr>
    <tr>
      <th>18280</th>
      <td>government</td>
      <td>3012</td>
    </tr>
    <tr>
      <th>7227</th>
      <td>care</td>
      <td>3002</td>
    </tr>
    <tr>
      <th>37356</th>
      <td>services</td>
      <td>2999</td>
    </tr>
    <tr>
      <th>17714</th>
      <td>gender</td>
      <td>2991</td>
    </tr>
    <tr>
      <th>20001</th>
      <td>human</td>
      <td>2975</td>
    </tr>
    <tr>
      <th>5194</th>
      <td>based</td>
      <td>2879</td>
    </tr>
    <tr>
      <th>39986</th>
      <td>support</td>
      <td>2759</td>
    </tr>
    <tr>
      <th>44896</th>
      <td>work</td>
      <td>2742</td>
    </tr>
    <tr>
      <th>19483</th>
      <td>high</td>
      <td>2674</td>
    </tr>
    <tr>
      <th>4016</th>
      <td>areas</td>
      <td>2611</td>
    </tr>
    <tr>
      <th>37030</th>
      <td>sector</td>
      <td>2583</td>
    </tr>
    <tr>
      <th>41272</th>
      <td>time</td>
      <td>2581</td>
    </tr>
    <tr>
      <th>31873</th>
      <td>policies</td>
      <td>2477</td>
    </tr>
    <tr>
      <th>36770</th>
      <td>school</td>
      <td>2466</td>
    </tr>
    <tr>
      <th>25497</th>
      <td>management</td>
      <td>2465</td>
    </tr>
    <tr>
      <th>2098</th>
      <td>access</td>
      <td>2424</td>
    </tr>
    <tr>
      <th>7882</th>
      <td>change</td>
      <td>2416</td>
    </tr>
    <tr>
      <th>18543</th>
      <td>growth</td>
      <td>2386</td>
    </tr>
    <tr>
      <th>19484</th>
      <td>higher</td>
      <td>2367</td>
    </tr>
    <tr>
      <th>21274</th>
      <td>information</td>
      <td>2363</td>
    </tr>
    <tr>
      <th>20898</th>
      <td>including</td>
      <td>2357</td>
    </tr>
    <tr>
      <th>15415</th>
      <td>example</td>
      <td>2318</td>
    </tr>
    <tr>
      <th>24819</th>
      <td>local</td>
      <td>2285</td>
    </tr>
    <tr>
      <th>33571</th>
      <td>quality</td>
      <td>2255</td>
    </tr>
    <tr>
      <th>20724</th>
      <td>important</td>
      <td>2236</td>
    </tr>
    <tr>
      <th>25028</th>
      <td>low</td>
      <td>2217</td>
    </tr>
    <tr>
      <th>12270</th>
      <td>different</td>
      <td>2211</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../_images/e98e748e7b0cc5131408459877468e4bcef994958892783bfef45ab3347c3a53.png" src="../../_images/e98e748e7b0cc5131408459877468e4bcef994958892783bfef45ab3347c3a53.png" />
</div>
</div>
<p>Without stop word removal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">top_50_words</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span> <span class="o">=</span> <span class="n">analyze_frequency</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Level of cumulation percentage:&#39;</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Top 50 words:&#39;</span><span class="p">)</span>
<span class="n">top_50_words</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Level of cumulation percentage: 36.81%

Top 50 words:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>41229</th>
      <td>the</td>
      <td>143100</td>
    </tr>
    <tr>
      <th>29487</th>
      <td>of</td>
      <td>95834</td>
    </tr>
    <tr>
      <th>3469</th>
      <td>and</td>
      <td>93357</td>
    </tr>
    <tr>
      <th>20921</th>
      <td>in</td>
      <td>67152</td>
    </tr>
    <tr>
      <th>41630</th>
      <td>to</td>
      <td>64701</td>
    </tr>
    <tr>
      <th>16900</th>
      <td>for</td>
      <td>30010</td>
    </tr>
    <tr>
      <th>22403</th>
      <td>is</td>
      <td>25175</td>
    </tr>
    <tr>
      <th>41221</th>
      <td>that</td>
      <td>20395</td>
    </tr>
    <tr>
      <th>4217</th>
      <td>as</td>
      <td>18926</td>
    </tr>
    <tr>
      <th>29700</th>
      <td>on</td>
      <td>18365</td>
    </tr>
    <tr>
      <th>4040</th>
      <td>are</td>
      <td>18215</td>
    </tr>
    <tr>
      <th>6918</th>
      <td>by</td>
      <td>14171</td>
    </tr>
    <tr>
      <th>45094</th>
      <td>with</td>
      <td>14162</td>
    </tr>
    <tr>
      <th>41378</th>
      <td>this</td>
      <td>14153</td>
    </tr>
    <tr>
      <th>5337</th>
      <td>be</td>
      <td>12608</td>
    </tr>
    <tr>
      <th>17320</th>
      <td>from</td>
      <td>9833</td>
    </tr>
    <tr>
      <th>29892</th>
      <td>or</td>
      <td>9382</td>
    </tr>
    <tr>
      <th>22504</th>
      <td>it</td>
      <td>9364</td>
    </tr>
    <tr>
      <th>19212</th>
      <td>have</td>
      <td>9070</td>
    </tr>
    <tr>
      <th>3397</th>
      <td>an</td>
      <td>7885</td>
    </tr>
    <tr>
      <th>10354</th>
      <td>countries</td>
      <td>7761</td>
    </tr>
    <tr>
      <th>4447</th>
      <td>at</td>
      <td>7643</td>
    </tr>
    <tr>
      <th>19159</th>
      <td>has</td>
      <td>7551</td>
    </tr>
    <tr>
      <th>41248</th>
      <td>their</td>
      <td>7356</td>
    </tr>
    <tr>
      <th>28988</th>
      <td>not</td>
      <td>7182</td>
    </tr>
    <tr>
      <th>3182</th>
      <td>also</td>
      <td>7151</td>
    </tr>
    <tr>
      <th>44893</th>
      <td>which</td>
      <td>6968</td>
    </tr>
    <tr>
      <th>27490</th>
      <td>more</td>
      <td>6953</td>
    </tr>
    <tr>
      <th>41327</th>
      <td>these</td>
      <td>6246</td>
    </tr>
    <tr>
      <th>7121</th>
      <td>can</td>
      <td>6016</td>
    </tr>
    <tr>
      <th>45152</th>
      <td>women</td>
      <td>5984</td>
    </tr>
    <tr>
      <th>40001</th>
      <td>such</td>
      <td>5612</td>
    </tr>
    <tr>
      <th>12135</th>
      <td>development</td>
      <td>5312</td>
    </tr>
    <tr>
      <th>30114</th>
      <td>other</td>
      <td>5018</td>
    </tr>
    <tr>
      <th>41211</th>
      <td>than</td>
      <td>4751</td>
    </tr>
    <tr>
      <th>19298</th>
      <td>health</td>
      <td>4685</td>
    </tr>
    <tr>
      <th>41339</th>
      <td>they</td>
      <td>4666</td>
    </tr>
    <tr>
      <th>44606</th>
      <td>water</td>
      <td>4664</td>
    </tr>
    <tr>
      <th>33516</th>
      <td>public</td>
      <td>4591</td>
    </tr>
    <tr>
      <th>38540</th>
      <td>social</td>
      <td>4538</td>
    </tr>
    <tr>
      <th>13916</th>
      <td>education</td>
      <td>4535</td>
    </tr>
    <tr>
      <th>5660</th>
      <td>between</td>
      <td>4466</td>
    </tr>
    <tr>
      <th>5401</th>
      <td>been</td>
      <td>4377</td>
    </tr>
    <tr>
      <th>32070</th>
      <td>policy</td>
      <td>4367</td>
    </tr>
    <tr>
      <th>21975</th>
      <td>international</td>
      <td>4360</td>
    </tr>
    <tr>
      <th>44573</th>
      <td>was</td>
      <td>4339</td>
    </tr>
    <tr>
      <th>24180</th>
      <td>law</td>
      <td>4240</td>
    </tr>
    <tr>
      <th>14571</th>
      <td>energy</td>
      <td>4224</td>
    </tr>
    <tr>
      <th>6886</th>
      <td>but</td>
      <td>4088</td>
    </tr>
    <tr>
      <th>28132</th>
      <td>national</td>
      <td>4087</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="../../_images/db51b377e22fd39a55662106206b6f50dcf0f122f626d41c729d8dc61cedd6f7.png" src="../../_images/db51b377e22fd39a55662106206b6f50dcf0f122f626d41c729d8dc61cedd6f7.png" />
</div>
</div>
<p>Frequent words that are not stop words, such as â€˜countriesâ€™, â€˜womenâ€™, and â€˜developmentâ€™, occur often enough to show up in both lists. As one might expect, stop words such as â€˜theâ€™, â€˜ofâ€™, and â€˜andâ€™ occur much more frequently than terms that are not stop words. As a result, the level of cumulation percentage is much smaller and the cumulative word count curve is more linear with stop word removal than without stop word removal.</p>
</section>
<section id="document-embedding">
<h2><span class="section-number">14.8.3. </span>Document Embedding<a class="headerlink" href="#document-embedding" title="Link to this heading">#</a></h2>
<p><strong>Exercise 1</strong></p>
<p>After creating <code class="docutils literal notranslate"><span class="pre">sentence_df</span></code>, we can compare its dimensions to those of <code class="docutils literal notranslate"><span class="pre">text_df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tokenize_into_sentences</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
    <span class="n">corpus_sentence</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corpus_sdg</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corpus_sample</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">sdg</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">sdg</span><span class="p">,</span> <span class="n">corpus</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
        <span class="n">sentences</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> 
        <span class="n">corpus_sentence</span> <span class="o">+=</span> <span class="n">sentences</span>
        <span class="n">corpus_sdg</span> <span class="o">+=</span> <span class="p">[</span><span class="n">sdg</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
        <span class="n">corpus_sample</span> <span class="o">+=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span>
    <span class="n">sentence_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">corpus_sentence</span><span class="p">,</span> <span class="s2">&quot;sdg&quot;</span><span class="p">:</span> <span class="n">corpus_sdg</span><span class="p">,</span> <span class="s2">&quot;sample&quot;</span><span class="p">:</span> <span class="n">corpus_sample</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">sentence_df</span>

<span class="n">sentence_df</span> <span class="o">=</span> <span class="n">tokenize_into_sentences</span><span class="p">(</span><span class="n">text_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;text_df dimensions:&#39;</span><span class="p">,</span> <span class="n">text_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sentence_df dimensions:&#39;</span><span class="p">,</span> <span class="n">sentence_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>text_df dimensions: (24669, 7)
sentence_df dimensions: (92839, 3)
</pre></div>
</div>
</div>
</div>
<p>The dimensions of <code class="docutils literal notranslate"><span class="pre">text_df</span></code> represent the number of sample texts and the number of features, respectively. The dimensions of <code class="docutils literal notranslate"><span class="pre">sentence_df</span></code>represent the number of sentences and the number of features, respectively.</p>
<p><strong>Exercise 2</strong></p>
<p>Student answers may vary. As a sample answer, we choose a text containing direct quotations, which can increase the difficulty of sentence tokenization:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text_df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">465</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;When asked â€œHave you no morals?â€ Alfred Doolittle in George Bernard Shawâ€™s Pygmalion answered: â€œCanâ€™t afford them governor. Neither could you if you was as poor as me.â€ The modern concept of human rights underpins a moral society and holds governments responsible for fulfilling these rights. From informed consent to the right to privacy civil and political rights have dominated the human rights focus of the HIV-1 epidemic. Yet the economic and social rights of people with HIV-1 infection in particular the rights to health care and to share in scientific advances are glaringly disparate between rich and poor countries. This disparity has become the focus of debate in transnational HIV-1 vaccine research. (excerpt)&#39;
</pre></div>
</div>
</div>
</div>
<p>Despite the increased difficulty, the sentence tokenizer is able to separate out the sentences correctly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sentence_df</span><span class="p">[</span><span class="n">sentence_df</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">465</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>sdg</th>
      <th>sample</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1785</th>
      <td>When asked â€œHave you no morals?â€ Alfred Doolit...</td>
      <td>16</td>
      <td>465</td>
    </tr>
    <tr>
      <th>1786</th>
      <td>Neither could you if you was as poor as me.â€ T...</td>
      <td>16</td>
      <td>465</td>
    </tr>
    <tr>
      <th>1787</th>
      <td>From informed consent to the right to privacy ...</td>
      <td>16</td>
      <td>465</td>
    </tr>
    <tr>
      <th>1788</th>
      <td>Yet the economic and social rights of people w...</td>
      <td>16</td>
      <td>465</td>
    </tr>
    <tr>
      <th>1789</th>
      <td>This disparity has become the focus of debate ...</td>
      <td>16</td>
      <td>465</td>
    </tr>
    <tr>
      <th>1790</th>
      <td>(excerpt)</td>
      <td>16</td>
      <td>465</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Exercise 3</strong></p>
<p>Answers may vary depending on the samples chosen. For simplicity, this sample solution chooses two samples in <code class="docutils literal notranslate"><span class="pre">text_df</span></code> with the same number of sentences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="n">text_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">32</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">sentences</span> <span class="o">=</span> <span class="n">tokenize_into_sentences</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">sentences</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>sdg</th>
      <th>sample</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>This points to the possibility that the effect...</td>
      <td>1</td>
      <td>32</td>
    </tr>
    <tr>
      <th>1</th>
      <td>One possible explanation for this is that incr...</td>
      <td>1</td>
      <td>32</td>
    </tr>
    <tr>
      <th>2</th>
      <td>These results are similar to those obtained by...</td>
      <td>1</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3</th>
      <td>This analysis is presented in the following se...</td>
      <td>1</td>
      <td>32</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Prescription rates appear to be higher where l...</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>There is also a possible relationship between ...</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>This may arise after the definition of disabil...</td>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Krueger (2017(47)) found that around one-fifth...</td>
      <td>8</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change this to your own embedding directory</span>
<span class="n">embedding_dir</span> <span class="o">=</span> <span class="s2">&quot;embeddings/&quot;</span>

<span class="c1"># load the embedding</span>
<span class="n">embed</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">embedding_dir</span> <span class="o">+</span> <span class="s2">&quot;universal-sentence-encoder_4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sdg1_embedding</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="n">sentences</span><span class="p">[</span><span class="s1">&#39;sdg&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">sdg8_embedding</span> <span class="o">=</span> <span class="n">embed</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="n">sentences</span><span class="p">[</span><span class="s1">&#39;sdg&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">np</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">sdg1_embedding</span><span class="p">,</span> <span class="n">sdg8_embedding</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(0.2418205, dtype=float32)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Advanced/AdvDataAnalysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sec6_applications.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">14.7. </span>Applications</p>
      </div>
    </a>
    <a class="right-next"
       href="solutions_sec5-7.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">14.9. </span>Solutions to Exercises: Sections 5 to 7</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">14.8.1. Preprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-text-data">14.8.2. About Text Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#document-embedding">14.8.3. Document Embedding</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara, Claire Wagner, Peter Jantsch, and Thomas VanDrunen, Editors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
  <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'><img alt='Creative Commons License' width=88 style='border-width:0' src='https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by.png'/></a>
  Except where otherwise noted, this work is licensed under a <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 International License</a>.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>