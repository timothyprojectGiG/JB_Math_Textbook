
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.5. Linear Regression &#8212; An Introduction to Python Jupyter Notebooks for College Math Teachers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=07d05eac" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ProbStat/StatInf/04_Regression';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7. APPLIED CALCULUS FOR DAILY LIFE - Wheaton College Team" href="../../AppliedCalc.html" />
    <link rel="prev" title="6.4. Hypothesis Testing for Numerical Data" href="03_Inference_Numerical.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="An Introduction to Python Jupyter Notebooks for College Math Teachers - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="An Introduction to Python Jupyter Notebooks for College Math Teachers - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    An Introduction to  Python Jupyter Notebooks for College Math Teachers
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Preface.html">1. PREFACE</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../JMM23.html">1.1. JMM 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lab.html">1.2. JNB LAB: Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../labsolutions.html">1.3. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PreCollege.html">2. PRE-COLLEGE</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Elementary/Arithmetic/elementary.html">2.1. Elementary Blackboard Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/GettingStarted/python.html">2.2. Beginning Python Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/Chicago.html">2.3. Glimpse of Chicago</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/steam.html">2.4. Arts in STEM (STEAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/solutions.html">2.5. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/demo.html">2.6. JNB LAB: After-School Program Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PreCollege/Celestial/demosolutions.html">2.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Intropy.html">3. PYTHON PROGRAMMING GUIDE - Thomas VanDrunen, Yiheng Liang</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Introduction_to_Python.html">3.1. Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Data.html">3.2. Working with Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/solutions.html">3.3. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Plab.html">3.4. JNB Lab: Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Programming/Plabsolutions.html">3.5. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Data.html">4. EXPLORATORY DATA ANALYSIS - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../EDA/1.%20Great%20Migration.html">4.1. The Great Migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../EDA/2.%20Chicago%20Hardship%20Index.html">4.2. The Chicago Hardship Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../EDA/solutions.html">4.3. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../EDA/lab.html">4.4. JNB Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../EDA/labsolution.html">4.5. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Prob.html">5. PROBABILITY - Laura Gross, Yiheng Liang</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob.html">5.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob1.html">5.2. Random Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob2.html">5.3. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob3.html">5.4. Conditional Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob4.html">5.5. Probability Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob4a.html">5.6. Random Walks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob5.html">5.7. Agent-based Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/prob6.html">5.8. Mathematical Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/solutions.html">5.9. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/lab.html">5.10. JNB Lab Homicides in Chicago</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProbIntro/labsolution.html">5.11. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../Stat.html">6. STATISTICAL INFERENCE - Peter Jantsch, Claire Wagner</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_Instructor_Notes.html">6.1. Introduction and Instructor Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_Foundations.html">6.2. Foundations of Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Inference_Categorical.html">6.3. Hypothesis Testing for Categorical Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Inference_Numerical.html">6.4. Hypothesis Testing for Numerical Data</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.5. Linear Regression</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AppliedCalc.html">7. APPLIED CALCULUS FOR DAILY LIFE - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/twocommodity.html">7.1. Linear Systems and the Two-commodity Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/marginal.html">7.2. Marginal and Average Cost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/design.html">7.3. Optimization and Object Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/cobbs.html">7.4. Optimization and Cobbs-Douglas Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/rates.html">7.5. Related Rates and Volumes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/football.html">7.6. Related Rates with Trig Functions and Football</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/jnb7.html">7.7. Probability Distributions and Drive Thrus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/control.html">7.8. Normal Distribution and Process Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/ols.html">7.9. Partial Derivatives and OLS Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/gini.html">7.10. Area Between Curves and the Gini Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/income.html">7.11. Integral Test and Income Streams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/ode.html">7.12. Ordinary Differential Equations and Exponential Growth/Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/solutions.html">7.13. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/AClab.html">7.14. JNB Lab: Calculus of Entropy in Daily Life and Monte Carlo Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedCalc/AClabsolutions.html">7.15. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Calc.html">8. CALCULUS - Inne Singgih</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/Intro.html">8.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/2Functions.html">8.2. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/3Limits.html">8.3. Limits, Continuity, and Rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/4%20Derivatives.html">8.4. Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/5%20Integrals.html">8.5. Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/6%20ParametricEquations.html">8.6. Parametric Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/7%20Sequences%20and%20Series.html">8.7. Sequences and Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/Solutions.html">8.8. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/clab.html">8.9. JNB LAB: Calculus Animations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Calculus/clabsolution.html">8.10. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Linear.html">9. LINEAR ALGEBRA - Soheil Anbouhi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/0.html">9.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/1.html">9.2. Linear Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/2.html">9.3. Matrices and Determinants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/3.html">9.4. Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/4.html">9.5. Eigenvalues and Eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/5.html">9.6. Orthogonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/Solutions.html">9.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/LAlab.html">9.8. Linear Algebra Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/Linear/LAlabsolutions.html">9.9. Linear Algebra Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Aplin.html">10. LINEAR ALGEBRA AND OPTIMIZATION FOR DATA ANALYSIS - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/Introduction.html">10.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html">10.2. OLS Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/KMeans/jnb2.html">10.3. K-means Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/PCA/jnb3.html">10.4. Dimension Reduction by Principal Component Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/SVM/jnb4.html">10.5. Binary Classification of Labelled Data by Support Vector Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/solutions.html">10.6. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/ALlab.html">10.7. JNB LAB: Linear Algebra for Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/LinearAlgebra/ALlabsolution.html">10.8. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../DifEq.html">11. DIFFERENTIAL EQUATIONS - Rachel Petrik</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations.html">11.1. Overview of Chapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE2.html">11.2. Introduction to Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE3.html">11.3. First-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE4.html">11.4. Second-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE5.html">11.5. Systems of First-Order Differential Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DE6.html">11.6. Laplace Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/DESolutions.html">11.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations%20Book%201%20Lab.html">11.8. Differential Equations Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/DifEq/Differential%20Equations%20Book%201%20Lab%20Answer%20Key.html">11.9. Differential Equations Lab Answer Key</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AppliedDifEq.html">12. DIFFERENTIAL EQUATIONS FOR THE BENEFIT OF SOCIETY - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/covid.html">12.1. Logistic Growth and COVID-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/sir.html">12.2. The Basic SIR Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cholera.html">12.3. Cholera in Haiti</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/cws/cws.html">12.4. CWS Model of Alzheimer’s Disease</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/gravity/gravity.html">12.5. Gravity Fed Water Delivery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/erc/erc.html">12.6. Earthquake Resistant Construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/solutions.html">12.7. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/hiv/lab.html">12.8. JNB Lab: HIV-AIDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Undergrad/AppliedDifEq/labsolutions.html">12.9. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ComplexVar.html">13. COMPLEX VARIABLES IN GROUNDWATER MODELING - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_1.html">13.1. Setting the Scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_2.html">13.2. Complex Analysis Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_3.html">13.3. Idealized Groundwater Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_4.html">13.4. Contaminant Extraction Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_solutions.html">13.5. Solutions to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_lab.html">13.6. JNB LAB: Complex Potentials and Contaminant Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/Complex/complex_variables_lab_solution.html">13.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../AdvData.html">14. ADVANCED DATA ANALYSIS - Ying Li, Jonathan Zhu</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec0_data.html">14.1. Before Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec1_preprocessing.html">14.2. Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec2_transform_features.html">14.3. About Text Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec3_doc_embedding.html">14.4. Document Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec4_classification_algos.html">14.5. Classification of Texts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec5_classification_eval.html">14.6. Evaluating Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/sec6_applications.html">14.7. Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/AdvDataAnalysis/solutions.html">14.8. Solutions to Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../ComplexSystems.html">15. COMPLEX SYSTEMS - Wheaton College Team</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_1.html">15.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_2.html">15.2. Fundamental Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_3.html">15.3. Mathematical Concepts from Equilibrium Statistical Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_4.html">15.4. Societal Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_solutions.html">15.5. Solution to Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_lab.html">15.6. JNB LAB: Complex Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Advanced/ComplexSystems/complex_systems_labsolution.html">15.7. JNB Lab Solutions</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/timothyprojectGiG/JB_Math_Textbook/main?urlpath=tree/src/ProbStat/StatInf/04_Regression.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/timothyprojectGiG/JB_Math_Textbook/issues/new?title=Issue%20on%20page%20%2FProbStat/StatInf/04_Regression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ProbStat/StatInf/04_Regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-linear-regression">6.5.1. Simple Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#world-bank-development-indicators">World Bank Development Indicators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-linear-regression-models">Simple Linear Regression Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minimizing-the-sum-of-squares-error">Minimizing the Sum of Squares Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-least-squares-line">Finding the Least Squares Line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-2-and-goodness-of-fit-tests"><span class="math notranslate nohighlight">\(R^2\)</span> and Goodness of Fit Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inference-on-model-parameters">Inference on Model Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-diagnostics">Model Diagnostics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-1">Exercise 4.1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-regression">6.5.2. Multiple Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-variables">Dummy Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Model Diagnostics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Inference on Model Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-2">Exercise 4.2</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="c1"># Always run this cell first!</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="c1"># appear to need to import the api as well as the library itself for the interpreter to find the modules</span>
<span class="kn">import</span> <span class="nn">statsmodels</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">offline</span><span class="o">.</span><span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># make plotly work with Jupyter Notebook using CDN</span>

<span class="c1"># an extra function for plotting a straight line</span>
<span class="k">def</span> <span class="nf">plot_abline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">x_name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y_name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot a line from slope and intercept&quot;&quot;&quot;</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_vals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">y_name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}{</span><span class="n">x_name</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">intercept</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        </div></div>
</div>
<div class="highlight-{index}Linear notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="linear-regression">
<h1><span class="section-number">6.5. </span>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h1>
<p>We next turn to explore another type of statistical decision-making tool, linear regression. Linear regression is a tool to allow us to explore the connections between 2 or more variables.</p>
<section id="simple-linear-regression">
<h2><span class="section-number">6.5.1. </span>Simple Linear Regression<a class="headerlink" href="#simple-linear-regression" title="Link to this heading">#</a></h2>
<p>To begin, we’ll look at simple linear regression, which models the linear association between two variables. This allows us to see how changes in one variable affect the other. To motivate the theory, we’ll take a look at how statistics related to primary school education in a given country are associated with the literacy rate in that country.</p>
<section id="world-bank-development-indicators">
<h3>World Bank Development Indicators<a class="headerlink" href="#world-bank-development-indicators" title="Link to this heading">#</a></h3>
<p>The World Development Indicators dataset, maintained by the World Bank, contains information about a wide variety of topics related to global development. The <a class="reference external" href="https://datacatalog.worldbank.org/search/dataset/0037712">most recent version</a> of the dataset, as of writing, provides over 1500 indicators for 217 economies from 1960 to 2021. The dataset is licensed under a <a class="reference external" href="https://datacatalog.worldbank.org/public-licenses#cc-by">Creative Commons Attribution 4.0 International License</a>.</p>
<p>For our example, we will look at three statistics related to literacy. We will limit our analysis to the 89 countries that have valid data for all three statistics for at least one year in the time range 2017-2021. For each country, we will consider the most recent year from that time range for which all three statistics are available.</p>
<p>Let’s take a look at this data, which is in a file called <code class="docutils literal notranslate"><span class="pre">world_bank_literacy.csv</span></code> (click <a class="reference download internal" download="" href="../../_downloads/b5125f4c3e42152ed28a65502e6be57f/world_bank_literacy.csv"><span class="xref download myst">here</span></a> to download a copy).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wbl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;world_bank_literacy.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;country_code&#39;</span><span class="p">)</span>
<span class="n">wbl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>adult_literacy_rate_(pct)</th>
      <th>primary_school_completion_rate_(pct)</th>
      <th>primary_school_enrollment_rate_(pct)</th>
    </tr>
    <tr>
      <th>country_code</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALB</th>
      <td>Albania</td>
      <td>2021</td>
      <td>98.449997</td>
      <td>98.155830</td>
      <td>95.921783</td>
    </tr>
    <tr>
      <th>ARE</th>
      <td>United Arab Emirates</td>
      <td>2019</td>
      <td>95.526482</td>
      <td>111.938820</td>
      <td>114.412361</td>
    </tr>
    <tr>
      <th>ARG</th>
      <td>Argentina</td>
      <td>2018</td>
      <td>99.003868</td>
      <td>98.706253</td>
      <td>109.659172</td>
    </tr>
    <tr>
      <th>ARM</th>
      <td>Armenia</td>
      <td>2020</td>
      <td>99.788612</td>
      <td>93.165291</td>
      <td>91.235443</td>
    </tr>
    <tr>
      <th>AZE</th>
      <td>Azerbaijan</td>
      <td>2019</td>
      <td>99.795982</td>
      <td>100.383339</td>
      <td>97.935349</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here is a brief summary of the information in the last three columns.</p>
<ul class="simple">
<li><p>The column labeled <code class="docutils literal notranslate"><span class="pre">adult_literacy_rate_(pct)</span></code> (World Bank indicator <a class="reference external" href="https://data.worldbank.org/indicator/SE.ADT.LITR.ZS">SE.ADT.LITR.ZS</a>) contains the percentage of people age 15 and up in each country who are literate. The World Bank <a class="reference external" href="https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SE.ADT.LITR.ZS">defines</a> a person as literate if they can “read and write with understanding a short simple statement about their everyday life.”</p></li>
<li><p>The column labeled <code class="docutils literal notranslate"><span class="pre">primary_school_enrollment_rate_(pct)</span></code> (World Bank indicator <a class="reference external" href="https://data.worldbank.org/indicator/SE.PRM.ENRR">SE.PRM.ENRR</a>) contains the gross percentage of people enrolled in primary school in each country. This percentage is <a class="reference external" href="https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SE.PRM.ENRR">calculated</a> by taking the total number of primary school students in a given country (no matter what their age is) and dividing it by the total number of people in the <em>official</em> age group for primary school in that country. Because some of the students in primary school might be older or younger than the official primary school ages, this percentage can be greater than 100%.</p></li>
<li><p>The column labeled <code class="docutils literal notranslate"><span class="pre">primary_school_completion_rate_(pct)</span></code> (World Bank indicator <a class="reference external" href="https://data.worldbank.org/indicator/SE.PRM.CMPT.ZS">SE.PRM.CMPT.ZS</a>) contains the gross percentage of people enrolled in the <em>last</em> grade of primary school in each country. This percentage is <a class="reference external" href="https://databank.worldbank.org/metadataglossary/world-development-indicators/series/SE.PRM.CMPT.ZS">calculated</a> by taking the total number of non-repeating students in the last grade of primary school in a given country (no matter what their age is) and dividing it by the total number of people in the <em>official</em> age group for the last grade of primary school in that country. This percentage is not the actual rate of students who complete primary school, but it serves as a proxy (a variable we can measure that helps us approximate something else we can’t measure) for that rate. As with <code class="docutils literal notranslate"><span class="pre">primary_school_enrollment_(pct)</span></code>, this percentage can be greater than 100% because some of the students in the last grade of primary school might be older or younger than the official age for that grade.</p></li>
</ul>
<p>Let’s suppose we are interested in literacy rates worldwide. We could begin our exploration by taking a look at some summary statistics:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wbl</span><span class="p">[</span><span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    89.000000
mean     85.170694
std      18.214867
min      26.760000
25%      76.570518
50%      94.971130
75%      98.419998
max      99.999947
Name: adult_literacy_rate_(pct), dtype: float64
</pre></div>
</div>
</div>
</div>
<p><em>Note that since we take the average over <em>countries</em> in the sample, the average literacy rate here also refers to an average country. Since the average rate doesn’t take into account the population of any country, it is not reflective of the overall worldwide literacy rate.</em></p>
<p>An average country in our sample has a literacy rate of about 85%, and there is a fair bit of variation in the literacy rates. But what are some of the things that are connected with literacy rates in different countries? For example, maybe literacy rate is connected to the percentage of students in the country that complete primary schooling. We could explore this connection with a scatter plot:</p>
<div class="cell tag_hide-input docutils container" id="scatter-plot-simple">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Primary School Completion Rate vs. Adult Literacy Rate&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/8f4178137921a775131737495742745c5dfaae980bf96ed37206372222d584f9.png"><img alt="../../_images/8f4178137921a775131737495742745c5dfaae980bf96ed37206372222d584f9.png" src="../../_images/8f4178137921a775131737495742745c5dfaae980bf96ed37206372222d584f9.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>It looks like there is some connection here! As primary school completion rate increases, so does the literacy rate. We might call this a <strong>positive trend</strong>. Plus, it looks like you might be able to draw a line through the middle of this cloud of points to describe the way the cluster of points moves. So we might also call this a <strong>linear trend</strong>. We can describe this relationship in more depth using the tools of linear regression.</p>
<p>Note that just because these two variables seem to have some pattern when plotted together, that doesn’t mean that primary school completion rate <em>causes</em> the change in literacy rate. It just means that primary school completion rate is <em>associated</em> with the change in literacy rate. (We’ll use the word <strong>association</strong> to describe any pattern or connection between two variables, because “correlation is not causation”.)</p>
<div class="highlight-{index}Simple notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
<section id="simple-linear-regression-models">
<h3>Simple Linear Regression Models<a class="headerlink" href="#simple-linear-regression-models" title="Link to this heading">#</a></h3>
<p>Simple linear regression is the method we have of modeling the linear association between two variables. You may have learned in algebra that one common way to write the equation of a line is the <em>slope-intercept form</em> <span class="math notranslate nohighlight">\(b + mx\)</span>. In this equation, <span class="math notranslate nohighlight">\(m\)</span> is the slope, and the addition of <span class="math notranslate nohighlight">\(b\)</span> means that the line passes through the point <span class="math notranslate nohighlight">\((0,b)\)</span>, which is called the intercept of the line.</p>
<p>However, we can see from the <a class="reference internal" href="#scatter-plot-simple"><span class="std std-ref">scatter plot</span></a> that our data points don’t exactly fit a straight line. Instead, they seem to have some random deviations around a general trend line. We can write this <em>line-plus-random-error</em> idea using the mathematical equation</p>
<div class="amsmath math notranslate nohighlight" id="equation-694061c0-0dce-4a9e-8c26-79a3d3c97b10">
<span class="eqno">(6.18)<a class="headerlink" href="#equation-694061c0-0dce-4a9e-8c26-79a3d3c97b10" title="Permalink to this equation">#</a></span>\[\begin{equation}
Y = \alpha + \beta x + \varepsilon.
\end{equation}\]</div>
<p>This is another type of statistical model, called a linear regression model. It says that the value of (the random variable) <span class="math notranslate nohighlight">\(Y\)</span> is just the value along the line <span class="math notranslate nohighlight">\(\alpha + \beta x\)</span> plus a random error <span class="math notranslate nohighlight">\(\varepsilon\)</span>. If we knew the slope <span class="math notranslate nohighlight">\(\beta\)</span> and intercept <span class="math notranslate nohighlight">\(\alpha\)</span> of the line, then we could plug in the value of <span class="math notranslate nohighlight">\(x\)</span> to get a good guess for <span class="math notranslate nohighlight">\(Y\)</span>, though it would be off by some error.</p>
<p>You probably have many questions at this point, especially if this idea is new to you! But we want to first consider a big one: how do we figure out the equation for the line? There are multiple lines we could draw. Below are three of them. If you’re following along in an interactive notebook, try playing around with the slope and intercept of the first line to see if you can make it fit the data as best you can.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make your own line by changing around these numbers:</span>
<span class="n">slope</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="c1"># add scatter plot of data</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># plot the lines with given slope and intercept</span>
<span class="c1"># use function defined in first cell</span>
<span class="n">plot_abline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">))</span>
<span class="n">plot_abline</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">))</span>
<span class="n">plot_abline</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Three Possible Regression Lines&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/e0c21f0bcd53c27e8f84a435b537bb493e80c5c71a0f7e58fec441207cbf98a0.png"><img alt="../../_images/e0c21f0bcd53c27e8f84a435b537bb493e80c5c71a0f7e58fec441207cbf98a0.png" src="../../_images/e0c21f0bcd53c27e8f84a435b537bb493e80c5c71a0f7e58fec441207cbf98a0.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>Which of these lines is best? And what would make a line the “best” one in this situation? The method of least squares, described below, is a way to answer both of these questions.</p>
<div class="highlight-{index}Sum notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="highlight-{index}Residual notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
<section id="minimizing-the-sum-of-squares-error">
<h3>Minimizing the Sum of Squares Error<a class="headerlink" href="#minimizing-the-sum-of-squares-error" title="Link to this heading">#</a></h3>
<p>If you spent some time thinking about where the “best” line should go, you probably tried to get it somewhere in the middle of the cloud of points, so that it wasn’t too far away from any one point. In that way it would follow the general trend, even if it didn’t exactly match any of the data points.</p>
<p>We can make this idea more mathematical by considering something called the <strong>residual</strong>. For each country in our data set, we have a pair of primary school completion rates and literacy rates, which we could enumerate as pairs <span class="math notranslate nohighlight">\((x_i,y_i)\)</span>. Given any line <span class="math notranslate nohighlight">\(\hat y = a + bx\)</span>, the residual is the difference between the actual value <span class="math notranslate nohighlight">\(y_i\)</span> associated with <span class="math notranslate nohighlight">\(x_i\)</span> in the data, and the value <span class="math notranslate nohighlight">\(\hat y_i\)</span> that lies along the line <span class="math notranslate nohighlight">\(a + bx_i\)</span> (that is, the residual is <span class="math notranslate nohighlight">\(y_i - \hat y_i\)</span>). In other words, the residual measures how far our line is from passing through a certain data point.</p>
<p>Below we look at plots of two different lines and examine the residuals associated with them. The residual for each point is the vertical distance from the point to the line. Which line do you think better fits the trend of the points? And what is the difference between the residuals of the two trend lines?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">slopes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">.95</span><span class="p">]</span>
<span class="n">intercepts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">(</span><span class="n">scattercolor</span><span class="p">,</span> <span class="n">trendcolor</span><span class="p">,</span> <span class="n">residcolor</span><span class="p">)</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1"># set current axis</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="c1"># plot data</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">scattercolor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># plot the line with given slope and intercept</span>
    <span class="c1"># use function defined in first cell</span>
    <span class="n">plot_abline</span><span class="p">(</span><span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">intercepts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">trendcolor</span><span class="p">)</span>
    <span class="c1"># plot residuals</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">wbl</span><span class="p">[</span><span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span><span class="p">],</span> <span class="n">wbl</span><span class="p">[</span><span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span><span class="p">])):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">intercepts</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">residcolor</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;residuals&quot;</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span> <span class="c1"># show legend entry only for first residual in each plot</span>
        <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/40b11150f363a0a0e931ede68e226b67a01d00e2c41035aab08e1a495ae84971.png"><img alt="../../_images/40b11150f363a0a0e931ede68e226b67a01d00e2c41035aab08e1a495ae84971.png" src="../../_images/40b11150f363a0a0e931ede68e226b67a01d00e2c41035aab08e1a495ae84971.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<div class="highlight-{index}Least-squares notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>The better trend line, Trend Line 2, has overall smaller residuals, so we might think that it would help  to pick the line that minimizes the sum of the residuals. This is <em>almost</em> the right idea! However, the worse line, Trend Line 1, has only negative residuals. So in fact the sum of its residuals is a negative number that will be smaller (at least on the number line) than the sum of the residuals of the better line.</p>
<p>It turns out we don’t care about the sign of the residual, only its magnitude. To solve this issue, we square each of the residuals and take the sum to form a <strong>sum of squared errors (SSE)</strong>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9160813a-cbab-46dc-8d8b-fd453d0613e5">
<span class="eqno">(6.19)<a class="headerlink" href="#equation-9160813a-cbab-46dc-8d8b-fd453d0613e5" title="Permalink to this equation">#</a></span>\[\begin{equation}
    SSE = \sum_{i=1}^n (y_i - \hat y_i)^2
\end{equation}\]</div>
<p>In the end, we want to find the slope and intercept of the line that minimizes this quantity. Since we are minimizing the sum of squared errors, this best-fit line also goes by the name <strong>least-squares regression</strong> line. Solving this problem looks like it could be tricky, but it turns out that the solution is straightforward when we employ the help of a little bit of calculus. Or, even nicer (in the author’s opinion) is to use <a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html"><span class="std std-doc">a little algebra</span></a>. We do need to assume that the random error <span class="math notranslate nohighlight">\(\varepsilon\)</span> is normally distributed, but we will gloss over this assumption for now. You can read more about how to find the line of best fit elsewhere if you’re interested, but here we’ll simply find the solution using code.</p>
<p>Why take the sum of the squares of the residuals instead of the sum of the absolute values of the residuals? One reason is mathematical: there is always a unique global minimizer to the SSE. Since squaring a large number will make it larger, this method penalizes very large residuals. Another reason is statistical: it turns out the slope and intercept of the least squares solution have special mathematical properties which make them the <em>maximum likelihood estimators</em> of the model’s true slope and intercept. But we won’t look into that here!</p>
</section>
<section id="finding-the-least-squares-line">
<h3>Finding the Least Squares Line<a class="headerlink" href="#finding-the-least-squares-line" title="Link to this heading">#</a></h3>
<p>First, we can easily use software to get a visual of the least squares regression line using <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>’s <code class="docutils literal notranslate"><span class="pre">lmplot</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span><span class="p">,</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/82ce96971653a6426c8cd8ce8e50ae1b62e4fab3c03b63d231622030c7defc4b.png"><img alt="../../_images/82ce96971653a6426c8cd8ce8e50ae1b62e4fab3c03b63d231622030c7defc4b.png" src="../../_images/82ce96971653a6426c8cd8ce8e50ae1b62e4fab3c03b63d231622030c7defc4b.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>But what if we want to be more precise and want the equation of the line? For this, we’ll use the <code class="docutils literal notranslate"><span class="pre">OLS</span></code> function from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">OLS</span></code> function is found in <code class="docutils literal notranslate"><span class="pre">statsmodels.regression.linear_model</span></code>, and it takes two arguments: the dependent variable <span class="math notranslate nohighlight">\(x\)</span> and the independent variable <span class="math notranslate nohighlight">\(y\)</span>. Since we want a line that has an intercept, we plug our <span class="math notranslate nohighlight">\(x\)</span> variable into the <code class="docutils literal notranslate"><span class="pre">add_constant</span></code> function to make sure we get the intercept term. This creates our “model object”, which we named <code class="docutils literal notranslate"><span class="pre">lin_mod</span></code>.</p>
<p>The linear model object <code class="docutils literal notranslate"><span class="pre">lin_mod</span></code> has a <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function, which performs the least squares algorithm to find the equation of the line of best fit. The results of the algorithm can be printed out in a summary, which you see below. This is going to display a lot of output, but we’ll walk through it slowly!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span>

<span class="n">lin_mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">regression</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span>
    <span class="n">wbl</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="c1"># the dependent variable (y)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">wbl</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="c1"># the independent variable (x)</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">lin_mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                OLS Regression Results                               
=====================================================================================
Dep. Variable:     adult_literacy_rate_(pct)   R-squared:                       0.567
Model:                                   OLS   Adj. R-squared:                  0.562
Method:                        Least Squares   F-statistic:                     114.0
Date:                       Thu, 20 Jul 2023   Prob (F-statistic):           1.70e-17
Time:                               16:47:33   Log-Likelihood:                -346.82
No. Observations:                         89   AIC:                             697.6
Df Residuals:                             87   BIC:                             702.6
Df Model:                                  1                                         
Covariance Type:                   nonrobust                                         
========================================================================================================
                                           coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------------------------------
const                                    6.6714      7.462      0.894      0.374      -8.160      21.503
primary_school_completion_rate_(pct)     0.8615      0.081     10.677      0.000       0.701       1.022
==============================================================================
Omnibus:                       12.535   Durbin-Watson:                   1.772
Prob(Omnibus):                  0.002   Jarque-Bera (JB):               13.251
Skew:                          -0.842   Prob(JB):                      0.00133
Kurtosis:                       3.861   Cond. No.                         540.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>There is a lot of information here, most of which we’ll explain later on. For now, let’s see how to get the information about the slope and the intercept of the line. You can find these values in the second table under the column heading <code class="docutils literal notranslate"><span class="pre">coef</span></code>. From this, we can see that the intercept (<code class="docutils literal notranslate"><span class="pre">const</span></code>) is 6.6714, and the slope associated with the primary school completion rate is 0.8615. We can write that in slope-intercept form as the line</p>
<div class="amsmath math notranslate nohighlight" id="equation-88211448-6e9d-4fd6-aec8-f179c2df4f52">
<span class="eqno">(6.20)<a class="headerlink" href="#equation-88211448-6e9d-4fd6-aec8-f179c2df4f52" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \hat y = 6.6714 + 0.8615 x
\end{equation}\]</div>
<p>Now that we have this line, how can we understand how to use it? First, the slope tells us how the changes in <span class="math notranslate nohighlight">\(x\)</span> are connected to changes in <span class="math notranslate nohighlight">\(\hat y\)</span>. Here, an increase of 1% in the primary school completion rate (<span class="math notranslate nohighlight">\(x\)</span>) is associated with an average increase of about .865% in the literacy rate (<span class="math notranslate nohighlight">\(y\)</span>).</p>
<p>The intercept is a bit harder to interpret in this context, but it’s saying that in this model, a country with 0% primary school completion rate will, on average, have a literacy rate of 6.6714%. Of course, a 0% completion rate is much outside the range of values we have for <span class="math notranslate nohighlight">\(x\)</span>, and we don’t recommend using the model to make predictions for that range of literacy rates! (That’s called <em>extrapolation</em>.)</p>
<p>Next, we want to look at how well this model fits the data.</p>
<div class="highlight-{index}Correlation notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
<section id="r-2-and-goodness-of-fit-tests">
<h3><span class="math notranslate nohighlight">\(R^2\)</span> and Goodness of Fit Tests<a class="headerlink" href="#r-2-and-goodness-of-fit-tests" title="Link to this heading">#</a></h3>
<p>We mentioned before that we are using linear regression to <em>model</em> the relationship between two variables. But this only works if these variables actually have a linear relationship! Maybe they are actually related in a nonlinear way, or not related at all.</p>
<p>We can get some idea of this by looking at the <a class="reference internal" href="#scatter-plot-simple"><span class="std std-ref">scatter plot</span></a>, but we can also quantify the strength of a linear relationship through a number called the <strong>correlation coefficient</strong> <span class="math notranslate nohighlight">\(r\)</span>. The number <span class="math notranslate nohighlight">\(r\)</span> is a value between <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(1\)</span> that measures the strength of the linear association between two variables.</p>
<p>What’s a large value of <span class="math notranslate nohighlight">\(r\)</span> versus a small one? It depends on the problem! And as you get more comfortable with this, you’ll get a sense for it. Below we’ll take a closer look at how to understand this. As you look at these different plots, which would you say have a strong linear association?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corrs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.98</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># generate data</span>
<span class="k">for</span> <span class="n">corr</span> <span class="ow">in</span> <span class="n">corrs</span><span class="p">:</span>
    <span class="c1"># create covariance matrix from correlation</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="n">corr</span><span class="p">],</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">cov</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices_from</span><span class="p">(</span><span class="n">cov</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># generate random samples</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">cov</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># add to dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>
    <span class="c1"># calculate actual correlation of random sample</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">rvs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rvs</span><span class="p">,</span> <span class="n">df</span><span class="p">])</span> <span class="k">if</span> <span class="n">rvs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span>
<span class="c1"># plot data</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">relplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">rvs</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">col_wrap</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;scatter&quot;</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">facet_kws</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;despine&quot;</span><span class="p">:</span> <span class="kc">False</span> <span class="p">}</span>
<span class="p">)</span>
<span class="c1"># clear axis labels and remove tick marks</span>
<span class="n">fg</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">fg</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Randomly Sampled Data with Various Degrees of Correlation&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/de44c119154d18c10840a81327716053405caf989e34b89178530255bb9b9104.png"><img alt="../../_images/de44c119154d18c10840a81327716053405caf989e34b89178530255bb9b9104.png" src="../../_images/de44c119154d18c10840a81327716053405caf989e34b89178530255bb9b9104.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>When we emphasize that <span class="math notranslate nohighlight">\(r\)</span> measures <em>linear</em> association, this means that two variables might have a very small value of <span class="math notranslate nohighlight">\(r\)</span>, but still have some <em>nonlinear</em> association. Notice in the following scatter plot that the points have a quadratic relationship, but the measure of correlation is close to 0.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate and plot randomly sampled data from two quadratically dependent random variables with zero covariance</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Randomly Sampled Data with Quadratic Dependence (R = </span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/b7d505b3da541e36eb0951f8357a92f343de2ee18d7d094b434298fe675540ba.png"><img alt="../../_images/b7d505b3da541e36eb0951f8357a92f343de2ee18d7d094b434298fe675540ba.png" src="../../_images/b7d505b3da541e36eb0951f8357a92f343de2ee18d7d094b434298fe675540ba.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>There are a few ways to calculate <span class="math notranslate nohighlight">\(r\)</span> in Python. First, we could calculate it directly using the <code class="docutils literal notranslate"><span class="pre">pearsonr</span></code> command from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">[</span><span class="s1">&#39;primary_school_completion_rate_(pct)&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">[</span><span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7531156213152443
</pre></div>
</div>
</div>
</div>
<p>Second, we also get the magnitude of <span class="math notranslate nohighlight">\(r\)</span> in the output of our linear model. If you look above, you see that the output of the linear model says <code class="docutils literal notranslate"><span class="pre">R-squared:</span> <span class="pre">0.567</span></code>. This actually provides you with a value <span class="math notranslate nohighlight">\(r^2\)</span>, which is simply the square of the correlation coeffient <span class="math notranslate nohighlight">\(r\)</span> that we calculated above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5671831390690465
</pre></div>
</div>
</div>
</div>
<p>Even though it doesn’t tell us if the trend is positive or negative, <span class="math notranslate nohighlight">\(r^2\)</span> is often preferred to <span class="math notranslate nohighlight">\(r\)</span> because it has a simple interpretation. The value of <span class="math notranslate nohighlight">\(r^2\)</span> quantifies the <strong>percentage of variation in <span class="math notranslate nohighlight">\(Y\)</span> that is explained by the linear model.</strong></p>
<p>In the context of our problem, using a linear model with the primary school completion rate explains 56.7% of the variation in literacy rates between the countries. More simply, the primary school completion rate explains some of the differences in literacy rates between countries, but not all, and that amount is quantified as 56.7%.</p>
<p>Is this a small or large amount? One way to quantify how well the model fits is through a <em>Goodness of Fit Test</em>. Without giving all of the details, this is a hypothesis test that determines if the value of <span class="math notranslate nohighlight">\(r\)</span> is significantly different from 0. In terms of hypotheses, the null hypothesis is that the model is not a good fit, versus the alternative that it is a good fit.</p>
<p>The test statistic has a special type of distribution called an F distribution, and its value can be found on the right of the summary table as <code class="docutils literal notranslate"><span class="pre">F-statistic</span></code>. The <span class="math notranslate nohighlight">\(P\)</span>-value for the test is right below it. In this case an F statistic of 114.0 yields a <span class="math notranslate nohighlight">\(P\)</span>-value of <span class="math notranslate nohighlight">\(1.70\times 10^{-17}\)</span>, which is very small. Hence, we reject the null hypothesis, and conclude that this linear model fits the data well.</p>
<p>There is a lot more to these kinds of tests, which become more important in the multiple regression case. We’ll come back to that later on!</p>
</section>
<section id="inference-on-model-parameters">
<h3>Inference on Model Parameters<a class="headerlink" href="#inference-on-model-parameters" title="Link to this heading">#</a></h3>
<p>Now that we know how to find the line of best fit, we want to know how good our estimates of the slope and intercept are. We began by assuming that there is a linear model describing the relationship between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7d805cca-c483-4602-834e-68d2a727bbfa">
<span class="eqno">(6.21)<a class="headerlink" href="#equation-7d805cca-c483-4602-834e-68d2a727bbfa" title="Permalink to this equation">#</a></span>\[\begin{equation}
Y = \alpha + \beta x + \varepsilon.
\end{equation}\]</div>
<p>Because we only have limited data on the relationship between these two variables <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, we can’t calculate <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> exactly, but only estimate them with our least squares estimates <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. How can we know how good these estimates actually are? We turn again to our statistical inference tools of the confidence interval and hypothesis test.</p>
<p>A big question in linear regression is whether knowing the value of <span class="math notranslate nohighlight">\(x\)</span> makes a difference in our estimation of <span class="math notranslate nohighlight">\(Y\)</span>. If it doesn’t, the slope value in the model would actually be 0. If it does, it would be something different from 0. But <span class="math notranslate nohighlight">\(\beta\)</span> is a parameter of the model, which we estimated by calculating the slope <span class="math notranslate nohighlight">\(b\)</span> using least squares. So we can use our hypothesis testing skills to decide if <span class="math notranslate nohighlight">\(\beta = 0\)</span> or not!</p>
<div class="amsmath math notranslate nohighlight" id="equation-2e6f50fc-08d7-4be7-96de-80eb8f1d1330">
<span class="eqno">(6.22)<a class="headerlink" href="#equation-2e6f50fc-08d7-4be7-96de-80eb8f1d1330" title="Permalink to this equation">#</a></span>\[\begin{equation}
    H_0: \beta = 0, \\ H_1: \beta \neq 0.
\end{equation}\]</div>
<p>We can show that the test statistic for this hypothesis test is a T random variable, and its value is given in the model summary readout. Look for the column <code class="docutils literal notranslate"><span class="pre">t</span></code>, just two columns to the right of where you found the coefficients. And just next to that is the <span class="math notranslate nohighlight">\(P\)</span>-value for the test.</p>
<p>In this case, we got <span class="math notranslate nohighlight">\(T=10.677\)</span> which yields a <span class="math notranslate nohighlight">\(P\)</span>-value of 0.000. This causes us to reject the null hypothesis and conclude that the true slope is actually different from 0. We can also give a 95% confidence interval for our estimate of the slope, which is again given in the table as <span class="math notranslate nohighlight">\((0.701, 1.022)\)</span>.</p>
<p>If this seems similar to the goodness of fit test we just covered, you’re right! In fact, they are exactly the same in the simple linear regression case (verify for yourself that <span class="math notranslate nohighlight">\(F = T^2\)</span>). However, once we move to the multiple regression case, they will no longer be the same, and both tests will be important!</p>
<p>Before moving on, take some time to look over the model summary output again, and make sure that you can find all the information we’ve talked about so far.</p>
</section>
<section id="model-diagnostics">
<h3>Model Diagnostics<a class="headerlink" href="#model-diagnostics" title="Link to this heading">#</a></h3>
<p>To wrap up our discussion of simple linear regression, we need to address a few details that we have glossed over up to this point. In our previous discussion, we have made a few assumptions which we need to take a deeper look at.</p>
<p>We assumed:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> really do have a linear relationship. We made this assumption when we decided to use the model <span class="math notranslate nohighlight">\(Y = \alpha + \beta x + \varepsilon\)</span>.</p></li>
<li><p>The random error <span class="math notranslate nohighlight">\(\varepsilon\)</span> is normally distributed with mean 0.</p></li>
<li><p>The random error <span class="math notranslate nohighlight">\(\varepsilon\)</span> is independent of <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ol>
<p>These last two assumptions were not explicitly stated, but they are needed to make the regression interpretations work. And when we make assumptions like this, we need to check to see if these are reasonable! Here, we will show how to visually evaluate these assumptions using graphs.</p>
<p>The first question of the relationship between <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> can be easily evaluated through the <a class="reference internal" href="#scatter-plot-simple"><span class="std std-ref">scatter plot</span></a> we made at the beginning of this section. If the scatter plot isn’t clear, then the correlation coefficient can help!</p>
<p>We can evaluate the next two claims by examining the residuals. The residuals are related to the random error since, according to the model,</p>
<div class="amsmath math notranslate nohighlight" id="equation-3248415c-04bd-4762-92da-43fd172eec0c">
<span class="eqno">(6.23)<a class="headerlink" href="#equation-3248415c-04bd-4762-92da-43fd172eec0c" title="Permalink to this equation">#</a></span>\[\begin{equation}
    y_i - \hat y_i =  y_i - (a + b x_i) \approx y_i - (\alpha + \beta x_i) = \varepsilon_i.
\end{equation}\]</div>
<p>Plotting the residuals will give us an idea about the distribution of the <span class="math notranslate nohighlight">\(\varepsilon\)</span>, but we need two different types of plots to examine the assumptions.</p>
<p>First, we can plot a histogram of the residuals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;histogram of residuals&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">std</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">std</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">std</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;normal pdf&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/d4242a3bd4640bfc8a4b38f2d767f55b6932f8492e7e1168bef69132837701ee.png"><img alt="../../_images/d4242a3bd4640bfc8a4b38f2d767f55b6932f8492e7e1168bef69132837701ee.png" src="../../_images/d4242a3bd4640bfc8a4b38f2d767f55b6932f8492e7e1168bef69132837701ee.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>Here we see that the residuals have a roughly mound-shaped distribution, though there is left skew and the histogram does deviate somewhat from the normal distribution. We will say that the normal residual assumption is ok in this case, even though the residuals don’t follow the normal distribution as much as we might like!</p>
<p>Second, we look at a scatter plot between <span class="math notranslate nohighlight">\(x\)</span> and the residuals. If the errors are truly independent of <span class="math notranslate nohighlight">\(x\)</span>, then we will not observe any patterns in the graph, and it should look like a random cloud of points. There should be roughly an equal number spread out above and below 0, with most of them being close to 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted Values&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fitted Values vs. Residuals&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/288279fc03fd8611baaf84a2569fb7128728aaeae2d7e6c69de34b285f83d9e9.png"><img alt="../../_images/288279fc03fd8611baaf84a2569fb7128728aaeae2d7e6c69de34b285f83d9e9.png" src="../../_images/288279fc03fd8611baaf84a2569fb7128728aaeae2d7e6c69de34b285f83d9e9.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>Here there isn’t a clear pattern, though the cluster of points in the upper right might give us some pause. Again it looks like the assumptions are reasonable, though that cluster means we should be cautious in this case about the fit of the model.</p>
<p>It can take some time to develop intuition about which plots look “good enough” and which are really bad, and there are some more sophisticated tests for these things that are outside the scope of this book. To illustrate the point, we provide an example below of what would it look like if the assumptions were badly violated, using a different variable from our data for the <span class="math notranslate nohighlight">\(x\)</span>-axis. Here is the model using this other variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;primary_school_enrollment_rate_(pct)&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;adult_literacy_rate_(pct)&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">regression</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">wbl</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">sm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">wbl</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">wbl</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                OLS Regression Results                               
=====================================================================================
Dep. Variable:     adult_literacy_rate_(pct)   R-squared:                       0.000
Model:                                   OLS   Adj. R-squared:                 -0.011
Method:                        Least Squares   F-statistic:                  0.003546
Date:                       Thu, 20 Jul 2023   Prob (F-statistic):              0.953
Time:                               16:47:39   Log-Likelihood:                -384.08
No. Observations:                         89   AIC:                             772.2
Df Residuals:                             87   BIC:                             777.1
Df Model:                                  1                                         
Covariance Type:                   nonrobust                                         
========================================================================================================
                                           coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------------------------------
const                                   86.0796     15.388      5.594      0.000      55.495     116.664
primary_school_enrollment_rate_(pct)    -0.0088      0.148     -0.060      0.953      -0.303       0.286
==============================================================================
Omnibus:                       22.660   Durbin-Watson:                   1.728
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               29.654
Skew:                          -1.356   Prob(JB):                     3.64e-07
Kurtosis:                       3.800   Cond. No.                         823.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/02d473bc9240b95e665de9ec6464341cd8a798eb629739054a0bcd0660a3dae6.png"><img alt="../../_images/02d473bc9240b95e665de9ec6464341cd8a798eb629739054a0bcd0660a3dae6.png" src="../../_images/02d473bc9240b95e665de9ec6464341cd8a798eb629739054a0bcd0660a3dae6.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>And here are the model diagnostic plots for this other model. Notice that the spread of the residuals is skewed and that the distribution does not look normal, violating our regression assumptions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot residuals scatterplot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted Values&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fitted Values vs. Residuals&quot;</span><span class="p">);</span>

<span class="c1"># plot residuals histogram</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;histogram of residuals&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">std</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">std</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">std</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;normal pdf&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/6b2f6a80ce710c50b990cabeb2b53336441ece999d831e168291df88b29f4642.png"><img alt="../../_images/6b2f6a80ce710c50b990cabeb2b53336441ece999d831e168291df88b29f4642.png" src="../../_images/6b2f6a80ce710c50b990cabeb2b53336441ece999d831e168291df88b29f4642.png" style="width: 710px; height: 411px;" /></a>
<a class="reference internal image-reference" href="../../_images/0b18b1218db1dd76ced259956ff7fe059a88eabdd6ce619a4b98c965e868e883.png"><img alt="../../_images/0b18b1218db1dd76ced259956ff7fe059a88eabdd6ce619a4b98c965e868e883.png" src="../../_images/0b18b1218db1dd76ced259956ff7fe059a88eabdd6ce619a4b98c965e868e883.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>In summary, if all of the diagnostic plots look ok, then the assumptions are reasonable, and our modeling results can be trusted! If not, there are other things you can try, but that is outside the scope of this section. It can take some time to get the hang of looking at these plots, but the more you practice the easier it becomes.</p>
</section>
<section id="exercise-4-1">
<h3>Exercise 4.1<a class="headerlink" href="#exercise-4-1" title="Link to this heading">#</a></h3>
<p>What sorts of team statistics are associated with winning in the English Premier League? We can explore this question at a high level using simple linear regression.</p>
<p>Below, we load a dataset from the file <code class="docutils literal notranslate"><span class="pre">epl_table_22_23.csv</span></code> (click <a class="reference download internal" download="" href="../../_downloads/50391c046545c56d5ba292a9867beaa1/epl_table_22_23.csv"><span class="xref download myst">here</span></a> to download a copy). This dataset contains the league standings along with some common statistics for the 2022-23 EPL season. A few notes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">points</span></code> is the total number of points accrued by a team through winning or drawing matches. A team earns 1 point for a draw and 3 points for a win.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">goals_for</span></code> is the number of goals scored by the team, while <code class="docutils literal notranslate"><span class="pre">goals_against</span></code> is the number of goals allowed by the team. <code class="docutils literal notranslate"><span class="pre">goal_diff</span></code> is how many more (or less) goals a team scored than allowed.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;epl_table_22_23.csv&#39;</span><span class="p">)</span>
<span class="n">epl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team</th>
      <th>wins</th>
      <th>draws</th>
      <th>losses</th>
      <th>points</th>
      <th>goals_for</th>
      <th>goals_against</th>
      <th>goal_diff</th>
      <th>expected_goals_for</th>
      <th>expected_goals_against</th>
      <th>expected_goal_diff</th>
      <th>attendance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arsenal</td>
      <td>26</td>
      <td>6</td>
      <td>6</td>
      <td>84</td>
      <td>88</td>
      <td>43</td>
      <td>45</td>
      <td>71.9</td>
      <td>42.0</td>
      <td>29.9</td>
      <td>60191</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Aston Villa</td>
      <td>18</td>
      <td>7</td>
      <td>13</td>
      <td>61</td>
      <td>51</td>
      <td>46</td>
      <td>5</td>
      <td>50.2</td>
      <td>52.5</td>
      <td>-2.2</td>
      <td>39485</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bournemouth</td>
      <td>11</td>
      <td>6</td>
      <td>21</td>
      <td>39</td>
      <td>37</td>
      <td>71</td>
      <td>-34</td>
      <td>38.6</td>
      <td>63.9</td>
      <td>-25.3</td>
      <td>10362</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brentford</td>
      <td>15</td>
      <td>14</td>
      <td>9</td>
      <td>59</td>
      <td>58</td>
      <td>46</td>
      <td>12</td>
      <td>56.8</td>
      <td>49.9</td>
      <td>6.8</td>
      <td>17078</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brighton</td>
      <td>18</td>
      <td>8</td>
      <td>12</td>
      <td>62</td>
      <td>72</td>
      <td>53</td>
      <td>19</td>
      <td>73.3</td>
      <td>50.2</td>
      <td>23.1</td>
      <td>31477</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="arabic simple">
<li><p>Make a scatter plot of the number of goals a team scored (<code class="docutils literal notranslate"><span class="pre">goals_for</span></code>) versus the number of points they accrued in the standings (<code class="docutils literal notranslate"><span class="pre">points</span></code>). How would you describe the relationship?</p></li>
<li><p>Fit a linear model to these two variables, and print out the summary.</p></li>
<li><p>Use the summary to write down the estimated slope and intercept of the model. Interpret these values in the context of the problem. How many points, on average, is each additional goal scored in the standings worth?</p></li>
<li><p>What is the value of <span class="math notranslate nohighlight">\(r^2\)</span>? Does the model seem to be a good fit? Explain your reasoning.</p></li>
<li><p>Provide diagnostic plots for the model and comment on the validity of the assumptions.</p></li>
<li><p>Repeat this analysis with another variable or variables. Do your new models seem to be a better or worse fit? Why or why not? Provide diagnostic plots for your model and comment on the validity of the assumptions.</p></li>
<li><p>Do you think <code class="docutils literal notranslate"><span class="pre">attendance</span></code> has any effect on a team’s performance? Use some of the tools from this section to answer, and explain what you find. How might you use this example to help understand the common phrase “correlation is not causation”?</p></li>
</ol>
<div class="highlight-{index}Multiple notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>
<section id="multiple-regression">
<h2><span class="section-number">6.5.2. </span>Multiple Regression<a class="headerlink" href="#multiple-regression" title="Link to this heading">#</a></h2>
<p>Much more interesting is the case where there are several independent variables that are all possibly connected to an output. In this case, because we are dealing with multiple variables, our modeling tool is now called <strong>multiple regression</strong>.</p>
<p>For our example, we will return to the <a class="reference external" href="https://github.com/mcnakhaee/palmerpenguins">Palmer Penguins dataset</a> introduced in the <a class="reference internal" href="03_Inference_Numerical.html"><span class="std std-doc">previous section</span></a>. Specifically, we will look at the connection between body mass and some of the other measurements of the penguins.</p>
<p>This becomes a bit more difficult to visualize since we are dealing with more than just 2 variable dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">palmerpenguins</span> <span class="kn">import</span> <span class="n">load_penguins</span>

<span class="n">penguins</span> <span class="o">=</span> <span class="n">load_penguins</span><span class="p">()</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># display 5 randomly sampled rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>35.0</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3450.0</td>
      <td>female</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>109</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>43.2</td>
      <td>19.0</td>
      <td>197.0</td>
      <td>4775.0</td>
      <td>male</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>214</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.7</td>
      <td>13.9</td>
      <td>214.0</td>
      <td>4400.0</td>
      <td>female</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>199</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>50.5</td>
      <td>15.9</td>
      <td>225.0</td>
      <td>5400.0</td>
      <td>male</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>128</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.0</td>
      <td>17.1</td>
      <td>191.0</td>
      <td>3050.0</td>
      <td>female</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So what does it look like to understand how body mass changes based on these other variables? Mathematically, we are modeling <span class="math notranslate nohighlight">\(Y\)</span> as a linear function of several independent variables <span class="math notranslate nohighlight">\(x_1, x_2, \ldots, x_p\)</span>. As in the single variable case, our variable <span class="math notranslate nohighlight">\(Y\)</span> won’t follow this linear function exactly. Instead, it will be subject to some random deviations, modelled by <span class="math notranslate nohighlight">\(\varepsilon\)</span>.</p>
<div class="amsmath math notranslate nohighlight" id="equation-7a02b75a-b6fe-423b-b961-63bc1e227c54">
<span class="eqno">(6.24)<a class="headerlink" href="#equation-7a02b75a-b6fe-423b-b961-63bc1e227c54" title="Permalink to this equation">#</a></span>\[\begin{equation}
    Y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \ldots + \beta_p x_p + \varepsilon.
\end{equation}\]</div>
<p>Again, we only have limited data, so we need to <em>estimate</em> the values of <span class="math notranslate nohighlight">\(\beta_0, \ldots, \beta_p\)</span> with some estimators <span class="math notranslate nohighlight">\(b_0, \ldots, b_p\)</span>. As a result, our new equation looks like this:</p>
<div class="amsmath math notranslate nohighlight" id="equation-337696d8-3466-4812-9afb-617d3b91fc7c">
<span class="eqno">(6.25)<a class="headerlink" href="#equation-337696d8-3466-4812-9afb-617d3b91fc7c" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \hat y = b_0 + b_1 x_1 + b_2 x_2 + \ldots + b_p x_p.
\end{equation}\]</div>
<p>In this equation, <span class="math notranslate nohighlight">\(b_0\)</span> is an intercept, while <span class="math notranslate nohighlight">\(b_1, \ldots, b_p\)</span> are slope parameters associated with the different variables <span class="math notranslate nohighlight">\(x_1, \ldots, x_p\)</span>. For example, the value of <span class="math notranslate nohighlight">\(b_3\)</span> tells us how much we estimate that <span class="math notranslate nohighlight">\(Y\)</span> would change when <span class="math notranslate nohighlight">\(x_3\)</span> changes, <em>with all other independent variables held constant</em>. Thinking about this in the abstract setting can be difficult, so we recommend coming back to this later in light of the example using real data below.</p>
<p>So how do we find this ‘best’ linear function? The good news is that we can do this estimation using least squares! Similar to the one-variable case, this involves finding the values of <span class="math notranslate nohighlight">\(b_0, \ldots, b_p\)</span> that minimize the sum of the squared residuals:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1a9a3bea-b6dc-44af-8c6b-3a9f919170e0">
<span class="eqno">(6.26)<a class="headerlink" href="#equation-1a9a3bea-b6dc-44af-8c6b-3a9f919170e0" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \min_{b_0, \ldots, b_p} \sum_{i=1}^n (y_i - \hat y_i)^2
\end{equation}\]</div>
<p>We’ll spare you the details in this section, as the notation can get messy and a full solution requires the use of linear algebra. You can find the details in most any college linear algebra book, including <a class="reference internal" href="../../Advanced/LinearAlgebra/OLS/jnb1.html"><span class="std std-doc">this section</span></a> of this book.</p>
<p>Again, we have some code that can take care of this least squares minimization for us and find the estimates we need. As before, we’ll use the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library, but when we specify the input variables <code class="docutils literal notranslate"><span class="pre">x</span></code>, we list each of the variables we are using to try to understand body mass. In this case, we start by looking at just bill depth and flipper length.</p>
<p>Note that we also add <code class="docutils literal notranslate"><span class="pre">missing</span> <span class="pre">=</span> <span class="pre">'drop'</span></code> since a few of these data points are missing, which means we need to tell the computer to ignore those rows!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[[</span><span class="s1">&#39;bill_depth_mm&#39;</span><span class="p">,</span> <span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">regression</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:            body_mass_g   R-squared:                       0.761
Model:                            OLS   Adj. R-squared:                  0.760
Method:                 Least Squares   F-statistic:                     539.8
Date:                Thu, 20 Jul 2023   Prob (F-statistic):          4.23e-106
Time:                        16:47:40   Log-Likelihood:                -2527.0
No. Observations:                 342   AIC:                             5060.
Df Residuals:                     339   BIC:                             5071.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
=====================================================================================
                        coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------
const             -6541.9075    540.751    -12.098      0.000   -7605.557   -5478.258
bill_depth_mm        22.6341     13.280      1.704      0.089      -3.488      48.756
flipper_length_mm    51.5414      1.865     27.635      0.000      47.873      55.210
==============================================================================
Omnibus:                        5.490   Durbin-Watson:                   2.069
Prob(Omnibus):                  0.064   Jarque-Bera (JB):                5.361
Skew:                           0.305   Prob(JB):                       0.0685
Kurtosis:                       3.067   Cond. No.                     5.14e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 5.14e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<p>Again, there is a lot of information here! First, we can take the coefficients to see that the estimated relationship between body mass (<span class="math notranslate nohighlight">\(Y\)</span>) and the bill depth (<span class="math notranslate nohighlight">\(x_1\)</span>) and flipper length (<span class="math notranslate nohighlight">\(x_2\)</span>) is</p>
<div class="amsmath math notranslate nohighlight" id="equation-abd5036d-3832-436c-ad74-e7b695d80e6b">
<span class="eqno">(6.27)<a class="headerlink" href="#equation-abd5036d-3832-436c-ad74-e7b695d80e6b" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat y = -6541.91 + 22.63 x_1 + 51.54 x_2
\end{equation}\]</div>
<p>This means that, on average, an increase of 1mm of bill depth is associated with an increase of about 23g in mass, at least for two penguins with the same flipper length. Likewise, holding bill depth constant, an increase of 1mm in flipper length is associated with an increase of about 52g in mass.</p>
<p>However, if we take a look at the P-values (in the <code class="docutils literal notranslate"><span class="pre">P&gt;|t|</span></code> column), we see that the coefficient for <code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code> has a value of 0.089. This is a somewhat large P-value, which indicates that the variable <code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code> does not have a significant effect on <code class="docutils literal notranslate"><span class="pre">body_mass_g</span></code> in the presence of the other variable, <code class="docutils literal notranslate"><span class="pre">flipper_length_mm</span></code>. In other words, <code class="docutils literal notranslate"><span class="pre">bill_depth_mm</span></code> does not add any additional information beyond what <code class="docutils literal notranslate"><span class="pre">flipper_length_mm</span></code> already offers to our model for body mass. (See what happens when you exclude bill depth from the model!)</p>
<p>At this point, we have only one variable that seems to be associated with body mass. However, there is more we can do here. (And don’t worry, I haven’t forgotten about model assumptions and diagnostics—we’ll come back to that soon!)</p>
<div class="highlight-{index}Dummy notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<section id="dummy-variables">
<h3>Dummy Variables<a class="headerlink" href="#dummy-variables" title="Link to this heading">#</a></h3>
<p>Categorical or qualitative variables can sometimes also be incorporated into a linear regression model by an appropriate transformation. In this case, we have at least one such variable that might be helpful in understanding body mass. Male penguins are typically larger than female penguins, so it might be helpful to incorporate the <code class="docutils literal notranslate"><span class="pre">sex</span></code> of the penguin into our model.</p>
<div class="cell docutils container" id="scatter-plot-multiple">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Body Mass vs. Flipper Length&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/501659b270013dd670951da9c9db97776b32ea8b42f1052819e5df607dcfdf7c.png"><img alt="../../_images/501659b270013dd670951da9c9db97776b32ea8b42f1052819e5df607dcfdf7c.png" src="../../_images/501659b270013dd670951da9c9db97776b32ea8b42f1052819e5df607dcfdf7c.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>However, this variable doesn’t consist of numerical values. Instead, it consists of a set of categorical values (<code class="docutils literal notranslate"><span class="pre">male</span></code> and <code class="docutils literal notranslate"><span class="pre">female</span></code> in this case), which are referred to as the “levels” of the variable. So it’s not clear how we can incorporate this variable into the linear model as-is.</p>
<p>To solve this problem, we will “encode” the levels of this categorical variable as numbers. This process is called adding a “dummy” variable. To do this, we’ll use the <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> function from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;flipper_length_mm&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">[</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="s2">&quot;TRUE&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>flipper_length_mm</th>
      <th>sex_male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>181.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>186.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>195.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>193.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>190.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>181.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>195.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>193.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>190.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this case, we see that we have created a new dummy variable <code class="docutils literal notranslate"><span class="pre">sex_male</span></code>. This is a variable that takes the value 1 if the sex of the penguin is male and 0 otherwise. (There is nothing special about whether male or female is 0 or 1; the software chooses automatically based on which levels appear first in the data.)</p>
<p>So now we have turned our categorical variable into a numerical one, which we can add to the model. Let’s see what it looks like!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">regression</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:            body_mass_g   R-squared:                       0.803
Model:                            OLS   Adj. R-squared:                  0.802
Method:                 Least Squares   F-statistic:                     691.0
Date:                Thu, 20 Jul 2023   Prob (F-statistic):          2.53e-120
Time:                        16:47:41   Log-Likelihood:                -2493.9
No. Observations:                 342   AIC:                             4994.
Df Residuals:                     339   BIC:                             5005.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
=====================================================================================
                        coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------
const             -5327.2009    281.739    -18.908      0.000   -5881.378   -4773.024
flipper_length_mm    46.5787      1.420     32.795      0.000      43.785      49.372
sex_male            347.2632     39.891      8.705      0.000     268.797     425.729
==============================================================================
Omnibus:                        0.303   Durbin-Watson:                   1.744
Prob(Omnibus):                  0.860   Jarque-Bera (JB):                0.412
Skew:                           0.057   Prob(JB):                        0.814
Kurtosis:                       2.874   Cond. No.                     2.94e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.94e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<p>Take a look at the output of this new model. One way to think about this is that there are two lines, one for each category (male and female). If the penguin is male (<span class="math notranslate nohighlight">\(x_2 = 1\)</span>), the regression line looks like</p>
<div class="amsmath math notranslate nohighlight" id="equation-71b513d0-6e1c-4612-91d9-9c4f1d9418a0">
<span class="eqno">(6.28)<a class="headerlink" href="#equation-71b513d0-6e1c-4612-91d9-9c4f1d9418a0" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat y_{male} = -5327.20  + 46.58 x_1 + 347.26 x_2 = -5327.20  + 46.58 x_1 + 347.26(1) = -4979.94 + 46.58 x_1.
\end{equation}\]</div>
<p>For a female penguin, on the other hand, the variable <span class="math notranslate nohighlight">\(x_2\)</span> would take a value of 0. See if you can write down the estimated line for a female penguin.</p>
<p>You can also simply interpret the coefficient of <code class="docutils literal notranslate"><span class="pre">sex_male</span></code> to mean that male penguins are on average 347.26g heavier than female penguins when controlling for bill depth.</p>
<p>Notice that we only needed 1 dummy variable to describe a categorical variable with two possible levels. In general, we need to create one fewer variable than the number of levels in the variable. This is what the <code class="docutils literal notranslate"><span class="pre">drop_first=TRUE</span></code> argument does: it drops one of the dummies that isn’t necessary in the model. In the exercises, you’ll see what happens when we add in a categorical variable with 3 levels (<code class="docutils literal notranslate"><span class="pre">species</span></code>, which has levels <code class="docutils literal notranslate"><span class="pre">Gentoo</span></code>, <code class="docutils literal notranslate"><span class="pre">Adelie</span></code>, or <code class="docutils literal notranslate"><span class="pre">Chinstrap</span></code>).</p>
</section>
<section id="id1">
<h3>Model Diagnostics<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>The assumptions for a multiple linear regression model are nearly the same as for a simple linear regression model, and they are not much more difficult to evaluate. Once again, we need to assume that the relationship between <span class="math notranslate nohighlight">\(Y\)</span> and the input variables <span class="math notranslate nohighlight">\(x_1, \ldots, x_p\)</span> is linear. And as before, we can check this assumption by looking at the <a class="reference internal" href="#scatter-plot-multiple"><span class="std std-ref">scatter plot</span></a> we made.</p>
<p>We also need to assume that the residuals are nearly normal and independent of the input variables. Coding the plots to check these last two assumptions looks much the same as it did before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot residuals scatterplot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fitted Values&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fitted Values vs. Residuals&quot;</span><span class="p">)</span>

<span class="c1"># plot residuals histogram</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">palette</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;histogram of residuals&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">std</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">std</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">resid</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">std</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">palette</span><span class="p">),</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;normal pdf&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/c7a59f87e6b1821ac57ee1bb855938ad6321af1015403ca08ba19dc87ee4e20d.png"><img alt="../../_images/c7a59f87e6b1821ac57ee1bb855938ad6321af1015403ca08ba19dc87ee4e20d.png" src="../../_images/c7a59f87e6b1821ac57ee1bb855938ad6321af1015403ca08ba19dc87ee4e20d.png" style="width: 710px; height: 411px;" /></a>
<a class="reference internal image-reference" href="../../_images/30e67bf191a334abf7991c05d890091a3961658b1d188d7c3de24fb8847dec98.png"><img alt="../../_images/30e67bf191a334abf7991c05d890091a3961658b1d188d7c3de24fb8847dec98.png" src="../../_images/30e67bf191a334abf7991c05d890091a3961658b1d188d7c3de24fb8847dec98.png" style="width: 710px; height: 411px;" /></a>
</div>
</div>
<p>It’s pretty clear that the residuals are nearly normal and that there is no pattern. In fact, this looks much better than the plots of the residuals for the simple linear regression models, indicating that in some respects the linear model is a better fit here.</p>
<p>But we’ve glossed over something important! If you looked closely at the <a class="reference internal" href="#scatter-plot-multiple"><span class="std std-ref">original scatter plot</span></a>, you probably noticed that male penguins don’t just have larger body mass, they also have larger flipper length. In other words, the input variables <code class="docutils literal notranslate"><span class="pre">sex</span></code> and <code class="docutils literal notranslate"><span class="pre">flipper_length_mm</span></code> are themselves correlated, which could be causing an issue in our model. (Note that the model readout also indicates that this might be a problem.) We can get a better look at this through some <a class="reference internal" href="../../Data.html"><span class="std std-doc">exploratory data analysis</span></a>. But for now, let’s move on to some other topics.</p>
</section>
<section id="id2">
<h3>Inference on Model Parameters<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>The techniques of inference that we talked about in the single-variable case carry over to the multiple regression model. The main difference is the interpretation of the readout results. Because we have multiple variables involved in the model, which themselves may be linearly connected, the matter becomes slightly more complex.</p>
<p>First, we might ask how well the model is doing overall. How well does it fit the data? The software has again performed the <em>Goodness of Fit Test</em> for us, comparing (in basic terms) the null hypothesis that the model is not a good fit versus the alternative hypothesis that it is a good fit. Looking back at the model readout, we can find that our F-statistic is 691.0, yielding an extremely small P-value of <span class="math notranslate nohighlight">\(2.53\times10^{-120}\)</span> (0, for our purposes). This means that our model is a good fit and that our input variables are providing some information about <code class="docutils literal notranslate"><span class="pre">body_mass_g</span></code>.</p>
<p>This test looks at the fit of the model all at once, but we can also look in more detail at the values of the individual “slope” coeffecients associated with each input. The model readout provides a seperate hypothesis test for whether each coefficient is significantly different from zero in the columns <code class="docutils literal notranslate"><span class="pre">t</span></code> (the test statistic) and <code class="docutils literal notranslate"><span class="pre">P&gt;|t|</span></code> (the P-value). Moreover, the readout also gives 95% confidence intervals for each coefficient. This information can help you determine the effect that a single variable (such as flipper length) has on body mass when you also account for the differences in the other variables (such as the sex of the animal).</p>
<p>There is a lot more to say about this, and about regression as a whole, but now you should have enough knowledge of the basics to be able to build and interpret a regression model on your own!</p>
</section>
<section id="exercise-4-2">
<h3>Exercise 4.2<a class="headerlink" href="#exercise-4-2" title="Link to this heading">#</a></h3>
<p>Create a new model using <code class="docutils literal notranslate"><span class="pre">sex</span></code>, <code class="docutils literal notranslate"><span class="pre">species</span></code>, and <code class="docutils literal notranslate"><span class="pre">flipper_length_mm</span></code> to predict <code class="docutils literal notranslate"><span class="pre">body_mass_g</span></code>.</p>
<ol class="arabic simple">
<li><p>How many different levels (i.e., possible categories) are in the <code class="docutils literal notranslate"><span class="pre">species</span></code> variable? How does the software handle the <code class="docutils literal notranslate"><span class="pre">species</span></code> variable?</p></li>
<li><p>Are all the variables providing useful information in your model? How can you tell?</p></li>
<li><p>Describe the typical characteristics of a very large or very small penguin.</p></li>
<li><p>Provide diagnostics for your model and comment on the validity of the regression assumptions.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ProbStat/StatInf"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03_Inference_Numerical.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.4. </span>Hypothesis Testing for Numerical Data</p>
      </div>
    </a>
    <a class="right-next"
       href="../../AppliedCalc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>APPLIED CALCULUS FOR DAILY LIFE - Wheaton College Team</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-linear-regression">6.5.1. Simple Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#world-bank-development-indicators">World Bank Development Indicators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-linear-regression-models">Simple Linear Regression Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minimizing-the-sum-of-squares-error">Minimizing the Sum of Squares Error</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-least-squares-line">Finding the Least Squares Line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#r-2-and-goodness-of-fit-tests"><span class="math notranslate nohighlight">\(R^2\)</span> and Goodness of Fit Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inference-on-model-parameters">Inference on Model Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-diagnostics">Model Diagnostics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-1">Exercise 4.1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-regression">6.5.2. Multiple Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-variables">Dummy Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Model Diagnostics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Inference on Model Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4-2">Exercise 4.2</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Isihara, Claire Wagner, Peter Jantsch, and Thomas VanDrunen, Editors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
  <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'><img alt='Creative Commons License' width=88 style='border-width:0' src='https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by.png'/></a>
  Except where otherwise noted, this work is licensed under a <a rel='license' href='http://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 International License</a>.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>